(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9102],{77179:function(e,t,s){Promise.resolve().then(s.bind(s,80257))},80257:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Vaults}});var a=s(31113),n=s(59781),i=s(30639),l=s(4283),r=s(66499),o=s(95889),c=s(44020),d=s(22139),u=s(7993),m=s(59175),x=s(26361),h=s(22818),p=s(55349),b=s(18358),f=s(84944),v=s(95499),j=s(64370),g=s(36834),y=s(83978),w=s.n(y),N=s(69708),k=s(64103),T=s(12485),C=s(93650),S=s(14993),B=s(85665),P=s(20265),A=s(47259);let E="0x0000000000000000000000000000000000000000";var R=s(4408),F=s(12687),V=s(91214),I=s(2811),L=s(49041),Y=s(64217),D=s(11292);let bnToNum=e=>w().round(parseFloat((0,D.d)(BigInt(e))),5),logTrans=e=>w().round(Math.log10(90*e+1),5),revertLog=e=>w().round((Math.pow(10,e)-1)/90,5);function BvaultEpochYtPrices(e){let{bvc:t,epochId:s}=e,n=(0,m.p)(),{data:i}=(0,j.a)({queryKey:["bvualt-epoch-yt-prices",n,t.vault,s],queryFn:()=>(0,I.l6)(t.vault,s),initialData:[]}),[l,r]=(0,S.Z)(!0),{options:o}=(0,k.useMemo)(()=>{let e=i.map(e=>[(0,x.G$)(1e3*e.time,x.mv.ALL),l?logTrans(bnToNum(e.price)):bnToNum(e.price)]),valueFormater=e=>l?revertLog(e).toString():e.toString(),t={animation:!0,animationDuration:200,tooltip:{trigger:"axis",valueFormatter:valueFormater},grid:{top:30,bottom:30,right:20,show:!1},toolbox:{show:!1},xAxis:{type:"category",boundaryGap:!1,axisLine:{onZero:!1}},yAxis:{type:"value",boundaryGap:[0,"100%"],splitLine:{show:!1},max:e=>1.1*e.max,axisLabel:{formatter:valueFormater}},dataZoom:[{type:"inside",start:0,end:100,minValueSpan:10},{show:!1}],series:[{name:"YT Price",type:"line",symbol:"none",sampling:"lttb",itemStyle:{color:"rgb(30, 202, 83)"},areaStyle:{origin:"start",color:new Y.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgb(30, 202, 83)"},{offset:1,color:"rgba(30, 202, 83, 0.2)"}])},data:e}]};return{data:e,options:t}},[i,l]);return(0,a.jsxs)("div",{className:"card p-4 mx-auto max-w-4xl w-full min-w-0",children:[(0,a.jsxs)("div",{className:"flex justify-between gap-2 items-center",children:[(0,a.jsx)("span",{className:"text-base font-bold",children:"YT Price Chart"}),(0,a.jsx)("span",{className:"text-xs font-medium dark:text-[#FBECEC]"})]}),(0,a.jsx)("div",{className:"flex gap-2 justify-end items-center mt-2",children:(0,a.jsx)("span",{className:(0,x.cn)("cursor-pointer text-xs px-1 py-0 rounded border-primary border",l?"bg-primary":"bg-transparent"),onClick:()=>r(),children:"LOG"})}),(0,a.jsx)(L.Z,{option:o,style:{height:240}})]})}var q=s(73216),O=s(42487),M=s.n(O),G=s(95702);function GetLP(e){let{address:t}=e,s=c.P[t],n=(0,m.p)();return s?(0,a.jsxs)("div",{className:"text-xs font-medium flex gap-2 justify-end items-center",children:[(0,a.jsx)(G.cL,{symbol:"berahub",size:18}),(0,a.jsx)(M(),{target:"_blank",className:"underline",href:(0,q.FN)(n,t),children:"Get LP on Beraswap"})]}):null}var W=s(75496),Z=s(16738),U=s(60689),z=s(54825),H=s(6371),K=s(93680),_=s(26537);let $={Bera:K.Z,Bull:_.Z,Panda:i.Z,Venom:l.Z,BeraLine:K.Z,BullLine:_.Z,PandaLine:i.Z,VenomLine:l.Z},J="py-5 flex flex-col items-center gap-2 relative dark:border-border border-solid",renderToken=function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,a.jsx)("div",{className:(0,x.cn)(J,"border-b",{"border-l":n}),children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap flex gap-2 items-center",children:[(0,a.jsx)(G.cL,{symbol:e,size:14}),e]}),(0,a.jsxs)("div",{className:"flex mt-2 flex-col gap-1 pl-[1.375rem] text-xs font-medium",children:[(0,a.jsx)("span",{className:"",children:(0,f.d)(t)}),(0,a.jsx)("span",{className:" text-[#64748B] dark:text-slate-50/60",children:"$".concat((0,f.d)(s,2))})]})]})})},renderStat=function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,a.jsx)("div",{className:(0,x.cn)(J,"border-b pb-10",{"border-l":n}),children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap text-center",children:e}),(0,a.jsxs)("div",{className:"flex mt-2 items-center gap-2 text-sm font-medium",children:[(0,a.jsx)(G.cL,{symbol:t,size:14}),"string"==typeof s?(0,a.jsx)("span",{children:s}):s]})]})})},BtnWrap=e=>{let{children:t,onClick:s,...n}=e;return e.onClick?(0,a.jsx)(U.k,{...n,onClick:s,children:t}):(0,a.jsx)("div",{...n,onClick:s,children:t})},renderChoseSide=(e,t,s,n,i,l,r,o)=>{let c=$[e],d=$[n];return(0,a.jsxs)("div",{className:(0,x.cn)(J,"col-span-2 gap-4"),children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:"Choose your side"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 w-full px-4",children:[(0,a.jsx)(BtnWrap,{className:(0,x.cn)("h-[4.25rem] w-full relative"),onClick:r,children:(0,a.jsxs)("div",{className:"flex gap-2 items-center p-4 w-full h-[4.25rem] absolute left-0 top-0",children:[(0,a.jsx)(c,{className:"text-4xl",showbg:!0}),(0,a.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:t}),(0,a.jsx)("span",{className:" text-[14px] leading-[14px] font-medium",children:s})]})]})}),(0,a.jsx)(BtnWrap,{className:(0,x.cn)("h-[4.25rem] w-full relative"),onClick:o,children:(0,a.jsxs)("div",{className:"flex flex-row-reverse gap-2 items-center p-4 w-full h-[4.25rem] absolute left-0 top-0",children:[(0,a.jsx)(d,{className:"text-4xl",showbg:!0}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:i}),(0,a.jsx)("span",{className:" text-[14px] leading-[14px] font-medium",children:l})]})]})})]})]})};var Q=s(70283);function TupleTxt(e){return(0,a.jsxs)("div",{className:"flex items-center gap-5",children:[(0,a.jsx)("div",{className:"text-xs dark:text-white/60 font-medium",children:e.tit}),(0,a.jsx)("div",{className:(0,x.cn)("text-lg  font-medium flex items-center",e.subClassname),children:e.sub})]})}function BVaultRedeem(e){let{bvc:t}=e,[s,n]=(0,k.useState)(""),i=(0,x.su)(s),l=(0,b.nr)(t.vault),o=(0,b.Vw)(t.vault)[0],c=(0,p.o)(e=>e.sliceTokenStore.balances[t.pToken]||0n,["sliceTokenStore.balances.".concat(t.pToken)]),d=(0,b.R3)(t),u=l.current.duration>0n?"Waiting Time: ~".concat((0,x.Y)((l.current.duration+l.current.startTime)*1000n-BigInt(w().now()))):"";return(0,a.jsxs)("div",{className:(0,x.cn)("flex flex-col gap-1"),children:[(0,a.jsx)(V.W,{asset:t.pTokenSymbol,assetIcon:"Panda",amount:s,balance:c,setAmount:n}),!l.closed&&(0,a.jsxs)("div",{className:"text-xs font-medium text-center",children:[u," ",(0,a.jsx)(H.C,{children:"Wait to claim after the Epoch ends."})]}),(0,a.jsx)(F.v,{className:"mx-auto mt-6",tx:"Request",spender:null==o?void 0:o.redeemPool,approves:{[t.pToken]:i},disabled:o&&i<=0n||i>c,config:{abi:r.gg,address:(null==o?void 0:o.redeemPool)||E,functionName:"redeem",args:[i]},onTxSuccess:()=>{n(""),d()}})]})}function BVaultRedeemAll(e){let{bvc:t}=e,s=(0,p.o)(e=>e.sliceTokenStore.balances[t.pToken]||0n,["sliceTokenStore.balances.".concat(t.pToken)]),n=(0,b.R3)(t),{data:i}=(0,R.p)(),{ids:l,claimable:c}=(0,b.gz)(t.vault),d=(0,m.p)(),{mutate:u,isPending:j}=(0,v.D)({mutationKey:["readeemAll",s,c,l],mutationFn:async()=>{if(!i)throw"Error";let e=(0,h.B)(d);s>10n&&await i.writeContract({abi:r.j5,address:t.vault,functionName:"redeem",args:[s]}).then(t=>e.waitForTransactionReceipt({hash:t,confirmations:o.EI})),c>10n&&await i.writeContract({abi:r.j5,address:t.vault,functionName:"batchClaimRedeemAssets",args:[l]}).then(t=>e.waitForTransactionReceipt({hash:t,confirmations:o.EI})),A.A.success("Transaction success")},onSuccess:n,onError:x.S3}),g=!i||s+c<=100n;return(0,a.jsxs)("div",{className:(0,x.cn)("flex justify-between items-center gap-5 flex-wrap"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-nowrap",children:[(0,a.jsx)(G.cL,{symbol:t.assetSymbol,size:30})," ",t.assetSymbol]}),(0,a.jsxs)("div",{className:"whitespace-nowrap",children:["Balance: ",(0,f.d)(s)]}),(0,a.jsxs)("div",{className:"whitespace-nowrap",children:["Claimable: ",(0,f.d)(c)]}),(0,a.jsx)(U.k,{className:"mx-auto mt-6 flex items-center justify-center gap-2",busy:j,disabled:g,onClick:u,children:"Redeem All"})]})}function BVaultClaim(e){let{bvc:t}=e,s=(0,b.nr)(t.vault),n=(0,b.Vw)(t.vault)[0],l=(null==n?void 0:n.redeemingBalance)||0n,{ids:o,claimable:c}=(0,b.gz)(t.vault),d=(0,b.R3)(t);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-base font-medium items-center gap-5 pt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-black/60 dark:text-white/60 text-sm",children:"Available to Claim"}),(0,a.jsxs)("div",{className:"flex gap-4 items-center whitespace-nowrap mt-2",children:[(0,a.jsx)(G.cL,{symbol:t.yeetLiqSymbol||t.assetSymbol,size:24}),(0,a.jsx)("span",{className:"font-semibold",children:t.yeetLiqSymbol||t.assetSymbol}),(0,a.jsx)("span",{className:"text-black/60 dark:text-white/60 ",children:(0,f.d)(c)})]})]}),(0,a.jsx)(F.v,{className:"ml-auto w-1/3",busyShowTxet:!1,tx:"Claim",disabled:c<=0n,config:{abi:r.j5,address:t.vault,functionName:"batchClaimRedeemAssets",args:[o.length>40?o.slice(o.length-40):o]},onTxSuccess:()=>{d()}})]}),(0,a.jsx)("div",{className:"h-[1px] bg-border my-4"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-black/60 dark:text-white/60 mb-4",children:"Pending Requests"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(i.Z,{showbg:!0,className:"text-2xl"}),(0,a.jsx)("span",{className:"font-semibold",children:t.pTokenSymbol}),(0,a.jsx)("span",{className:"text-black/60 dark:text-white/60",children:(0,f.d)(l)}),(0,a.jsxs)("div",{className:"ml-auto text-xs text-black/60 dark:text-white/60 ",children:["Settlement Time : ",(0,a.jsx)("span",{className:"text-black dark:text-white font-semibold pr-2",children:(0,x.G$)((s.current.duration+s.current.startTime)*1000n,x.mv.DATE2)})," ",(0,x.Y)((s.current.duration+s.current.startTime)*1000n-BigInt(w().now()))]})]})]})]})}function BVaultP(e){var t;let{bvc:s}=e,[l,o]=(0,k.useState)(""),d=(0,x.su)(l),u=c.P[s.asset],m=!!u,h=m?"PT":s.pTokenSymbol,v=m?"LP":s.assetSymbol,j=(0,b.nr)(s.vault),g=(0,p.o)(e=>e.sliceTokenStore.balances[s.asset]||0n,["sliceTokenStore.balances.".concat(s.asset)]),[y]=(0,b.oU)(s),{data:w}=(0,R.p)(),T=(0,b.R3)(s),C=(0,N.useSearchParams)(),S=C.get("subtab"),B=(0,N.useRouter)(),P=[{tab:"Buy",content:(0,a.jsxs)("div",{className:"flex flex-col gap-1 w-full max-w-xl",children:[(0,a.jsx)(V.W,{asset:s.assetSymbol,amount:l,balance:g,setAmount:o}),(0,a.jsx)(GetLP,{address:s.asset}),(0,a.jsx)("div",{className:"text-xs font-medium text-center",children:"Receive 1 ".concat(h," for every ").concat(v)}),(0,a.jsx)(F.v,{className:"mx-auto mt-4",tx:"Buy",disabled:d<=0n||d>g,spender:s.vault,approves:{[s.asset]:d},config:{abi:r.j5,address:s.vault,functionName:"deposit",args:[d]},onTxSuccess:()=>{o(""),T()}})]})},{tab:"Withdraw",content:(0,a.jsx)(BVaultRedeem,{bvc:s})},{tab:"Claim",content:(0,a.jsx)(BVaultClaim,{bvc:s})}],A=null===(t=P.find(e=>e.tab.toLowerCase()==S))||void 0===t?void 0:t.tab;return(0,a.jsxs)("div",{className:(0,x.cn)("flex flex-col gap-5","max-w-4xl mx-auto w-full","max-w-xl"),children:[(0,a.jsxs)("div",{className:"card !p-0 overflow-hidden w-full",children:[(0,a.jsxs)("div",{className:"flex p-5 bg-[#A3D395] gap-5",children:[(0,a.jsx)(i.Z,{className:"text-[3.375rem]",showbg:!0}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("div",{className:"text-xl text-black font-semibold",children:s.pTokenSymbol}),(0,a.jsx)("div",{className:"text-xs text-black/60 font-medium",children:"Interest bearing rebase principal token"})]})]}),(0,a.jsxs)("div",{className:"flex items-baseline justify-between px-5 pt-5 gap-5",children:[(0,a.jsx)(TupleTxt,{tit:"APY Est.",sub:y}),(0,a.jsx)(TupleTxt,{tit:"Total Supply",sub:(0,a.jsx)(a.Fragment,{children:(0,f.d)(j.pTokenTotal)})})]}),(0,a.jsx)("div",{className:"flex px-2 pb-5",children:(0,a.jsx)("button",{className:"btn-link ml-auto text-black/60 dark:text-white/60 text-xs",onClick:()=>{null==w||w.watchAsset({type:"ERC20",options:{address:s.pToken,symbol:s.pTokenSymbol,decimals:18}}).catch(x.S3)},children:"Add to wallet"})})]}),(0,a.jsx)("div",{className:"md:col-span-2 card !p-4",children:(0,a.jsx)(Z.x,{currentTab:A,data:P,onTabChange:e=>(0,n.rc)(B,s.vault,"principal_panda",e)})})]})}function BVaultYInfo(e){let{bvc:t}=e,s=t.assetSymbol.includes("-"),n=s?"YT":t.yTokenSymbol,i=s?"LP token":t.assetSymbol,r=(0,b.nr)(t.vault),o=r.current,c=r.current.yTokenAmountForSwapYT>0n?r.lockedAssetTotal*d.Pq/r.current.yTokenAmountForSwapYT:0n,[m]=(0,b.v7)(t.vault),{roi:h,restakingIncomesApy:p,additionalRoi:v}=(0,u.tY)(t);return(0,a.jsxs)("div",{className:"card !p-0 overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"flex p-5 bg-[#F0D187] gap-5",children:[(0,a.jsx)(l.Z,{className:"text-[3.375rem]",showbg:!0}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("div",{className:"text-xl text-black font-semibold",children:t.yTokenSymbol}),(0,a.jsx)("div",{className:"text-xs text-black/60 font-medium",children:"Yield token"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col justify-between p-5 gap-5 flex-1",children:[(0,a.jsx)("div",{className:"flex justify-between items-baseline gap-4 flex-wrap",children:(0,a.jsxs)("div",{className:"text-xs flex gap-2 items-end",children:[(0,a.jsxs)(H.C,{node:(0,a.jsx)("span",{className:"text-2xl font-medium underline underline-offset-2 relative top-0.5",children:(0,x.Jh)(h,18,2)}),children:[(0,a.jsxs)("div",{children:["Berachain Emission: ",(0,x.Jh)(p,18,2)]}),(0,a.jsxs)("div",{children:["Additional airdrops: ",(0,x.Jh)(v,18,2)]}),(0,a.jsx)("br",{}),(0,a.jsx)("div",{children:"YT Spent: -100%"})]}),"Est.ROI in remaining days"]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-wrap justify-between",children:[(0,a.jsx)(TupleTxt,{tit:"Circulation amount",sub:(0,a.jsx)(a.Fragment,{children:(0,f.d)(r.current.yTokenAmountForSwapYT)})}),(0,a.jsxs)("span",{className:"text-xs",children:["1",n," = Yield of ",(0,f.d)(c,2)," ",i]})]}),o&&(0,a.jsxs)("div",{className:"dark:text-white/60 text-xs whitespace-nowrap gap-1 flex w-full flex-col",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Epoch ".concat(o.epochId.toString())}),(0,a.jsxs)("span",{className:"scale-90",children:["~",(0,x.Y)((o.startTime+o.duration)*1000n-BigInt(new Date().getTime()))," remaining"]})]}),(0,a.jsx)(g.k,{value:(e=>{let t=BigInt(Math.floor(new Date().getTime()/1e3));if(t<e.startTime)return 0;if(t-o.startTime>=o.duration)return 100;let s=(t-o.startTime)*100n/e.duration;return parseInt(s.toString())})(o),className:"mt-2 rounded-full overflow-hidden"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"scale-90",children:(0,x.G$)(1000n*o.startTime,x.mv.ALL2)}),(0,a.jsx)("span",{className:"scale-90",children:(0,x.G$)((o.startTime+o.duration)*1000n,x.mv.ALL2)})]})]})]})]})}function BVaultYTrans(e){let{bvc:t}=e,s=t.assetSymbol.includes("-");s||t.pTokenSymbol;let n=s?"YT":t.yTokenSymbol,i=s?"LP token":t.assetSymbol,[l,o]=(0,k.useState)(""),c=(0,x.su)(l),v=(0,b.nr)(t.vault),g=(0,p.o)(e=>e.sliceTokenStore.balances[t.asset]||0n,["sliceTokenStore.balances.".concat(t.asset)]),y=(0,m.p)(),[w,N]=(0,k.useState)(["calcSwap",t.vault,c,y]);(0,C.Z)(()=>N(["calcSwap",t.vault,c,y]),300,["calcSwap",t.vault,c,y]);let{data:B,isFetching:P}=(0,j.a)({queryKey:w,enabled:c>0n,queryFn:()=>(0,h.B)(y).readContract({abi:r.j5,address:t.vault,functionName:"calcSwap",args:[c]})}),[A,E]=(0,S.Z)(!1),R=v.current.vaultYTokenBalance,I=c>0n?(0,x.ok)(B,"1"):0n,L=R>0n?v.Y*d.Pq/R:0n,Y=L>0n?d.Pq*d.Pq/L:0n,D=A?"1 ".concat(i,"=").concat((0,f.d)(Y)," ").concat(n):"1 ".concat(n,"=").concat((0,f.d)(L)," ").concat(i),q=R>I?(v.Y+c)*d.Pq/(R-I):0n,O=(0,x.Kl)(I,void 0,!0),M=q>L&&L>0n?(q-L)*BigInt(1e10)/L:0n,G=(0,b.R3)(t),{roi:W,roiChange:Z}=(0,u.tY)(t,I,q);return(0,a.jsxs)("div",{className:"card !p-4 flex flex-col h-[24.25rem] gap-1",children:[(0,a.jsx)(V.W,{asset:t.assetSymbol,amount:l,balance:g,setAmount:o}),(0,a.jsx)(GetLP,{address:t.asset}),(0,a.jsx)("div",{className:"text-base font-bold my-2",children:"Receive"}),(0,a.jsx)(V.W,{asset:t.yTokenSymbol,assetIcon:"Venom",loading:P&&!!l,readonly:!0,disable:!0,checkBalance:!1,amount:O}),(0,a.jsxs)("div",{className:"text-xs font-medium  flex justify-between select-none",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(T.k$E,{className:"text-sm text-primary cursor-pointer inline-block",onClick:()=>E()}),(0,a.jsx)("span",{children:"Price: ".concat(D)})]}),(0,a.jsx)("div",{className:"flex gap-2 items-center",children:"Price Impact: ".concat((0,x.Jh)(M,10,2))})]}),I>0n&&(0,a.jsxs)("div",{className:"text-xs font-medium text-center my-auto text-black/80 dark:text-white/80",children:["Implied ROI Change: ",(0,x.Jh)(W,18,2)," ","->"," ",(0,a.jsx)("span",{className:(0,x.cn)({"text-red-400":W-Z>=BigInt(1e17)}),children:(0,x.Jh)(Z,18,2)})]}),(0,a.jsx)(F.v,{className:"mx-auto mt-auto",tx:"Buy",disabled:c<=0n||c>g,config:{abi:r.j5,address:t.vault,functionName:"swap",args:[c]},approves:{[t.asset]:c},spender:t.vault,onTxSuccess:()=>{o(""),G()}})]})}function BribeTit(e){return(0,a.jsxs)("div",{className:"flex items-center justify-start pl-5 gap-3",children:[(0,a.jsx)(G.cL,{symbol:"GreenDot",size:14}),(0,a.jsx)(H.C,{node:(0,a.jsx)("span",{className:"text-sm font-medium",children:(0,x.lS)(e.name,6,0)}),children:e.name.length>6?e.name:null})]})}function BVaultPoolsOld(e){var t;let{bvc:s}=e,[n,i]=(0,k.useState)(!1),l=(0,b.Vw)(s.vault),o=(0,k.useMemo)(()=>n?l.filter(e=>e.bribes.reduce((e,t)=>e+t.bribeAmount,0n)>0n):l,[l,n]),[c,u]=(0,B.Z)(),m="text-black/60 dark:text-white/60 text-sm",[h,p]=(0,k.useState)(null===(t=o[0])||void 0===t?void 0:t.epochId),v=(0,k.useMemo)(()=>h?o.find(e=>e.epochId==h):o[0],[o,h]),j=(null==v?void 0:v.userBalanceYToken)||0n,g=(null==v?void 0:v.userBalanceYTokenSyntyetic)||0n,onRowClick=e=>{var t;p(null===(t=o[e])||void 0===t?void 0:t.epochId)},y=(null==v?void 0:v.bribes)||[],w=(0,k.useMemo)(()=>{let e=y.find(e=>e.bribeAmount>0n);return e&&0n!=e.bribeTotalAmount?(0,x.Jh)(e.bribeAmount*d.Pq/e.bribeTotalAmount,18):(0,x.Jh)(0n,0n)},[y]),N=(0,b.R3)(s);return(0,a.jsxs)("div",{className:"md:h-[24.25rem] card !p-4",children:[(0,a.jsx)("div",{className:"font-bold text-base",children:"Harvest"}),(0,a.jsxs)("div",{className:(0,x.cn)("flex flex-col md:flex-row gap-4 mt-2"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 shrink-0 w-full md:w-[14.375rem]",ref:c,children:[(0,a.jsxs)("div",{className:"flex items-center gap-8 text-sm font-semibold",children:[(0,a.jsx)("span",{children:"My Pool Only"}),(0,a.jsx)(z.r,{checked:n,onChange:i})]}),(0,a.jsx)(P.aV,{className:o.length>6?"pr-5":"",width:u.width,height:280,rowHeight:e=>{let{index:t}=e;return t<o.length-1?76:56},overscanRowCount:6,rowCount:o.length,rowRenderer:function(e){let{key:t,style:s,index:n}=e,i=o[n],l="".concat((0,x.G$)(1000n*i.startTime),"-").concat((0,x.G$)((i.startTime+i.duration)*1000n));return(0,a.jsx)("div",{style:s,className:"cursor-pointer",onClick:()=>onRowClick(n),children:(0,a.jsxs)("div",{className:(0,x.cn)("h-[56px] card !rounded-lg !px-5 !py-2 font-semibold",n<o.length-1?"mb-[20px]":""),children:[(0,a.jsxs)("div",{className:"text-sm",children:["Epoch ",o[n].epochId.toString()]}),(0,a.jsx)("div",{className:"text-xs dark:text-white/60 mt-1",children:l})]})},t)}})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,a.jsxs)("div",{className:"flex gap-6 items-end font-semibold",children:[(0,a.jsx)("span",{className:"text-sm",children:"Accumulated Rewards"}),(0,a.jsxs)("span",{className:"text-xs dark:text-white/60",children:["Epoch ",((null==v?void 0:v.epochId)||1n).toString()]})]}),(0,a.jsx)("div",{className:"mt-2 rounded-lg border border-solid border-border px-4 py-1 h-[8.125rem] overflow-auto",children:(0,a.jsx)(W.ZP,{headerClassName:"text-center text-black/60 dark:text-white/60 border-b-0",headerItemClassName:"py-1",rowClassName:"text-center",cellClassName:"py-0",header:["","","Total","Mine",""],span:{1:2,2:1,3:1},data:y.map(e=>["",(0,a.jsx)(BribeTit,{name:e.bribeSymbol},"1"),(0,f.d)(e.bribeTotalAmount),(0,f.d)(e.bribeAmount),""])})}),(0,a.jsxs)("div",{className:"rounded-lg border border-solid border-border px-4 py-2 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"font-semibold text-xs",children:[(0,a.jsxs)("div",{children:["My yToken: ",(0,a.jsx)("span",{className:(0,x.cn)(m),children:(0,f.d)(j)})]}),(0,a.jsxs)("div",{children:["Time Weighted Points:"," ",(0,a.jsx)("span",{className:(0,x.cn)(m),children:j>0n&&0n==g?"Reward received":(0,f.d)(g)})]})]}),(0,a.jsxs)("div",{className:"text-sm",children:["My Share: ",(0,a.jsx)("span",{className:(0,x.cn)(m,"text-xl"),children:w})]})]}),(0,a.jsx)("span",{className:"text-xs mx-auto",children:"You can harvest at the end of Epoch"}),(0,a.jsx)(F.v,{className:"mx-auto mt-4",tx:"Harvest",disabled:!v||!(null==v?void 0:v.settled),config:{abi:r.j5,address:s.vault,functionName:"claimBribes",args:[null==v?void 0:v.epochId]},onTxSuccess:()=>{N()}})]})]})]})}function BVaultPools(e){var t,s;let{bvc:n}=e,[i,l]=(0,k.useState)(!1),o=(0,b.Vw)(n.vault),c=(0,k.useMemo)(()=>i?o.filter(e=>e.sBribes.reduce((e,t)=>e+t.bribeAmount,0n)>0n||e.aBribes.reduce((e,t)=>e+t.bribeAmount,0n)>0n):o,[o,i]),[d,u]=(0,B.Z)(),[m,h]=(0,k.useState)(null===(t=c[0])||void 0===t?void 0:t.epochId),p=(0,k.useMemo)(()=>m?c.find(e=>e.epochId==m):c[0],[c,m]),v=(null==p?void 0:p.userBalanceYToken)||0n,j=(null==p?void 0:p.userBalanceYTokenSyntyetic)||0n,g=(null==p?void 0:p.userClaimableYTokenSyntyetic)||0n,onRowClick=e=>{var t;h(null===(t=c[e])||void 0===t?void 0:t.epochId)};(0,k.useEffect)(()=>{var e,t;o.length&&h((null===(e=c[0])||void 0===e?void 0:e.epochId)||(null===(t=o[0])||void 0===t?void 0:t.epochId))},[o.length]);let y=(null==p?void 0:p.sBribes)||[],w=(null==p?void 0:p.aBribes)||[],{data:N}=(0,Q.x)(),T=null===(s=N["".concat(n.vault)])||void 0===s?void 0:s[parseInt((m||0n).toString())],C=(0,b.R3)(n);return(0,a.jsxs)("div",{className:"md:h-[24.25rem] card !p-4",children:[(0,a.jsx)("div",{className:"font-bold text-base",children:"Harvest"}),(0,a.jsxs)("div",{className:(0,x.cn)("flex flex-col md:flex-row gap-4 mt-2"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 shrink-0 w-full md:w-[14.375rem]",ref:d,children:[(0,a.jsxs)("div",{className:"flex items-center gap-8 text-sm font-semibold",children:[(0,a.jsx)("span",{children:"My Pool Only"}),(0,a.jsx)(z.r,{checked:i,onChange:l})]}),(0,a.jsx)(P.aV,{className:c.length>6?"pr-5":"",width:u.width,height:280,rowHeight:e=>{let{index:t}=e;return t<c.length-1?76:56},overscanRowCount:6,rowCount:c.length,rowRenderer:function(e){let{key:t,style:s,index:n}=e,i=c[n],l="".concat((0,x.G$)(1000n*i.startTime),"-").concat((0,x.G$)((i.startTime+i.duration)*1000n));return(0,a.jsx)("div",{style:s,className:"cursor-pointer",onClick:()=>onRowClick(n),children:(0,a.jsxs)("div",{className:(0,x.cn)("h-[56px] card !rounded-lg !px-5 !py-2 font-semibold",n<c.length-1?"mb-[20px]":""),children:[(0,a.jsxs)("div",{className:"text-sm",children:["Epoch ",c[n].epochId.toString()]}),(0,a.jsx)("div",{className:"text-xs opacity-60 mt-1",children:l})]})},t)}})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,a.jsxs)("div",{className:"flex gap-6 items-end font-semibold",children:[(0,a.jsx)("span",{className:"text-sm",children:"Rewards"}),(0,a.jsxs)("span",{className:"text-xs opacity-60",children:["Epoch ",((null==p?void 0:p.epochId)||1n).toString()]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto flex flex-col gap-4 font-semibold text-sm",children:[(0,a.jsxs)("div",{className:"flex gap-12 items-end font-semibold",children:[(0,a.jsx)("span",{className:"text-sm",children:"YT Balance"}),(0,a.jsx)("span",{className:"text-sm opacity-60",children:(0,f.d)(v)})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-5 justify-start relative pt-8 items-center",children:[y.map(e=>(0,a.jsxs)("div",{className:"flex items-center w-full relative gap-20 pl-[20%]",children:[(0,a.jsx)(BribeTit,{name:e.bribeSymbol}),(0,a.jsx)("div",{className:"absolute left-1/2",children:(0,f.d)(e.bribeAmount)})]},e.bribeToken)),(0,a.jsx)("span",{className:"absolute left-0 top-0",children:"Berachain Emission"}),(0,a.jsx)("span",{className:"absolute left-1/2 top-0 opacity-60",children:"Claimable"}),(0,a.jsx)(F.v,{className:"absolute w-28 top-0 right-0",tx:"Claim",disabled:!p,config:{abi:r.l0,address:null==p?void 0:p.stakingBribesPool,functionName:"getBribes"},onTxSuccess:()=>{C()}})]}),(0,a.jsxs)("div",{className:"flex items-center relative",children:[(0,a.jsxs)("span",{className:"text-sm",children:["YT Points ",(0,a.jsx)(H.C,{children:"YT Points are calculated based on the duration of YT holding and apply to some uncertain rewards, such as airdrops."})]}),(0,a.jsx)("span",{className:" opacity-60 ml-10",children:(0,f.d)(j,void 0,23)}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 absolute left-1/2 top-0",children:[(0,a.jsx)("span",{className:"opacity-60",children:"Claimable"}),(0,a.jsx)("span",{children:(0,f.d)(g,void 0,23)})]}),(0,a.jsx)(F.v,{className:"w-28 ml-auto",tx:"Claim",disabled:!p,config:{abi:r.q3,address:null==p?void 0:p.adhocBribesPool,functionName:"collectYT"},onTxSuccess:()=>{C()}})]}),w.length>0&&(0,a.jsxs)("div",{className:"flex flex-col gap-5 justify-start relative pt-8 items-center",children:[w.map(e=>(0,a.jsxs)("div",{className:"flex items-center w-full relative gap-20 pl-[20%]",children:[(0,a.jsx)(BribeTit,{name:e.bribeSymbol}),(0,a.jsx)("div",{className:"absolute left-1/2",children:(0,f.d)(e.bribeAmount)})]},e.bribeToken)),(0,a.jsx)("span",{className:"absolute left-0 top-0",children:"Additional Incentives"}),(0,a.jsx)("span",{className:"absolute left-1/2 top-0 opacity-60",children:"Claimable"}),(0,a.jsx)(F.v,{className:"absolute w-28 top-0 right-0",tx:"Claim",disabled:!p,config:{abi:r.q3,address:null==p?void 0:p.adhocBribesPool,functionName:"getBribes"},onTxSuccess:()=>{C()}})]}),(0,a.jsxs)("div",{className:"text-center text-sm font-medium flex items-center flex-nowrap justify-center whitespace-nowrap mt-auto gap-1",children:["Additional Airdrops: ",T?(0,a.jsxs)(a.Fragment,{children:[T.amount," ",(0,a.jsx)(G.cL,{symbol:T.token,size:16})," ",T.token," ",(0,a.jsx)(H.C,{children:"Will be distributed based on YT points after Epoch ends"})]}):"TBD"]})]})]})]})]})}function BVaultB(e){let{bvc:t}=e,s=(0,b.nr)(t.vault);return(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[4fr_6fr] gap-5",children:[(0,a.jsx)(BVaultYInfo,{bvc:t}),(0,a.jsx)(BvaultEpochYtPrices,{bvc:t,epochId:s.epochCount}),(0,a.jsx)(BVaultYTrans,{bvc:t}),t.isOld?(0,a.jsx)(BVaultPoolsOld,{bvc:t}):(0,a.jsx)(BVaultPools,{bvc:t})]})}function BVaultCard(e){let{vc:t}=e,s=(0,N.useRouter)(),[i,l]=t.assetSymbol.split("-"),r=(0,b.nr)(t.vault),o=c.P[t.asset],m=(0,p.o)(e=>e.sliceTokenStore.prices,["sliceTokenStore.prices"]),h=o&&m[o.base]||0n,v=o&&m[o.quote]||0n,j=r.lpBase||0n,g=r.lpQuote||0n,y=j*h/d.Pq,k=g*v/d.Pq,T=y+k;0n===T&&(T=r.lockedAssetTotal);let[C]=(0,b.v7)(t.vault),[S]=(0,b.oU)(t),B="Epoch ".concat(((null==r?void 0:r.epochCount)||0n).toString()),P=0n==r.epochCount?"-- -- --":(0,x.G$)((r.current.startTime+r.current.duration)*1000n,x.mv.DATE2),A=0n==r.epochCount?"":(0,x.Y)((r.current.startTime+r.current.duration)*1000n-BigInt(w().now())),{roi:E}=(0,u.tY)(t);return(0,a.jsxs)("div",{className:(0,x.cn)("card !p-0 grid grid-cols-2 overflow-hidden",{}),children:[(0,a.jsxs)("div",{className:(0,x.cn)(J,"border-b","bg-black/10 dark:bg-white/10 col-span-2 flex-row px-4 md:px-5 py-4 items-center"),children:[o?(0,a.jsx)(G.rw,{symbol1:i,symbol2:l,size:28}):(0,a.jsx)(G.cL,{symbol:t.assetSymbol,size:44}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:" text-lg font-semibold whitespace-nowrap",children:t.assetSymbol}),(0,a.jsx)("div",{className:" text-sm font-medium",children:t.assetSymbol.includes("-")?"LP Token":""})]}),(0,a.jsxs)("div",{className:"ml-auto",children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold whitespace-nowrap",children:"Total Value Locked"}),(0,a.jsxs)("div",{className:"text-sm font-medium",children:["$",(0,f.d)(T,2)]})]})]}),renderToken(i,j,y),renderToken(l,g,k,!0),renderStat("Settlement Time",r.closed?"status-red":"status-green",r.closed?"Closed":(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,a.jsx)("span",{children:P}),(0,a.jsx)("span",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold whitespace-nowrap",children:A})]}),r.epochCount>0n&&(0,a.jsx)("div",{className:"absolute top-full mt-1 left-0 text-[#64748B] dark:text-slate-50/60 text-xs font-semibold whitespace-nowrap",children:B})]})),renderStat("Reward",t.rewardSymbol||"iBGT",t.rewardSymbol||"iBGT",!0),renderChoseSide("Panda","Principal Panda",S,"Venom","Boost Venom","".concat((0,x.Jh)(E,18,2)),e=>{e.stopPropagation(),(0,n.rc)(s,t.vault,"principal_panda")},e=>{e.stopPropagation(),(0,n.rc)(s,t.vault,"boost_venom")})]})}function BVaultCardComming(e){let{symbol:t}=e,[s,n]=(t||"").split("-");return(0,a.jsxs)("div",{className:(0,x.cn)("card cursor-pointer !p-0 grid grid-cols-2 overflow-hidden h-[419px]",{}),children:[(0,a.jsxs)("div",{className:(0,x.cn)(J,"border-b","bg-black/10 dark:bg-white/10 col-span-2 flex-row px-4 md:px-5 py-4 items-center h-20"),children:[t&&(0,a.jsx)(a.Fragment,{children:n?(0,a.jsx)(G.rw,{symbol1:s,symbol2:n,size:28}):(0,a.jsx)(G.cL,{symbol:t,size:44})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:" text-lg font-semibold whitespace-nowrap",children:t}),(0,a.jsx)("div",{className:" text-sm font-medium",children:t.includes("-")?"LP Token":""})]}),(0,a.jsxs)("div",{className:"ml-auto",children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold whitespace-nowrap",children:"Total Value Locked"}),(0,a.jsx)("div",{className:"text-sm font-medium",children:"$-"})]})]}),(0,a.jsx)("div",{className:(0,x.cn)(J,"col-span-2"),children:(0,a.jsx)("div",{className:"text-xs font-semibold leading-[12px] whitespace-nowrap",children:"New Vault Coming Soon..."})})]})}var X=s(19757),ee=s(36602),et=s(83960),es=s(61766),ea=s(58714),en=s(96670);function PulseTokenItem(){return(0,a.jsxs)("div",{className:"animate-pulse flex px-4 py-2 items-center gap-4 rounded-lg",children:[(0,a.jsx)("div",{className:"rounded-full w-10 h-10 bg-slate-400"}),(0,a.jsx)("div",{className:"w-28 h-5 rounded-lg bg-slate-400"}),(0,a.jsx)("div",{className:"ml-auto w-12 h-5 rounded-lg bg-slate-400"})]})}var ei=s(2987);let el=[{symbol:"HONEY",name:"HONEY Token",address:"0x0e4aaf1351de4c0264c5c7056ef3777b41bd8e03",decimals:18},{symbol:"USDC",name:"USD Coin",address:"0xd6d83af58a19cd14ef3cf6fe848c9a4d21e5727c",decimals:18},{symbol:"WBERA",name:"BERA Token",address:"0x7507c1dc16935b82698e4c63f2746a2fcf994df8",decimals:18},{symbol:"iBGT",name:"Infrared BGT",address:"0x46eFC86F0D7455F135CC9df501673739d513E982",decimals:18},{symbol:"USDT",name:"Tether USD",address:"0x05D0dD5135E3eF3aDE32a9eF9Cb06e8D37A6795D",decimals:18},{symbol:"DAI",name:"Decentralized USD",address:"0x806Ef538b228844c73E8E692ADCFa8Eb2fCF729c",decimals:18},{symbol:"WBTC",name:"Wrapped Bitcoin",address:"0x2577D24a26f8FA19c1058a8b0106E2c7303454a4",decimals:18},{symbol:"WETH",name:"Wrapped Ether",address:"0xE28AfD8c634946833e89ee3F122C06d7C537E8A8",decimals:18}],er=[{symbol:"iBGT",name:"Infrared BGT",address:"0xac03CABA51e17c86c921E1f6CBFBdC91F8BB2E6b",decimals:18},{symbol:"HONEY",name:"HONEY Token",address:"0xFCBD14DC51f0A4d49d5E53C2E0950e0bC26d0Dce",decimals:18},{symbol:"USDC",name:"USDC Token",address:"0x549943e04f40284185054145c6E4e9568C1D3241",decimals:6},{symbol:"WBERA",name:"Wrapped Bera",address:"0x6969696969696969696969696969696969696969",decimals:18}];function TokenSelect(e){let{tokens:t,onSelect:s,hiddenNative:n}=e,i=(0,m.p)(),l=(0,p.o)(e=>e.sliceTokenStore.defTokenList),r=(0,k.useMemo)(()=>{let e=w().isEmpty(t)?w().isEmpty(l)?i==q.On.id?er:el:l:t;return n?e.filter(e=>e.address!==E&&e.address!==X.K8):e},[t,l,n,i]),[o,c]=(0,k.useState)(""),d=(0,ee.ln)(),{address:u}=(0,en.m)(),[b,v]=(0,k.useState)(["searchTokens",o,r]);(0,C.Z)(()=>v(["searchTokens",o,r]),300,[o,r]);let{data:g,isFetching:y}=(0,j.a)({initialData:r,queryFn:async()=>{if((0,es.U)(o)){let e=r.find(e=>e.address==o);if(e)return[e];let t=(0,h.B)(i),[s,a]=await Promise.all([t.readContract({abi:ea.Wo,address:o,functionName:"symbol"}),t.readContract({abi:ea.Wo,address:o,functionName:"decimals"})]);return u&&p.w.getState().sliceTokenStore.updateTokensBalance(i,[o],u),[{symbol:s,address:o,decimals:a}]}return o?r.filter(e=>{let t=o.toLowerCase(),s=!!e.symbol.toLowerCase().match(t),a=!!e.name&&!!e.name.toLowerCase().match(t);return s||a}):r},queryKey:b}),N=g||r;return(0,j.a)({queryKey:["updateBalancesForUnknowToken",r],enabled:!!u,queryFn:()=>p.w.getState().sliceTokenStore.updateTokensBalance(i,r.map(e=>e.address),u)}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 p-5",children:[(0,a.jsx)("div",{className:"page-sub text-center",children:"Select a token"}),(0,a.jsx)("input",{className:(0,x.cn)("bg-white dark:bg-transparent","border-slate-400  focus:border-primary","w-full h-14 text-right px-4 font-bold text-base border-[#4A5546] border focus:border-2 text-slate-700 rounded-lg outline-none dark:text-slate-50"),placeholder:"Search by name, symbol or address",value:o,onChange:e=>c(e.target.value)}),(0,a.jsx)("div",{className:"flex flex-col overflow-y-auto h-[18.75rem]",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(PulseTokenItem,{}),(0,a.jsx)(PulseTokenItem,{}),(0,a.jsx)(PulseTokenItem,{})]}):(0,a.jsx)(a.Fragment,{children:N.map(e=>(0,a.jsxs)("div",{className:"flex px-4 py-2 items-center gap-4 rounded-lg cursor-pointer hover:bg-primary/20",onClick:()=>{null==s||s(e)},children:[(0,a.jsx)(G.cL,{className:"rounded-full",size:40,symbol:e.symbol,url:e.url}),(0,a.jsx)("span",{children:e.symbol}),(0,a.jsx)("span",{className:"ml-auto",children:(0,f.d)(d[e.address],3,e.decimals)})]},e.address))})})]})}function BVaultAddReward(e){let{bvc:t}=e,s=(0,ee.ln)(),n=(0,b.nr)(t.vault),i=(0,p.o)(e=>e.sliceTokenStore.defTokenList),l=w().isEmpty(i)?el[0]:i[0],[o,c]=(0,k.useState)(l),[d,u]=(0,k.useState)(""),f=s[o.address],j=(0,x.su)(d,o.decimals),g=(0,k.useRef)(null),y=(0,R.p)(),{address:N}=(0,en.m)(),T=(0,m.p)(),{mutate:C,isPending:S}=(0,v.D)({mutationFn:async()=>{if(B)return;let e=(0,h.B)(T);if(t.isOld){let s=await e.readContract({abi:r.j5,address:t.vault,functionName:"bribeTokens",args:[n.epochCount]});if(console.info("tokens:",s,o.address),!s.find(e=>e.toLowerCase()==o.address.toLowerCase())){let s=await y.data.writeContract({abi:r.j5,address:t.vault,functionName:"addBribeToken",args:[o.address]});await e.waitForTransactionReceipt({hash:s,confirmations:3})}let a=await e.readContract({abi:ea.Wo,address:o.address,functionName:"allowance",args:[N,t.vault]});if(a<j){let s=await y.data.writeContract({abi:ea.Wo,address:o.address,functionName:"approve",args:[t.vault,j-a]});await e.waitForTransactionReceipt({hash:s,confirmations:3})}let i=await y.data.writeContract({abi:r.j5,address:t.vault,functionName:"addBribes",args:[o.address,j]});await e.waitForTransactionReceipt({hash:i,confirmations:3})}else{let s=await e.readContract({abi:ea.Wo,address:o.address,functionName:"allowance",args:[N,t.vault]});if(s<j){let a=await y.data.writeContract({abi:ea.Wo,address:o.address,functionName:"approve",args:[t.vault,j-s]});await e.waitForTransactionReceipt({hash:a,confirmations:3})}let a=await y.data.writeContract({abi:r.j5,address:t.vault,functionName:"addAdhocBribes",args:[o.address,j]});await e.waitForTransactionReceipt({hash:a,confirmations:3})}p.w.getState().sliceTokenStore.updateTokensBalance(T,[o.address],N),u(""),A.A.success("Transaction success")},mutationKey:["addReward"],onError:x.S3}),B=!y.data||!N||0n==j||j>f||S||0n==n.epochCount;return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto mt-8 card",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(V.W,{decimals:o.decimals,asset:o.symbol,assetURL:o.url,balance:s[o.address],amount:d,setAmount:u}),(0,a.jsx)(ei.o,{trigger:(0,a.jsxs)("div",{ref:g,className:"absolute left-0 top-0 flex cursor-pointer justify-end items-center py-4",children:[(0,a.jsx)("span",{className:"invisible pl-12",children:o.symbol}),(0,a.jsx)(et.tv1,{className:"ml-2"})]}),children:(0,a.jsx)(TokenSelect,{hiddenNative:!0,onSelect:e=>{var t;c(e),null===(t=g.current)||void 0===t||t.click()}})})]}),(0,a.jsx)(U.k,{busy:S,className:"w-full flex justify-center items-center gap-2",disabled:B,onClick:()=>C(),children:"Add"})]})}var eo=s(6868),ec=s(44939),ed=s(87031),eu=s(31889),em=s(62600),ex=s(75847),eh=s(17686),ep=s(45631);let eb=["redeem","principal_panda","boost_venom"];function BVaultPage(e){var t;let{bvc:s,currentTab:i}=e,{address:l}=(0,en.m)(),o=(0,b.nr)(s.vault),c=(0,m.p)();(0,j.a)({queryKey:["UpdateVaultDetails",c,s,o],queryFn:async()=>0n!=o.epochCount&&(await p.w.getState().sliceBVaultsStore.updateEpoches(c,s),!0)});let d=(0,b.Zd)(s.vault);(0,j.a)({queryKey:["UpdateUserData",s,d,l],queryFn:async()=>0!=d.length&&!!l&&(console.info("epochesOld:",d),await p.w.getState().sliceUserBVaults.updateEpoches(c,s,l,d),!0)});let{data:u}=(0,j.a)({queryKey:["checkIsBriber",c,l,s],queryFn:async()=>{if(!l)return!1;let e=(0,h.B)(c),t=await Promise.all([e.readContract({abi:r.j5,address:s.vault,functionName:"isBriber",args:[l]}),e.readContract({abi:r.j5,address:s.vault,functionName:"owner"}).then(e=>e==l)]);return t.includes(!0)||(0,ex.E)(l,"0xFE18Aa1EFa652660F36Ab84F122CD36108f903B6")}}),f=[...o.closed?[{tab:"Redeem",content:(0,a.jsx)("div",{className:"max-w-xl mx-auto pt-8 w-full",children:(0,a.jsx)(BVaultRedeemAll,{bvc:s})})}]:[{tab:"Principal Panda",content:(0,a.jsx)(BVaultP,{bvc:s})}],{tab:"Boost Venom",content:(0,a.jsx)(BVaultB,{bvc:s})}],v=u?[...f,{tab:"Add Reward",content:(0,a.jsx)(BVaultAddReward,{bvc:s})}]:f,g=null===(t=v.find(e=>(0,x.pi)(e.tab)==i))||void 0===t?void 0:t.tab,y=(0,N.useRouter)();return(0,a.jsx)(Z.x,{currentTab:g,onTabChange:e=>(0,n.rc)(y,s.vault,e),listClassName:"flex-wrap p-0 mb-5 md:gap-14",triggerClassName:'text-lg sm:text-xl md:text-2xl py-0 data-[state="active"]:border-b border-b-black dark:border-b-white leading-[0.8] rounded-none whitespace-nowrap',contentClassName:"gap-5",data:v})}let ef=[{label:"Active",value:"Active"},{label:"All",value:"All"},{label:"Closed",value:"Closed"}];function Vaults(){var e;let t=(0,m.p)(),s=(0,k.useMemo)(()=>ed.Fw[t].filter(e=>e.onEnv&&e.onEnv.includes(d.Vi)),[t,d.Vi]),n=(0,N.useSearchParams)(),i=n.get("vault"),l=n.get("tab"),r=eb.includes(l)?l:"",o=s.find(e=>e.vault==i),{loading:c}=(0,eu.Ev)(),[u,h]=(0,k.useState)(null!==(e=ef.find(e=>e.value===sessionStorage.getItem("bvualts-filter")))&&void 0!==e?e:ef[0]),wrapSetFilter=e=>{h(e),sessionStorage.setItem("bvualts-filter",e.value)},b=(0,p.o)(e=>e.sliceBVaultsStore.bvaults,["sliceBVaultsStore.bvaults"]),f=(0,k.useMemo)(()=>c||"All"==u.label?s:"Active"==u.label?s.filter(e=>{var t;return!(null===(t=b[e.vault])||void 0===t?void 0:t.closed)}):s.filter(e=>{var t;return!!(null===(t=b[e.vault])||void 0===t?void 0:t.closed)}),[c,b,u,s]);return(0,a.jsx)(ec.E,{children:(0,a.jsx)("div",{className:"w-full max-w-[1232px] px-4 mx-auto md:pb-8",children:o?(0,a.jsx)(BVaultPage,{bvc:o,currentTab:r}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"page-title",children:"B-Vaults"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-5 w-full items-center justify-between",children:[(0,a.jsx)(eo.K,{className:"w-auto",data:"A Pendle-like Yield Tokenization Protocol Tailored for Proof-of-Liquidity (POL)."}),(0,a.jsx)(ep.ZP,{onChange:e=>e&&wrapSetFilter(e),value:u,classNames:{menu:()=>(0,x.cn)("bg-white dark:bg-black dark:border"),option:e=>(0,x.cn)("cursor-pointer",{"!bg-primary/50":e.isFocused,"!bg-primary":e.isSelected}),control:()=>"bg-white dark:bg-black !border-primary/70 !shadow-none cursor-pointer",singleValue:()=>"dark:text-white"},options:ef})]}),c?(0,a.jsx)("div",{className:"w-full flex items-center justify-center pt-40",children:(0,a.jsx)(eh.fCD,{className:"animate-spin text-4xl opacity-80"})}):(0,a.jsxs)(em.r,{numItems:1,numItemsMd:2,numItemsLg:3,className:"gap-5 mt-4",children:[f.map((e,t)=>(0,a.jsx)(BVaultCard,{vc:e},"group_vault_item_".concat(t))),0==s.length&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(BVaultCardComming,{symbol:"HONEY-USDC"}),(0,a.jsx)(BVaultCardComming,{symbol:"HONEY-WBERA"}),(0,a.jsx)(BVaultCardComming,{symbol:"HONEY-WETH"})]}),1==s.length&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(BVaultCardComming,{symbol:"HONEY-WBERA"}),(0,a.jsx)(BVaultCardComming,{symbol:"HONEY-WETH"})]}),2==s.length&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(BVaultCardComming,{symbol:"HONEY-WETH"})})]})]})})})}},6868:function(e,t,s){"use strict";s.d(t,{K:function(){return Noti}});var a=s(31113),n=s(26361);s(64103);var i=s(63114);function Noti(e){let{data:t,className:s}=e;return(0,a.jsxs)("div",{className:(0,n.cn)("w-full mt-2 mb-3 md:mt-4 md:mb-6 flex text-[24px] md:text-[14px] text-[#64748B] dark:text-slate-50/60 font-medium leading-[24px] md:leading-[14px]",s),children:[(0,a.jsx)("div",{className:"",children:(0,a.jsx)(i.pMA,{size:20})}),(0,a.jsx)("div",{className:"text-sm ml-1 ",children:t})]})}},7993:function(e,t,s){"use strict";s.d(t,{tY:function(){return useBvaultROI}});var a=s(66499),n=s(22139),i=s(22818),l=s(55349),r=s(18358),o=s(64370),c=s(83978),d=s.n(c),u=s(11292),m=s(42087),x=s(33737),h=s(70283),p=s(4848),b=s(26361),f=s(59175);function calcRestakingApy(e,t,s){let a=t>0n?e*s/t:0n;return a>100n*n.Pq?0n:a}function calcAdditionalApy(e,t,s,a,i){let l=t>0n&&s>0n?t+s*a:0n,r=l>0n?e*n.Pq/l:0n,o=n.Pq*a,c=r*o/n.Pq,d=i>0n?c*n.Pq/i:0n;return d}function useBvaultROI(e){var t,s;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0n,v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0n,j=(0,r.nr)(e.vault),{data:g,isLoading:y}=(s=e.vault,(0,o.a)({initialData:0n,queryKey:["getReturnsIBGT",s],queryFn:async()=>{let e=await p.ZP.get("/api/bvault/getYieldiBGT/".concat(s)),t=BigInt(e.yield)/BigInt(e.dur);return t}})),{data:w,isLoading:N}=(0,h.x)(),k=j.current.duration+j.current.startTime,T=k>0n?k-BigInt(d().round(d().now()/1e3)):0n,C=j.current.yTokenAmountForSwapYT,S=C>0n?g*n.Pq*T/C:0n,B=(0,l.o)(e=>e.sliceTokenStore.prices["0xac03CABA51e17c86c921E1f6CBFBdC91F8BB2E6b"],["sliceTokenStore.prices.0xac03CABA51e17c86c921E1f6CBFBdC91F8BB2E6b"])||0n,P=(0,l.o)(e=>e.sliceTokenStore.prices,["sliceTokenStore.prices"])||0n,A=(0,r.Pd)(e.vault,e.asset);console.info("Prices:",e.assetSymbol,(0,u.d)(B),(0,u.d)(A));let E=j.current.vaultYTokenBalance,R=C+c>0n?g*n.Pq*T/(C+c):0n,F=E>0n?j.Y*n.Pq/E:0n,V=F*A/n.Pq,I=v*A/n.Pq,L=calcRestakingApy(S,V,B),Y=c>0n?calcRestakingApy(R,I,B):0n;console.info("restakingapy:",e.assetSymbol,(0,u.d)(L),(0,u.d)(S),(0,u.d)(F),(0,u.d)(V));let D=null===(t=w["".concat(e.vault)])||void 0===t?void 0:t[parseInt(j.epochCount.toString())],q=D&&D.token&&D.amount?(0,b.ok)(P,h.c[D.token])*function(e,t="wei"){return(0,x.v)(e,m.ez[t])}(D.amount.toFixed(6))/n.Pq:0n,{data:O,isLoading:M}=function(e){let t=(0,r.nr)(e),s=(0,f.p)();return(0,o.a)({initialData:0n,gcTime:36e5,queryKey:["ytPoints",s,e,t.current.adhocBribesPool],enabled:!!e&&!!t.current.adhocBribesPool,queryFn:async()=>{let e=(0,i.B)(s);return e.readContract({abi:a.q3,address:t.current.adhocBribesPool,functionName:"totalSupply"})}})}(e.vault),G=calcAdditionalApy(q,O,C,T,V),W=c>0n?calcAdditionalApy(q,O,C+c,T,I):0n,Z=y||N||M;return{roi:!Z&&C>0n&&S>0n?L+G-n.Pq:0n,roiChange:!Z&&C>0n&&S>0n?Y+W-n.Pq:0n,restakingIncomesApy:L,additionalRoi:G}}},83716:function(e,t,s){"use strict";s.d(t,{R:function(){return getDefaultState},m:function(){return l}});var a=s(64583),n=s(93242),i=s(76937),l=class extends n.F{#e;#t;#s;constructor(e){super(),this.mutationId=e.mutationId,this.#t=e.mutationCache,this.#e=[],this.state=e.state||getDefaultState(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#e.includes(e)||(this.#e.push(e),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#e=this.#e.filter(t=>t!==e),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#e.length||("pending"===this.state.status?this.scheduleGc():this.#t.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(e){this.#s=(0,i.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(Error("No mutationFn found")),onFail:(e,t)=>{this.#a({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});let t="pending"===this.state.status,s=!this.#s.canStart();try{if(!t){this.#a({type:"pending",variables:e,isPaused:s}),await this.#t.config.onMutate?.(e,this);let t=await this.options.onMutate?.(e);t!==this.state.context&&this.#a({type:"pending",context:t,variables:e,isPaused:s})}let a=await this.#s.start();return await this.#t.config.onSuccess?.(a,e,this.state.context,this),await this.options.onSuccess?.(a,e,this.state.context),await this.#t.config.onSettled?.(a,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(a,null,e,this.state.context),this.#a({type:"success",data:a}),a}catch(t){try{throw await this.#t.config.onError?.(t,e,this.state.context,this),await this.options.onError?.(t,e,this.state.context),await this.#t.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,t,e,this.state.context),t}finally{this.#a({type:"error",error:t})}}finally{this.#t.runNext(this)}}#a(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),a.V.batch(()=>{this.#e.forEach(t=>{t.onMutationUpdate(e)}),this.#t.notify({mutation:this,type:"updated",action:e})})}};function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},95499:function(e,t,s){"use strict";s.d(t,{D:function(){return useMutation}});var a=s(64103),n=s(83716),i=s(64583),l=s(7539),r=s(72549),o=class extends l.l{#n;#i=void 0;#l;#r;constructor(e,t){super(),this.#n=e,this.setOptions(t),this.bindMethods(),this.#o()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#n.defaultMutationOptions(e),(0,r.VS)(this.options,t)||this.#n.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#l,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,r.Ym)(t.mutationKey)!==(0,r.Ym)(this.options.mutationKey)?this.reset():this.#l?.state.status==="pending"&&this.#l.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#l?.removeObserver(this)}onMutationUpdate(e){this.#o(),this.#c(e)}getCurrentResult(){return this.#i}reset(){this.#l?.removeObserver(this),this.#l=void 0,this.#o(),this.#c()}mutate(e,t){return this.#r=t,this.#l?.removeObserver(this),this.#l=this.#n.getMutationCache().build(this.#n,this.options),this.#l.addObserver(this),this.#l.execute(e)}#o(){let e=this.#l?.state??(0,n.R)();this.#i={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#c(e){i.V.batch(()=>{if(this.#r&&this.hasListeners()){let t=this.#i.variables,s=this.#i.context;e?.type==="success"?(this.#r.onSuccess?.(e.data,t,s),this.#r.onSettled?.(e.data,null,t,s)):e?.type==="error"&&(this.#r.onError?.(e.error,t,s),this.#r.onSettled?.(void 0,e.error,t,s))}this.listeners.forEach(e=>{e(this.#i)})})}},c=s(83037),d=s(17275);function useMutation(e,t){let s=(0,c.NL)(t),[n]=a.useState(()=>new o(s,e));a.useEffect(()=>{n.setOptions(e)},[n,e]);let l=a.useSyncExternalStore(a.useCallback(e=>n.subscribe(i.V.batchCalls(e)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),r=a.useCallback((e,t)=>{n.mutate(e,t).catch(d.Z)},[n]);if(l.error&&(0,d.L)(n.options.throwOnError,[l.error]))throw l.error;return{...l,mutate:r,mutateAsync:l.mutate}}}},function(e){e.O(0,[7495,4881,7622,5294,3113,4105,3979,3560,3183,3606,2487,4408,3960,8410,8880,7115,8750,2355,313,6499,2831,3514,6447,4058,7093,604,1744],function(){return e(e.s=77179)}),_N_E=e.O()}]);