(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8767],{5049:function(e,t,n){Promise.resolve().then(n.bind(n,23717))},23717:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Page}});var s=n(52987),a=n(98145),l=n(61387),r=n(2680),i=n(16804),d=n(27022),o=n(77087),u=n(45820),c=n(24113),m=n(55645),v=n(54381),x=n(61650),f=n(53414),p=n(37077),h=n.n(p),g=n(77317),N=n(47259),hooks_useCopy=()=>{let[e,t]=(0,g.useState)(!1);return{copyTextToClipboard:function(e){h()(e),t(!0),setTimeout(()=>t(!1),500),N.A.success("Copied!")},isCopied:e}},j=n(53080),b=n(27092),w=n(13854),C=n(62013),k=n(29293),y=n(95499),S=n(93342),_=n(64329),A=n(86589),I=n(58409),E=n(32125),U=n(26694),O=n(65625),B=n(75577),P=n(24313),D=n(67048),T=n(58123),L=n(87391),M=n(86167);function NumItem(e){let{num:t,tit:n,numClassName:a}=e;return(0,s.jsxs)("div",{className:"animitem flex flex-col p-5 items-center gap-6 rounded-xl border border-primary/60",children:[(0,s.jsx)("div",{className:"text-center text-base",children:n}),(0,s.jsx)("div",{className:(0,w.cn)("text-5xl font-medium text-center",a),children:null!=t?t:"-"})]})}function AethirOpsManager(e){var t,n,a,r,c,x,f,p,h,g,E,D,L,M,F,V,W,Z,R,q,X,$,G,Q,Y,z;let{vc:H,token:J}=e,{copyTextToClipboard:K}=hooks_useCopy(),ee=(0,j.jY)(H),et=(0,b.B8)({key:ee.result?"AethirOpsManagerData: ".concat(H.vault):"",fetfn:async()=>{let e=(0,C.B)(H.chain),t=await e.readContract({abi:U.Hr,functionName:"balanceOf",address:ee.result.NFT,args:[H.vault]}),n=(0,O.V)(["function tokenIdsOfOwnerByAmount(address owner, uint256 index) view returns(uint256[])"]),s=await e.readContract({abi:m.qU,address:H.vault,functionName:"setUserRecordCount"});console.info("setUserCount:",s);let getSetUsers=async()=>{let t=[],n=s/200n;for(let e=0n;e<n;e++)t.push({index:200n*e,count:200n});let a=s%200n;return a>0&&t.push({index:200n*n,count:a}),Promise.all(t.map(t=>{let{index:n,count:s}=t;return e.readContract({abi:m.qU,address:H.vault,functionName:"setUserRecordsInfo",args:[n,s]}).then(e=>{let[t,n,s,a]=e;return t.map((e,t)=>({tokenId:e,owner:n[t],user:s[t],isBanned:a[t]}))})})).then(S.x)},getVaultNft=async()=>e.readContract({abi:n,functionName:"tokenIdsOfOwnerByAmount",address:ee.result.NFT,args:[H.vault,t]}).then(e=>e.map(e=>e.toString())),a=await (0,w.S0)({vaultNft:getVaultNft(),setUsers:getSetUsers(),opsStats:(0,v.bi)(H.chain,J),rewards:(0,v._V)(H.chain,J)}),l={},r=[];for(let e of a.opsStats.burners){for(let t of(e.delegated_nfts||(e.delegated_nfts=[]),e.burner_wallet=e.burner_wallet.startsWith("0x")?e.burner_wallet:"0x".concat(e.burner_wallet),e.delegated_nfts))l[t]=e;r.push(e.burner_wallet)}let i={};for(let e of a.setUsers)i[e.tokenId.toString()]=e;let d=[],o=[],u=[];for(let e of a.vaultNft)l[e]?u.push(e):i[e]&&r.find(t=>(0,B.E)(t,i[e].user))?d.push(e):o.push(e);return{...a,pending:d,error:o,success:u,inSetUsersMap:i,inBunnerNftMap:l}}}),[{detailBuner:en,delegateTo:es,delegateIds:ea,delegateExpire:el,openCofrimOrder:er,filterVaultNftIds:ei},ed]=(0,I.Z)({delegateTo:"",delegateExpire:2n**63n,openCofrimOrder:!1}),eo=null!==(Z=null!=es?es:null===(n=et.result)||void 0===n?void 0:null===(t=n.opsStats.burners[0])||void 0===t?void 0:t.burner_wallet)&&void 0!==Z?Z:"",eu=null!==(R=null!=ea?ea:null===(a=et.result)||void 0===a?void 0:a.error.join(","))&&void 0!==R?R:"",{mutate:ec,isPending:em}=(0,y.D)({mutationFn:async()=>(0,v.E3)(H.chain,J,1),onError:w.S3,onSuccess:()=>{N.A.success("Success!"),ed({openCofrimOrder:!1}),(0,b.iM)(et.key)}}),{data:ev}=(0,T.p)(),{mutate:ex,isPending:ef}=(0,y.D)({mutationFn:async()=>{if(!ev||!eu||!eo||!el)throw Error("Please input!");let e=(null!=eu?eu:"").split(",").map(e=>(0,_.f)(e)).filter(Boolean).map(BigInt),t=e.map(()=>eo);await ev.writeContract({abi:m.qU,address:H.vault,functionName:"batchSetUser",args:[e,t,el]})},onError:w.S3,onSuccess:()=>{N.A.success("Success!"),(0,b.iM)(et.key)}}),ep=null!==(q=null===(r=et.result)||void 0===r?void 0:r.opsStats.burners)&&void 0!==q?q:[],bunerCapacity=e=>{var t,n,s;return(null!==(s=null===(n=et.result)||void 0===n?void 0:null===(t=n.opsStats.deployments.find(t=>t.plan_id==e))||void 0===t?void 0:t.no_of_nodes)&&void 0!==s?s:1)*100},createAt=e=>{var t,n,s;return null!==(s=null===(n=et.result)||void 0===n?void 0:null===(t=n.opsStats.deployments.find(t=>t.plan_id==e))||void 0===t?void 0:t.start_date)&&void 0!==s?s:"-"},eh=(null!==(X=null===(c=et.result)||void 0===c?void 0:c.vaultNft)&&void 0!==X?X:[]).reverse(),eg=null!==($=null===(x=et.result)||void 0===x?void 0:x.inBunnerNftMap)&&void 0!==$?$:{},eN=null!==(G=null===(f=et.result)||void 0===f?void 0:f.inSetUsersMap)&&void 0!==G?G:{},inSetUsers=e=>eN[e]&&ep.find(t=>(0,B.E)(t.burner_wallet,eN[e].user)),ej=(()=>{if(ei)try{let e=ei.trim().split(",").map(e=>e.trim()).filter(Boolean),t={};for(let n of e)t[n]=!0;return t}catch(e){return{}}})(),eb=ej?eh.filter(e=>ej[e]):eh,ew="flex flex-col gap-2 p-5 bg-black/10 dark:bg-white/10 rounded-xl";return(0,b.hg)(et)?(0,s.jsxs)("div",{className:"flex justify-center items-center",children:[" ",(0,s.jsx)(o.$,{})]}):(0,b.VZ)(et)?(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,s.jsx)("div",{children:"Network error!"}),(0,s.jsx)(u.k6,{onClick:()=>(0,b.iM)(et.key),children:"Refresh"})]}):(0,b.d6)(et)?(0,s.jsxs)("div",{className:(0,w.cn)(ew,"gap-5"),children:[(0,s.jsx)("div",{className:" font-semibold text-2xl",children:H.tit}),(0,s.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(240px,1fr))] gap-5",children:[(0,s.jsx)(NumItem,{tit:"Vault Deposited",num:null===(p=et.result)||void 0===p?void 0:p.vaultNft.length,numClassName:""}),(0,s.jsx)(NumItem,{tit:"Delegate Success",num:null===(h=et.result)||void 0===h?void 0:h.success.length,numClassName:"text-green-500"}),(0,s.jsx)(NumItem,{tit:"Delegate Pending",num:null===(g=et.result)||void 0===g?void 0:g.pending.length,numClassName:"text-yellow-500"}),(0,s.jsx)(NumItem,{tit:"Not Delegate",num:null===(E=et.result)||void 0===E?void 0:E.error.length,numClassName:"text-red-500"})]}),(0,s.jsxs)("div",{className:(0,w.cn)(ew,"overflow-x-auto"),children:[(0,s.jsx)("div",{className:"font-semibold text-xl",children:"BurnerList"}),(0,s.jsx)(d.ZP,{header:["Item","Burner Address","Delegated","Remaining","Created","Expires"],data:ep.map((e,t)=>["".concat(t+1),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.lS)(e.burner_wallet)," ",(0,s.jsx)(A.esY,{className:"cursor-pointer",onClick:t=>{K(e.burner_wallet),t.stopPropagation(),t.preventDefault()}})]},"burneraddress"),"".concat(e.delegated_nfts_count),(0,s.jsx)("div",{className:"",children:"".concat(bunerCapacity(e.plan_id)-e.delegated_nfts_count)},"ramining"),createAt(e.plan_id).replaceAll("+0000","").trim(),e.expire_at.replaceAll("+0000","").trim()]),onClickRow:e=>ed({detailBuner:ep[e]})})]}),(0,s.jsxs)(l.Ak,{className:"bg-black/10 dark:bg-white/10 rounded-xl",tit:"Rewards",children:[(0,s.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(300px,1fr))] gap-5",children:[(0,s.jsx)(NumItem,{tit:"Un Claim",num:(0,k.d)((0,P.f)(null!==(Q=null===(D=et.result)||void 0===D?void 0:D.rewards.claimable_ath)&&void 0!==Q?Q:"0")),numClassName:""}),(0,s.jsx)(NumItem,{tit:"Claimed",num:(0,k.d)(null===(L=et.result)||void 0===L?void 0:L.rewards.totalClaimed),numClassName:"text-yellow-500"}),(0,s.jsx)(NumItem,{tit:"Un Withdraw",num:(0,k.d)(null===(M=et.result)||void 0===M?void 0:M.rewards.pendingClaimed),numClassName:"text-red-500"}),(0,s.jsx)(NumItem,{tit:"Withdrawal",num:(0,k.d)(null===(F=et.result)||void 0===F?void 0:F.rewards.withdrawAmount),numClassName:"text-green-500"}),(0,s.jsx)(NumItem,{tit:"Claim Fee",num:5*(null!==(Y=null===(V=et.result)||void 0===V?void 0:V.rewards.claims.length)&&void 0!==Y?Y:0),numClassName:"text-orange-500"})]}),(0,s.jsx)("div",{children:"Un withdraw list:"}),(0,s.jsx)(d.ZP,{header:["OrderID","Amount","Claim At","Can Withdraw At"],data:(null!==(z=null===(W=et.result)||void 0===W?void 0:W.rewards.claims)&&void 0!==z?z:[]).filter(e=>{var t;return!(null===(t=et.result)||void 0===t?void 0:t.rewards.withdrawsOrderIds.includes(e.orderId))}).map((e,t)=>["".concat(e.orderId),(0,k.d)(e.amount),(0,w.G$)(1e3*e.time,w.mv.ALL),(0,w.G$)((e.time+e.cliffSecond)*1e3,w.mv.ALL)])})]}),(0,s.jsxs)(l.Ak,{className:"bg-black/10 dark:bg-white/10 rounded-xl",tit:"Set Delegate (batchSetUser)",children:[(0,s.jsx)("input",{className:(0,w.cn)(l.pk),placeholder:"Burner address",value:eo,onChange:e=>ed({delegateTo:e.target.value})}),(0,s.jsx)("input",{className:(0,w.cn)(l.pk),placeholder:"NftIds(,分割多个)",value:eu,onChange:e=>ed({delegateIds:e.target.value})}),(0,s.jsx)("input",{className:(0,w.cn)(l.pk),placeholder:"ExpireTime",value:el.toString(),onChange:e=>ed({delegateExpire:(0,w.Qt)(e.target.value)})}),(0,s.jsx)(u.k6,{onClick:ex,busy:ef,disabled:ef,children:"Delegate"})]}),(0,s.jsxs)("div",{className:(0,w.cn)(ew,"xl:flex-row items-center gap-6"),children:[(0,s.jsx)(l.UT,{abi:m.qU,functionName:"updateCheckerNode",address:H.vault,infos:()=>(0,C.B)(H.chain).readContract({abi:m.qU,address:H.vault,functionName:"checkerNode"})}),(0,s.jsx)(u.k6,{onDoubleClick:()=>ed({openCofrimOrder:!0}),children:"Order from Nodeops(Double Click)"}),(0,s.jsxs)(i.o,{open:er,className:"p-5",onOpenChange:e=>!e&&ed({openCofrimOrder:!1}),children:[(0,s.jsx)("div",{children:"Comfirm Order"}),(0,s.jsx)("div",{children:"是否确认下单？"}),(0,s.jsx)("div",{className:"pt-8",children:(0,s.jsx)(u.k6,{onClick:ec,busy:em,disabled:em,children:"Confrim"})})]})]}),(0,s.jsxs)("div",{className:(0,w.cn)(ew,"overflow-x-auto"),children:[(0,s.jsx)("div",{className:"font-semibold text-xl",children:"Vault NFT"}),(0,s.jsx)("input",{className:(0,w.cn)(l.pk),placeholder:"FilterNftIds(,分割多个)",value:ei,onChange:e=>ed({filterVaultNftIds:e.target.value})}),(0,s.jsx)("div",{className:"w-full overflow-y-auto max-h-[80vh]",children:(0,s.jsx)(d.ZP,{headerClassName:"sticky top-0 bg-black/60",header:["Lisense ID","Status","isBanned"],data:eb.map(e=>{var t,n;let a=eg[e]?"Sucsess":inSetUsers(e)?"Pending":"Error";return["".concat(e),(0,s.jsx)("div",{className:(0,w.cn)("",{"text-green-500":"Sucsess"==a,"text-yellow-500":"Pending"==a,"text-red-500":"Error"==a}),children:a},"status"),"".concat(null!==(n=null===(t=eN[e])||void 0===t?void 0:t.isBanned)&&void 0!==n&&n)]})})})]}),(0,s.jsxs)(i.o,{open:!!en,className:"p-5",onOpenChange:e=>!e&&ed({detailBuner:void 0}),children:[(0,s.jsx)("div",{children:"Lisense ID"}),en&&(0,s.jsx)("div",{className:"w-full max-w-[600px] grid grid-cols-[repeat(auto-fill,minmax(100px,1fr))] gap-1 p-5 max-h-[60vh] overflow-y-auto",children:en.delegated_nfts.map(e=>(0,s.jsx)("div",{className:"px-2 py-1 rounded bg-primary/10",children:e},e))})]})]}):null}let F=["add","del"];function Page(){let[e,t]=(0,E.Z)("ops-token",""),{signMessageAsync:n}=(0,L.Q)(),{address:i}=(0,M.m)(),d=(0,b.B8)({key:e?"OpsAdmins":"",initResult:[],fetfn:async()=>(0,v.mX)(f.yX.id,e)}),{mutate:o}=(0,y.D)({mutationFn:async()=>{let e=await n({message:"Auth for zoofi ops"}),s=btoa(e);await (0,v.mX)(f.yX.id,s),t(btoa(e))},onError:w.S3}),{mutate:m,isPending:p}=(0,y.D)({mutationFn:async t=>{if(!h||!(0,D.U)(h))throw Error("Params errors");await (0,v.UV)(f.yX.id,e,{type:t,user:h})},onSuccess:()=>(0,b.iM)(d.key),onError:w.S3}),[h,N]=(0,g.useState)(""),[j,C]=(0,g.useState)("add");return(0,s.jsx)(r.E,{className:"flex flex-col gap-5 max-w-6xl",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.Ak,{className:"bg-black/10 dark:bg-white/10 rounded-xl",tit:"Admins",children:[(0,s.jsx)("div",{className:"p-5 rounded bg-primary/10",children:JSON.stringify(d.result,void 0,2)}),(0,s.jsx)("input",{className:(0,w.cn)(l.pk),value:h,onChange:e=>N(e.target.value)}),(0,s.jsx)(c.G,{options:F,onChange:C}),(0,s.jsx)(u.k6,{className:"flex gap-5 items-center justify-center",onClick:()=>m(j),busy:p,disabled:p,children:"Modify Admins"})]}),x.f.filter(e=>e.isAethir&&!e.test).map(t=>(0,s.jsx)(AethirOpsManager,{vc:t,token:e},t.vault))]}):(0,s.jsx)("div",{className:"py-36 px-5",children:i?(0,s.jsx)(u.k6,{onClick:()=>o(),className:"",children:"Login"}):(0,s.jsx)(a.Z,{})})})}},98145:function(e,t,n){"use strict";n.d(t,{Z:function(){return ConnectBtn}});var s=n(52987),a=n(49640),l=n(77317),r=n(44726),i=n(86167),d=n(69245),o=n(77087),u=n(11914),c=n(45820);function ConnectBtn(){(0,r.Z)(1024);let{isConnected:e,chainId:t}=(0,i.m)(),n=(0,a.We)(),{chains:m}=(0,u.UW)(),v=(0,d.o)(),[x,f]=(0,l.useState)(!1),p=(0,l.useSyncExternalStore)(e=>(document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)),()=>"visible"==document.visibilityState);return((0,l.useEffect)(()=>{if(p&&!x)return null==t||m.find(e=>e.id===t)?f(!1):(console.info("needSwitchChainTo:",m[0].id,m.map(e=>e.id)),f(!0),setTimeout(()=>{"visible"===document.visibilityState&&Promise.race([v.switchChainAsync({chainId:m[0].id}),new Promise((e,t)=>setTimeout(()=>t("Timeout"),3e3))]).catch(console.error).finally(()=>f(!1))},300)),()=>{}},[m,t,p]),x)?(0,s.jsx)(o.$,{className:"text-2xl"}):e?(0,s.jsx)(a.NL,{chainStatus:"none",showBalance:!1}):(0,s.jsx)(c.k6,{className:"mt-0 w-fit",onClick:()=>{var e;return null===(e=n.openConnectModal)||void 0===e?void 0:e.call(n)},children:(0,s.jsx)("span",{className:"font-medium text-sm whitespace-nowrap",children:"Connect Wallet"})})}},2680:function(e,t,n){"use strict";n.d(t,{E:function(){return PageWrap}});var s=n(52987),a=n(13854);n(77317);var l=n(78525);function PageWrap(e){let{children:t,className:n}=e;return(0,l.l)(e=>e.theme),(0,s.jsx)("div",{className:(0,a.cn)("h-auto lg:pt-[30px] pb-6",n),children:t})}}},function(e){e.O(0,[2257,9891,4345,6358,8109,5097,9004,1137,8020,6324,6101,3496,742,3606,7366,3254,2516,7834,5424,6339,1387,4195,6338,1744],function(){return e(e.s=5049)}),_N_E=e.O()}]);