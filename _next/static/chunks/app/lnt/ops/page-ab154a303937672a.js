(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8767],{5049:function(e,t,n){Promise.resolve().then(n.bind(n,23717))},23717:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Page}});var s=n(52987),a=n(98145),r=n(61387),l=n(26694),i=n(16804),d=n(27022),o=n(77087),u=n(45820),c=n(24113),m=n(55645),v=n(54381),x=n(61650),p=n(53414),f=n(37077),h=n.n(f),g=n(77317),N=n(47259),hooks_useCopy=()=>{let[e,t]=(0,g.useState)(!1);return{copyTextToClipboard:function(e){h()(e),t(!0),setTimeout(()=>t(!1),500),N.A.success("Copied!")},isCopied:e}},j=n(53080),b=n(27092),w=n(13854),C=n(62013),k=n(29293),y=n(95499),S=n(38462),_=n(93342),I=n(64329),A=n(86589),E=n(58409),U=n(32125),B=n(19219),O=n(65625),P=n(75577),D=n(24313),T=n(67048),L=n(58123),M=n(87391),F=n(86167);function NumItem(e){let{num:t,tit:n,numClassName:a}=e;return(0,s.jsxs)("div",{className:"animitem flex flex-col p-5 items-center gap-6 rounded-xl border border-primary/60",children:[(0,s.jsx)("div",{className:"text-center text-base",children:n}),(0,s.jsx)("div",{className:(0,w.cn)("text-5xl font-medium text-center",a),children:null!=t?t:"-"})]})}function AethirOpsManager(e){var t,n,a,l,c,x,p,f,h,g,U,T,M,F,V,W,Z,R,q,X,$,G,Q,Y,z,H;let{vc:J,token:K}=e,{copyTextToClipboard:ee}=hooks_useCopy(),et=(0,j.jY)(J),en=(0,b.B8)({key:et.result?"AethirOpsManagerData: ".concat(J.vault):"",fetfn:async()=>{let e=(0,C.B)(J.chain),t=await e.readContract({abi:B.Hr,functionName:"balanceOf",address:et.result.NFT,args:[J.vault]}),n=(0,S.w)(parseInt(t.toString())).map(e=>BigInt(e)),s=(0,O.V)(["function tokenOfOwnerByIndex(address owner, uint256 index) public view returns (uint256)"]),a=await e.readContract({abi:m.qU,address:J.vault,functionName:"setUserRecordCount"});console.info("setUserCount:",a);let getSetUsers=async()=>{let t=[],n=a/100n;for(let e=0n;e<n;e++)t.push({index:100n*e,count:100n});let s=a%100n;return s>0&&t.push({index:100n*n,count:s}),Promise.all(t.map(t=>{let{index:n,count:s}=t;return e.readContract({abi:m.qU,address:J.vault,functionName:"setUserRecordsInfo",args:[n,s]}).then(e=>{let[t,n,s,a]=e;return t.map((e,t)=>({tokenId:e,owner:n[t],user:s[t],isBanned:a[t]}))})})).then(_.x)},getVaultNft=async()=>Promise.all(n.map(t=>e.readContract({abi:s,functionName:"tokenOfOwnerByIndex",address:et.result.NFT,args:[J.vault,t]}).then(e=>e.toString()))),r=await (0,w.S0)({vaultNft:getVaultNft(),setUsers:getSetUsers(),opsStats:(0,v.bi)(J.chain,K),rewards:(0,v._V)(J.chain,K)}),l={},i=[];for(let e of r.opsStats.burners){for(let t of(e.delegated_nfts||(e.delegated_nfts=[]),e.burner_wallet=e.burner_wallet.startsWith("0x")?e.burner_wallet:"0x".concat(e.burner_wallet),e.delegated_nfts))l[t]=e;i.push(e.burner_wallet)}let d={};for(let e of r.setUsers)d[e.tokenId.toString()]=e;let o=[],u=[],c=[];for(let e of r.vaultNft)l[e]?c.push(e):d[e]&&i.find(t=>(0,P.E)(t,d[e].user))?o.push(e):u.push(e);return{...r,pending:o,error:u,success:c,inSetUsersMap:d,inBunnerNftMap:l}}}),[{detailBuner:es,delegateTo:ea,delegateIds:er,delegateExpire:el,openCofrimOrder:ei,filterVaultNftIds:ed},eo]=(0,E.Z)({delegateTo:"",delegateExpire:2n**63n,openCofrimOrder:!1}),eu=null!==(R=null!=ea?ea:null===(n=en.result)||void 0===n?void 0:null===(t=n.opsStats.burners[0])||void 0===t?void 0:t.burner_wallet)&&void 0!==R?R:"",ec=null!==(q=null!=er?er:null===(a=en.result)||void 0===a?void 0:a.error.join(","))&&void 0!==q?q:"",{mutate:em,isPending:ev}=(0,y.D)({mutationFn:async()=>(0,v.E3)(J.chain,K,1),onError:w.S3,onSuccess:()=>{N.A.success("Success!"),eo({openCofrimOrder:!1}),(0,b.iM)(en.key)}}),{data:ex}=(0,L.p)(),{mutate:ep,isPending:ef}=(0,y.D)({mutationFn:async()=>{if(!ex||!ec||!eu||!el)throw Error("Please input!");let e=(null!=ec?ec:"").split(",").map(e=>(0,I.f)(e)).filter(Boolean).map(BigInt),t=e.map(()=>eu);await ex.writeContract({abi:m.qU,address:J.vault,functionName:"batchSetUser",args:[e,t,el]})},onError:w.S3,onSuccess:()=>{N.A.success("Success!"),(0,b.iM)(en.key)}}),eh=null!==(X=null===(l=en.result)||void 0===l?void 0:l.opsStats.burners)&&void 0!==X?X:[],bunerCapacity=e=>{var t,n,s;return(null!==(s=null===(n=en.result)||void 0===n?void 0:null===(t=n.opsStats.deployments.find(t=>t.plan_id==e))||void 0===t?void 0:t.no_of_nodes)&&void 0!==s?s:1)*100},createAt=e=>{var t,n,s;return null!==(s=null===(n=en.result)||void 0===n?void 0:null===(t=n.opsStats.deployments.find(t=>t.plan_id==e))||void 0===t?void 0:t.start_date)&&void 0!==s?s:"-"},eg=(null!==($=null===(c=en.result)||void 0===c?void 0:c.vaultNft)&&void 0!==$?$:[]).reverse(),eN=null!==(G=null===(x=en.result)||void 0===x?void 0:x.inBunnerNftMap)&&void 0!==G?G:{},ej=null!==(Q=null===(p=en.result)||void 0===p?void 0:p.inSetUsersMap)&&void 0!==Q?Q:{},inSetUsers=e=>ej[e]&&eh.find(t=>(0,P.E)(t.burner_wallet,ej[e].user)),eb=(()=>{if(ed)try{let e=ed.trim().split(",").map(e=>e.trim()).filter(Boolean),t={};for(let n of e)t[n]=!0;return t}catch(e){return{}}})(),ew=eb?eg.filter(e=>eb[e]):eg,eC="flex flex-col gap-2 p-5 bg-black/10 dark:bg-white/10 rounded-xl";return(0,b.hg)(en)?(0,s.jsxs)("div",{className:"flex justify-center items-center",children:[" ",(0,s.jsx)(o.$,{})]}):(0,b.VZ)(en)?(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,s.jsx)("div",{children:"Network error!"}),(0,s.jsx)(u.k6,{onClick:()=>(0,b.iM)(en.key),children:"Refresh"})]}):(0,b.d6)(en)?(0,s.jsxs)("div",{className:(0,w.cn)(eC,"gap-5"),children:[(0,s.jsx)("div",{className:" font-semibold text-2xl",children:J.tit}),(0,s.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(240px,1fr))] gap-5",children:[(0,s.jsx)(NumItem,{tit:"Vault Deposited",num:null===(f=en.result)||void 0===f?void 0:f.vaultNft.length,numClassName:""}),(0,s.jsx)(NumItem,{tit:"Delegate Success",num:null===(h=en.result)||void 0===h?void 0:h.success.length,numClassName:"text-green-500"}),(0,s.jsx)(NumItem,{tit:"Delegate Pending",num:null===(g=en.result)||void 0===g?void 0:g.pending.length,numClassName:"text-yellow-500"}),(0,s.jsx)(NumItem,{tit:"Not Delegate",num:null===(U=en.result)||void 0===U?void 0:U.error.length,numClassName:"text-red-500"})]}),(0,s.jsxs)("div",{className:(0,w.cn)(eC,"overflow-x-auto"),children:[(0,s.jsx)("div",{className:"font-semibold text-xl",children:"BurnerList"}),(0,s.jsx)(d.ZP,{header:["Item","Burner Address","Delegated","Remaining","Created","Expires"],data:eh.map((e,t)=>["".concat(t+1),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.lS)(e.burner_wallet)," ",(0,s.jsx)(A.esY,{className:"cursor-pointer",onClick:t=>{ee(e.burner_wallet),t.stopPropagation(),t.preventDefault()}})]},"burneraddress"),"".concat(e.delegated_nfts_count),(0,s.jsx)("div",{className:"",children:"".concat(bunerCapacity(e.plan_id)-e.delegated_nfts_count)},"ramining"),createAt(e.plan_id).replaceAll("+0000","").trim(),e.expire_at.replaceAll("+0000","").trim()]),onClickRow:e=>eo({detailBuner:eh[e]})})]}),(0,s.jsxs)(r.Ak,{className:"bg-black/10 dark:bg-white/10 rounded-xl",tit:"Rewards",children:[(0,s.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(300px,1fr))] gap-5",children:[(0,s.jsx)(NumItem,{tit:"Un Claim",num:(0,k.d)((0,D.f)(null!==(Y=null===(T=en.result)||void 0===T?void 0:T.rewards.claimable_ath)&&void 0!==Y?Y:"0")),numClassName:""}),(0,s.jsx)(NumItem,{tit:"Claimed",num:(0,k.d)(null===(M=en.result)||void 0===M?void 0:M.rewards.totalClaimed),numClassName:"text-yellow-500"}),(0,s.jsx)(NumItem,{tit:"Un Withdraw",num:(0,k.d)(null===(F=en.result)||void 0===F?void 0:F.rewards.pendingClaimed),numClassName:"text-red-500"}),(0,s.jsx)(NumItem,{tit:"Withdrawal",num:(0,k.d)(null===(V=en.result)||void 0===V?void 0:V.rewards.withdrawAmount),numClassName:"text-green-500"}),(0,s.jsx)(NumItem,{tit:"Claim Fee",num:5*(null!==(z=null===(W=en.result)||void 0===W?void 0:W.rewards.claims.length)&&void 0!==z?z:0),numClassName:"text-orange-500"})]}),(0,s.jsx)("div",{children:"Un withdraw list:"}),(0,s.jsx)(d.ZP,{header:["OrderID","Amount","Claim At","Can Withdraw At"],data:(null!==(H=null===(Z=en.result)||void 0===Z?void 0:Z.rewards.claims)&&void 0!==H?H:[]).filter(e=>{var t;return!(null===(t=en.result)||void 0===t?void 0:t.rewards.withdrawsOrderIds.includes(e.orderId))}).map((e,t)=>["".concat(e.orderId),(0,k.d)(e.amount),(0,w.G$)(1e3*e.time,w.mv.ALL),(0,w.G$)((e.time+e.cliffSecond)*1e3,w.mv.ALL)])})]}),(0,s.jsxs)(r.Ak,{className:"bg-black/10 dark:bg-white/10 rounded-xl",tit:"Set Delegate (batchSetUser)",children:[(0,s.jsx)("input",{className:(0,w.cn)(r.pk),placeholder:"Burner address",value:eu,onChange:e=>eo({delegateTo:e.target.value})}),(0,s.jsx)("input",{className:(0,w.cn)(r.pk),placeholder:"NftIds(,分割多个)",value:ec,onChange:e=>eo({delegateIds:e.target.value})}),(0,s.jsx)("input",{className:(0,w.cn)(r.pk),placeholder:"ExpireTime",value:el.toString(),onChange:e=>eo({delegateExpire:(0,w.Qt)(e.target.value)})}),(0,s.jsx)(u.k6,{onClick:ep,busy:ef,disabled:ef,children:"Delegate"})]}),(0,s.jsxs)("div",{className:(0,w.cn)(eC,"xl:flex-row items-center gap-6"),children:[(0,s.jsx)(r.UT,{abi:m.qU,functionName:"updateCheckerNode",address:J.vault,infos:()=>(0,C.B)(J.chain).readContract({abi:m.qU,address:J.vault,functionName:"checkerNode"})}),(0,s.jsx)(u.k6,{onDoubleClick:()=>eo({openCofrimOrder:!0}),children:"Order from Nodeops(Double Click)"}),(0,s.jsxs)(i.o,{open:ei,className:"p-5",onOpenChange:e=>!e&&eo({openCofrimOrder:!1}),children:[(0,s.jsx)("div",{children:"Comfirm Order"}),(0,s.jsx)("div",{children:"是否确认下单？"}),(0,s.jsx)("div",{className:"pt-8",children:(0,s.jsx)(u.k6,{onClick:em,busy:ev,disabled:ev,children:"Confrim"})})]})]}),(0,s.jsxs)("div",{className:(0,w.cn)(eC,"overflow-x-auto"),children:[(0,s.jsx)("div",{className:"font-semibold text-xl",children:"Vault NFT"}),(0,s.jsx)("input",{className:(0,w.cn)(r.pk),placeholder:"FilterNftIds(,分割多个)",value:ed,onChange:e=>eo({filterVaultNftIds:e.target.value})}),(0,s.jsx)(d.ZP,{header:["Lisense ID","Status","isBanned"],data:ew.map(e=>{var t,n;let a=eN[e]?"Sucsess":inSetUsers(e)?"Pending":"Error";return["".concat(e),(0,s.jsx)("div",{className:(0,w.cn)("",{"text-green-500":"Sucsess"==a,"text-yellow-500":"Pending"==a,"text-red-500":"Error"==a}),children:a},"status"),"".concat(null!==(n=null===(t=ej[e])||void 0===t?void 0:t.isBanned)&&void 0!==n&&n)]})})]}),(0,s.jsxs)(i.o,{open:!!es,className:"p-5",onOpenChange:e=>!e&&eo({detailBuner:void 0}),children:[(0,s.jsx)("div",{children:"Lisense ID"}),es&&(0,s.jsx)("div",{className:"w-[600px] grid grid-cols-[repeat(auto-fill,minmax(100px,1fr))] gap-1 p-5",children:es.delegated_nfts.map(e=>(0,s.jsx)("div",{className:"px-2 py-1 rounded bg-primary/10",children:e},e))})]})]}):null}let V=["add","del"];function Page(){let[e,t]=(0,U.Z)("ops-token",""),{signMessageAsync:n}=(0,M.Q)(),{address:i}=(0,F.m)(),d=(0,b.B8)({key:e?"OpsAdmins":"",initResult:[],fetfn:async()=>(0,v.mX)(p.yX.id,e)}),{mutate:o}=(0,y.D)({mutationFn:async()=>{let e=await n({message:"Auth for zoofi ops"}),s=btoa(e);await (0,v.mX)(p.yX.id,s),t(btoa(e))},onError:w.S3}),{mutate:m,isPending:f}=(0,y.D)({mutationFn:async t=>{if(!h||!(0,T.U)(h))throw Error("Params errors");await (0,v.UV)(p.yX.id,e,{type:t,user:h})},onSuccess:()=>(0,b.iM)(d.key),onError:w.S3}),[h,N]=(0,g.useState)(""),[j,C]=(0,g.useState)("add");return(0,s.jsx)(l.E,{className:"flex flex-col gap-5 max-w-6xl",children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.Ak,{className:"bg-black/10 dark:bg-white/10 rounded-xl",tit:"Admins",children:[(0,s.jsx)("div",{className:"p-5 rounded bg-primary/10",children:JSON.stringify(d.result,void 0,2)}),(0,s.jsx)("input",{className:(0,w.cn)(r.pk),value:h,onChange:e=>N(e.target.value)}),(0,s.jsx)(c.G,{options:V,onChange:C}),(0,s.jsx)(u.k6,{className:"flex gap-5 items-center justify-center",onClick:()=>m(j),busy:f,disabled:f,children:"Modify Admins"})]}),x.f.filter(e=>e.isAethir&&!e.test).map(t=>(0,s.jsx)(AethirOpsManager,{vc:t,token:e},t.vault))]}):(0,s.jsx)("div",{className:"py-36 px-5",children:i?(0,s.jsx)(u.k6,{onClick:()=>o(),className:"",children:"Login"}):(0,s.jsx)(a.Z,{})})})}},98145:function(e,t,n){"use strict";n.d(t,{Z:function(){return ConnectBtn}});var s=n(52987),a=n(49640),r=n(77317),l=n(44726),i=n(86167),d=n(69245),o=n(77087),u=n(11914),c=n(45820);function ConnectBtn(){(0,l.Z)(1024);let{isConnected:e,chainId:t}=(0,i.m)(),n=(0,a.We)(),{chains:m}=(0,u.UW)(),v=(0,d.o)(),[x,p]=(0,r.useState)(!1),f=(0,r.useSyncExternalStore)(e=>(document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)),()=>"visible"==document.visibilityState);return((0,r.useEffect)(()=>{if(f&&!x)return null==t||m.find(e=>e.id===t)?p(!1):(console.info("needSwitchChainTo:",m[0].id,m.map(e=>e.id)),p(!0),setTimeout(()=>{"visible"===document.visibilityState&&Promise.race([v.switchChainAsync({chainId:m[0].id}),new Promise((e,t)=>setTimeout(()=>t("Timeout"),3e3))]).catch(console.error).finally(()=>p(!1))},300)),()=>{}},[m,t,f]),x)?(0,s.jsx)(o.$,{className:"text-2xl"}):e?(0,s.jsx)(a.NL,{chainStatus:"none",showBalance:!1}):(0,s.jsx)(c.k6,{className:"mt-0 w-fit",onClick:()=>{var e;return null===(e=n.openConnectModal)||void 0===e?void 0:e.call(n)},children:(0,s.jsx)("span",{className:"font-medium text-sm whitespace-nowrap",children:"Connect Wallet"})})}},26694:function(e,t,n){"use strict";n.d(t,{E:function(){return PageWrap}});var s=n(52987),a=n(13854);n(77317);var r=n(78525);function PageWrap(e){let{children:t,className:n}=e;return(0,r.l)(e=>e.theme),(0,s.jsx)("div",{className:(0,a.cn)("h-auto lg:pt-[30px] pb-6",n),children:t})}}},function(e){e.O(0,[2257,9891,4345,6358,8109,5097,9004,1137,6647,6324,5920,6398,3262,3606,7366,2280,2516,7834,5424,6339,1387,4195,6338,1744],function(){return e(e.s=5049)}),_N_E=e.O()}]);