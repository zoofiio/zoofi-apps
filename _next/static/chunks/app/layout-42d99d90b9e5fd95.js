(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{79391:function(){},50413:function(e,t,n){Promise.resolve().then(n.t.bind(n,8367,23)),Promise.resolve().then(n.bind(n,26867)),Promise.resolve().then(n.t.bind(n,51153,23)),Promise.resolve().then(n.t.bind(n,9487,23)),Promise.resolve().then(n.t.bind(n,29180,23)),Promise.resolve().then(n.t.bind(n,62888,23)),Promise.resolve().then(n.t.bind(n,95332,23)),Promise.resolve().then(n.t.bind(n,80265,23))},26867:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return PageLayout}});var l=n(31113),s=n(59175),a=n(26361),o=n(64370),r=n(83978),i=n.n(r),u=n(42487),c=n.n(u),d=n(69708),p=n(64103),f=n(83960),h=n(44945),m=n(14993),v=n(23449),g=n(95702),b=n(93108);let x=(0,b.Ue)((e,t)=>({isLoading:!1,set:t}));function PageLoading(){let{isLoading:e}=x(),t=(0,d.usePathname)();return(0,p.useEffect)(()=>{console.info("pathname change:",t),x.setState({isLoading:!1})},[t]),(0,l.jsx)("div",{className:(0,a.cn)("top-loader fixed z-50 top-0 left-0",e?"visible":"invisible")})}var S=n(6371),B=n(87031),w=n(22818),P=n(66499),y=n(96670),k=n(75847);let isActiveLink=(e,t)=>{let n=!t.disabled&&e===t.href,l=e.split("/").length>t.href.split("/").length&&e.startsWith(t.href)&&(0,r.size)(t.subs)>0;return n||l};function MenusItem(e){var t;let{menu:n,expand:s=!0,depth:o=0}=e,[r,i]=(0,m.Z)(s),u=(0,d.usePathname)(),p=isActiveLink(u,n);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c(),{target:n.target,onClickCapture:()=>{(!n.target||"_self"==n.target)&&n.href.startsWith("/")&&new URL(location.origin+n.href).pathname!==u&&x.setState({isLoading:!0})},href:n.disabled?"javascript:void(0)":n.href,style:{paddingLeft:Math.round((o+1)*16),paddingRight:12},className:(0,a.cn)("relative text-base font-semibold whitespace-nowrap flex w-full items-center gap-3 py-2 rounded-md hover:bg-primary/20",{"cursor-pointer":!n.disabled,"cursor-not-allowed opacity-60":n.disabled,"text-primary":p}),children:[n.icon&&(0,l.jsx)(n.icon,{}),n.disabled?(0,l.jsx)(S.C,{node:n.name,children:"Coming Soon"}):n.name,n.subs&&(0,l.jsx)(f.Tfp,{className:(0,a.cn)("cursor-pointer ml-auto",{"-rotate-90":r}),onClick:e=>{e.stopPropagation(),e.preventDefault(),i()}})]}),r&&(null===(t=n.subs)||void 0===t?void 0:t.map((e,t)=>(0,l.jsx)(MenusItem,{menu:e,expand:!1,depth:o+1},"menusitem_".concat(t,"_").concat(o))))]})}function MenusContent(){let e=function(){let e=(0,s.p)(),{address:t}=(0,y.m)(),{data:n}=(0,o.a)({queryKey:["showAdmin:",e,t],enabled:!!t,initialData:!1,queryFn:async()=>{let n=await Promise.all(i().union(B.Fw[e].map(e=>e.protocolAddress)).map(t=>(0,w.B)(e).readContract({abi:P.RR,address:t,functionName:"protocolOwner"})));return n.findIndex(e=>(0,k.E)(e,t))>=0}});return n}(),t=(0,p.useMemo)(()=>[{href:"/lnt",name:"LNT-Vault",subs:[{href:"/lnt/pre-deposit",name:"Pre-Deposit",icon:h.QZG},{href:"/lnt/vaults",name:"LNT-Vault",icon:h.QZG,demo:!0},{href:"/lnt/portfolio",name:"Portfolio",icon:h.J4,disabled:!0},{href:"/lnt/dashboard",name:"Dashboard",icon:h.FL4,disabled:!0}]},{href:"/b-vaults",name:"B-Vault",subs:[{href:"/b-vaults",name:"B-Vault",icon:h.QZG},{href:"/b-vaults/portfolio",name:"Portfolio",icon:h.J4},{href:"/b-vaults/dashboard",name:"Dashboard",icon:h.FL4},...e?[{href:"/b-vaults/admin",name:"Admin",icon:h.FL4}]:[]]}],[e]);return(0,l.jsx)("div",{className:(0,a.cn)("flex-col gap-2 items-end flex w-full"),children:t.map((e,t)=>(0,l.jsx)(MenusItem,{menu:e},"menusitem_".concat(t)))})}function Menus(){let[e,t]=(0,m.Z)(!1),n=(0,p.useRef)(null),s=(0,p.useRef)(null);(0,v.Z)(n,e=>{let{current:n}=s;n&&!n.contains(e.target)&&t(!1)});let[o,r]=(0,m.Z)(!1);return((0,p.useEffect)(()=>{r(!0)},[]),o)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex fixed z-50 left-0 lg:hidden items-center px-4 h-[72px]",children:[(0,l.jsx)(c(),{href:"/",className:"font-semibold flex pr-1 items-center text-base leading-7",children:(0,l.jsx)(g.cL,{symbol:"logo-alt",size:90})}),(0,l.jsx)("div",{ref:s,children:(0,l.jsx)(h.bqP,{className:"text-3xl cursor-pointer",onClick:()=>t(!e)})})]}),(0,l.jsxs)("div",{ref:n,className:(0,a.cn)("hidden h-screen lg:flex flex-col gap-8 items-center sticky top-0 w-[15rem] overflow-y-auto transition-all"),children:[(0,l.jsx)("div",{className:"flex items-center justify-center gap-5 px-4 h-[72px]",children:(0,l.jsx)(c(),{href:"/",className:"font-semibold flex pr-1 items-center text-base leading-7",children:(0,l.jsx)(g.cL,{symbol:"logo-alt",size:90})})}),(0,l.jsx)(MenusContent,{})]}),(0,l.jsx)("div",{ref:n,className:(0,a.cn)("fixed z-50 flex lg:hidden flex-col gap-8 items-center top-[72px] w-[15rem] overflow-y-auto max-h-[calc(100vh-72px)] transition-all -left-full  bg-[#eeeeee] dark:bg-l1 shadow-lg",{"left-0":e}),children:(0,l.jsx)(MenusContent,{})})]}):null}var V=n(44769),j=n(47259),T=n(73216),A=n(3178),C=n(88058),L=n(95657),N=n(79756),E=n(56980),U=n(97370),_=n(57148),M=n(72009),D=n(1589),I=n(29744),q=n(24103),R=n(71822),Y=n(8887),F=n(45066),O=n(11522),z=n(45248),Z=n(99946),H=n(12045),J=n(51178),K=n(85895),Q=n(8912),$=n(7915),W=n(32417),G=n(83037),X=n(26276),ee=n(9793),et=n(45138);BigInt.prototype.toJSON=function(){return this.toString()};let en=new K.f({uri:"https://api.studio.thegraph.com/query/45897/wand/version/latest",cache:new Q.h}),el=new W.S({defaultOptions:{queries:{retry:3}}});function Providers(e){let{children:t,supportChains:n=T.Af}=e,[s,a]=p.useState();p.useEffect(()=>{let e=(0,Y.o)({storage:{getItem:e=>window.localStorage.getItem(e),removeItem:e=>window.localStorage.removeItem(e),setItem:(e,t)=>{"wagmi.cache"!==e&&localStorage.setItem(e,t)}}}),t=(0,A.a3)([{groupName:"Recommended",wallets:[N.U,E.P,U.D,_.b,M.c,D.X,I.J,q.b,R.D]}],{appName:"ZooFi",projectId:"abf1f323cd9ff9f6a27167188d993168"});a((0,F._)({connectors:t,storage:e,chains:n,client:e=>{let{chain:t}=e;return(0,X.e)({chain:t,transport:(0,ee.d)(void 0,{batch:T.Xp}),batch:{multicall:T.y1}})}}))},[]);let o=(0,H.l)(e=>e.theme);return s?(0,l.jsx)($.e,{client:en,children:(0,l.jsx)(O.F,{config:s,children:(0,l.jsx)(et.Wg,{chains:n,children:(0,l.jsx)(G.aH,{client:el,children:(0,l.jsx)(Z.QueryParamProvider,{adapter:z.Z,children:(0,l.jsx)(A.pj,{locale:"en-US",modalSize:"compact",theme:"dark"===o?(0,C.$)({accentColor:"green"}):(0,L.W)(),children:(0,l.jsx)(J.A,{children:t})})})})})})}):null}function PageLayout(e){let{children:t}=e;return(0,V.Vi)(),(0,l.jsxs)(Providers,{children:[(0,l.jsx)("div",{className:"w-screen h-screen overflow-auto flex justify-center relative bg-[#eeeeee] dark:bg-l1",children:(0,l.jsxs)("div",{className:"flex justify-center w-full max-w-[1400px] h-max relative",children:[(0,l.jsx)(Menus,{}),(0,l.jsx)("div",{className:"flex-1 relative h-max w-full",children:t})]})}),(0,l.jsx)(j.x,{position:"top-right",offset:70}),(0,l.jsx)(PageLoading,{})]})}BigInt.prototype.toJSON=function(){return this.toString()}},6371:function(e,t,n){"use strict";n.d(t,{C:function(){return Tip}});var l=n(31113),s=n(26361),a=n(43099),o=n(55966);function Tip(e){let{children:t,node:n,className:r,inFlex:i}=e,u=document.getElementById("tooltip-root");return t?(0,l.jsx)(a.zt,{children:(0,l.jsxs)(a.fC,{children:[(0,l.jsx)(a.xz,{asChild:!0,onClickCapture:e=>{e.preventDefault(),e.stopPropagation()},children:n?(0,l.jsx)("div",{className:(0,s.cn)("inline-block cursor-default",r),style:{verticalAlign:"text-bottom"},children:n}):(0,l.jsx)("div",{className:(0,s.cn)(i?"flex":"translate-y-[-6%] inline-block"," px-[3px] cursor-default relative",r),children:(0,l.jsx)(o.apP,{className:"inline-block stroke-slate-500"})})}),(0,l.jsx)(a.h_,{container:u,children:(0,l.jsxs)(a.VY,{className:"max-w-xs text-sm text-white bg-slate-900 shadow-lg dark:bg-[#333333] rounded-md p-4",children:[t,(0,l.jsx)(a.Eh,{})]})})]})}):n}},88439:function(e,t,n){"use strict";n.d(t,{b:function(){return useMemoOfChainId}});var l=n(64103),s=n(59175);function useMemoOfChainId(e){let t=(0,s.p)(),n=(0,l.useRef)({});return(0,l.useMemo)(()=>(n.current[t]||(n.current[t]=e()),n.current[t]),[t])}},51178:function(e,t,n){"use strict";n.d(t,{g:function(){return B},A:function(){return FetcherProvider}});var l=n(31113),s=n(19757),a=n(22139),o=n(59175),r=n(64103),i=n(25233),u=n(87958),c=n(41340),d=n(73216),p=n(88439),f=n(55349),h=n(33737),m=n(93108);let v=(0,m.Ue)(e=>({update:e}));var g=n(26361),b=n(64370),x=n(18358),S=n(39577);let B=(0,r.createContext)({prices:(0,g.Yb)({},0n),usbApr:{apr:0n,aprDecimals:10}}),FetcherProvider=e=>{let{children:t}=e;(0,x.d6)();let n=(0,o.p)();!function(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.m)({chainId:e});r.useMemo(()=>(t&&(d.ON.provider=function(e){var t,n;let{chain:l,transport:s}=e,a={chainId:l.id,name:l.name,ensAddress:null===(n=l.contracts)||void 0===n?void 0:null===(t=n.ensRegistry)||void 0===t?void 0:t.address};return"fallback"===s.type?new u.H(s.transports.map(e=>{let{value:t}=e;return new c.r(null==t?void 0:t.url,a)})):new c.r(s.url,a)}(t)),d.ON.provider),[t])}();let m=(0,p.b)(()=>(0,g.Yb)({[s.O1[n]]:a.Pq},0n));(0,S.$$)(m);let w=(0,S.UM)();return!function(e){let t=(0,o.p)(),n=s.iK[t]||[],l=(0,f.o)(e=>e.sliceLVaultsStore.lvaults,["sliceLVaultsStore.lvaults"]);(0,r.useEffect)(()=>{console.info("updatePtypoolApy"),null==n||n.forEach(n=>{let o=l[n.vault];if(n.ptyPoolAboveAddress&&o&&o.sellPoolTotalStaking&&v.getState().update({[n.ptyPoolAboveAddress]:{staking:(0,h.v)("0.025",10),matching:0n}}),n.ptyPoolBelowAddress&&o&&o.buyPoolTotalStaking&&!o.isStable){let l=o&&o.sellPoolTotalStaking*e[s.O1[t]],r=l>0n&&o.settingsDecimals>0n?o.M_ETHx*o.Y*e[n.xTokenAddress]*a.Pq/2n/l/o.settingsDecimals**10n:0n;v.getState().update({[n.ptyPoolBelowAddress]:{staking:r*10n**10n/a.Pq,matching:0n}})}})},[n,l,e,t])}(m),(0,b.a)({queryKey:["updateDefTokenList",n],staleTime:36e5,queryFn:async()=>(await f.w.getState().sliceTokenStore.updateDefTokenList(n),!0)}),(0,l.jsx)(B.Provider,{value:{prices:m,usbApr:w},children:t})}},18358:function(e,t,n){"use strict";n.d(t,{Pd:function(){return calcLPPrice},R3:function(){return useUpBVaultForUserAction},Vw:function(){return useEpochesData},Zd:function(){return useBVaultEpoches},d6:function(){return useResetBVaultsData},gz:function(){return useCalcClaimable},lL:function(){return calcBVaultPTApy},nr:function(){return useBVault},oU:function(){return useBVaultApy},v7:function(){return useBVaultBoost}});var l=n(22139),s=n(59175),a=n(26361),o=n(84944),r=n(83978),i=n.n(r),u=n(64103),c=n(96670),d=n(55349),p=n(44020);function useResetBVaultsData(){let e=(0,s.p)(),{address:t}=(0,c.m)();(0,u.useEffect)(()=>{},[e]),(0,u.useEffect)(()=>{d.w.getState().sliceUserBVaults.reset()},[t])}function useBVault(e){return(0,d.o)(t=>t.sliceBVaultsStore.bvaults[e]||(0,a.Yb)({current:(0,a.Yb)({},0n)},0n),["sliceBVaultsStore.bvaults.".concat(e)])}function useBVaultEpoches(e){return(0,d.o)(t=>{let n=t.sliceBVaultsStore.bvaults[e];if(!n||n.epochCount<=0n)return[];let l=i().range(1,parseInt((n.epochCount+1n).toString())).reverse(),s=t.sliceBVaultsStore.epoches;return l.map(t=>s["".concat(e,"_").concat(t)]).filter(e=>null!=e)},["sliceBVaultsStore.bvaults.".concat(e),"sliceBVaultsStore.epoches"])}function useEpochesData(e){let t=useBVaultEpoches(e),n=(0,d.o)(t=>t.sliceUserBVaults.epoches[e]||[],["sliceUserBVaults.epoches.".concat(e)]);return(0,u.useMemo)(()=>{let e=n.reduce((e,t)=>({...e,[t.epochId.toString()]:t}),{});return t.map(t=>(0,a.Yb)({...t,...e[t.epochId.toString()]||{bribes:[],sBribes:[],aBribes:[]}},0n))},[t,n])}function useCalcClaimable(e){let t=useEpochesData(e),n=useBVault(e);return(0,u.useMemo)(()=>{let e=t.filter(e=>e.claimableAssetBalance>10n&&(e.settled||n.closed));return{ids:e.map(e=>e.epochId),claimable:e.reduce((e,t)=>e+t.claimableAssetBalance,0n)}},[t,n.closed])}function useBVaultBoost(e){let t=(0,d.o)(()=>(function(e){let t=d.w.getState(),n=t.sliceBVaultsStore.bvaults[e],s=(null==n?void 0:n.current.vaultYTokenBalance)||0n,a=(null==n?void 0:n.Y)||0n,r=a>0n?s*l.Pq/a:0n,i=(null==n?void 0:n.current.yTokenAmountForSwapYT)||0n,u=(null==n?void 0:n.lockedAssetTotal)||0n,c=i>0n?u*l.Pq/i:0n;return console.info("calcBootst:",(0,o.d)(r),(0,o.d)(c)),r})(e),["sliceBVaultsStore.bvaults.".concat(e)]);return[(0,o.d)(t,0),t]}function calcBVaultPTApy(e){let t=d.w.getState(),n=t.sliceBVaultsStore.bvaults[e.vault],s=function(e){let t=d.w.getState(),n=t.sliceBVaultsStore.bvaults[e.vault],l=(0,a.ok)(t.sliceBVaultsStore.yTokenSythetic,[e.vault]);return 0n==l&&(l=(0,a.ok)(t.sliceTokenStore.totalSupply,e.pToken)*((null==n?void 0:n.current.duration)||0n)),l}(e),o=0n;return o=e.pTokenV2?n&&n.ptRebaseRate&&n.pTokenTotal?n.ptRebaseRate/l.Pq*l.SH*BigInt(1e10)/n.pTokenTotal/l.Pq:0n:n&&n.current.assetTotalSwapAmount&&s?n.current.assetTotalSwapAmount*l.SH*BigInt(1e10)/s:0n,console.info("apy:",e.vault,o,e.pTokenV2,null==n?void 0:n.ptRebaseRate,null==n?void 0:n.pTokenTotal,s),o}function useBVaultApy(e){let t=(0,d.o)(()=>calcBVaultPTApy(e),["sliceBVaultsStore.bvaults.".concat(e.vault),"sliceBVaultsStore.yTokenSythetic.".concat(e.vault)]);return[(0,a.Jh)(t,10),t]}function useUpBVaultForUserAction(e,t){let{address:n}=(0,c.m)(),l=(0,s.p)();return()=>{(0,a.XD)(async()=>{if(null==t||t(),!n)return;await Promise.all([d.w.getState().sliceTokenStore.updateTokensBalance(l,[e.asset,e.pToken],n),d.w.getState().sliceTokenStore.updateTokenTotalSupply(l,[e.asset,e.pToken]),d.w.getState().sliceBVaultsStore.updateBvaults(l,[e]),d.w.getState().sliceBVaultsStore.updateYTokenSythetic(l,[e])]);let s=d.w.getState().sliceBVaultsStore.bvaults[e.vault];await d.w.getState().sliceBVaultsStore.updateEpoches(l,e,s.epochCount>1n?[s.epochCount,s.epochCount-1n]:[s.epochCount]);let a=[];for(let t=parseInt(s.epochCount.toString());t>0;t--){let n=d.w.getState().sliceBVaultsStore.epoches["".concat(e.vault,"_").concat(t)];a.push(n)}console.info("onUserAction:epoches",a),await d.w.getState().sliceUserBVaults.updateEpoches(l,e,n,a)},3,1e3)}}function calcLPPrice(e,t){let n=p.P[t];if(!n)return 0n;let l=d.w.getState().sliceBVaultsStore.bvaults[e];if(!l)return 0n;let s=d.w.getState().sliceTokenStore.prices,o=l.lpBase*(0,a.ok)(s,n.base,0n)+l.lpQuote*(0,a.ok)(s,n.quote);return l.lpLiq>0n?o/l.lpLiq:0n}},39577:function(e,t,n){"use strict";n.d(t,{$$:function(){return useSetLVaultPrices},UM:function(){return useUSBApr}});var l=n(19757),s=n(22139),a=n(59175);n(88439);var o=n(26361),r=n(55349);let i=(0,o.Yb)({vaultMode:0,discountEnable:!1},0n);function useSetLVaultPrices(e){var t;let n=(0,r.o)(e=>e.sliceLVaultsStore.lvaults),o=(0,r.o)(e=>e.sliceTokenStore.totalSupply),u=(0,a.p)();null===(t=l.iK[u])||void 0===t||t.forEach(t=>{let a=n[t.vault]||i,r=a.assetBalance,c=a.latestPrice,d=a.usbTotalSupply,p=o[t.xTokenAddress]||0n,f=p>0n&&r>0n&&c>0n&&d>0n&&r*c>d*s.Pq?(r*c-d*s.Pq)/p:0n;e[t.xTokenAddress]=f,e[t.assetTokenAddress]=c,p>0n&&r>0n&&c>0n&&d>0n&&r*c<d*s.Pq&&(e[l.O1[u]]=r*c/d)})}function useUSBApr(){var e;let t=(0,a.p)(),n=(0,r.o)(e=>e.sliceLVaultsStore.lvaults),s=0,o=0n,u=0n;return null===(e=l.iK[t])||void 0===e||e.forEach(e=>{let t=n[e.vault]||i;t.isStable?(o+=t.M_USB_USDC*t.Y*t.aar/10n**t.AARDecimals,u+=t.M_USB_USDC,t.M_USB_USDC>0n&&t.Y>0n&&s++):(o+=t.M_USB_ETH*t.Y,u+=t.M_USB_ETH,t.M_USB_ETH>0n&&t.Y>0n&&s++)}),{apr:u>0n?o/u:0n,aprDecimals:10}}(0,o.Yb)({},0n)},8367:function(){}},function(e){e.O(0,[4881,7495,7622,3113,6377,6121,3270,3606,2996,2487,8410,5201,7948,3204,3028,313,6499,9674,7093,604,1744],function(){return e(e.s=50413)}),_N_E=e.O()}]);