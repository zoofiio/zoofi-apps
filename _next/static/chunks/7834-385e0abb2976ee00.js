"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7834],{57834:function(e,t,n){n.d(t,{vZ:function(){return ApproveAndTx},Lc:function(){return NftApproveAndTx},$M:function(){return Txs},g7:function(){return TxsStat},Rb:function(){return withTokenApprove}});var a=n(52987),r=n(13854),c=n(62013),s=n(83978),o=n.n(s),i=n(77317),l=n(47259),u=n(85058),d=n(42302),p=n(41331),f=n(99409),h=n(7347);let m={},useApproves=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10000000000n*10n**18n,{address:a}=(0,d.m)(),s=(0,f.pK)(),{data:o}=(0,p.p)(),[w,x]=(0,i.useState)(!1),b=(0,i.useMemo)(()=>Object.keys(e).filter(e=>!(0,h.Mg)(e)),[e]),[v,g]=(0,i.useState)(t&&m[t]||{}),updateAllownce=(e,n)=>{t&&(m[t]={...m[t]||{},[e]:n},g(t=>({...t,[e]:n})))};(0,i.useEffect)(()=>{a&&t&&s&&b.forEach(e=>{(0,c.B)(s).readContract({abi:u.Wo,address:e,functionName:"allowance",args:[a,t]}).then(t=>updateAllownce(e,t||0n)).catch(console.error)})},[b,s,a]);let[y,A]=(0,i.useState)(!1),k=(0,i.useMemo)(()=>b.filter(t=>(0,r.ok)(e,t)>0n&&(0,r.ok)(e,t)>(0,r.ok)(v,t)),[e,b,v]),approve=async()=>{if(0!=k.length&&t&&a)try{A(!0),x(!1);for(let r=0;r<k.length;r++){let i=k[r],d=!1===n?e[i]:n,p=await (null==o?void 0:o.writeContract({abi:u.Wo,address:i,functionName:"approve",args:[t,d]}));p&&await (0,c.B)(s).waitForTransactionReceipt({hash:p});let f=await (0,c.B)(s).readContract({abi:u.Wo,address:i,functionName:"allowance",args:[a,t]});f<e[i]&&l.A.error("Insufficient amount of approve"),updateAllownce(i,f)}l.A.success("Approve success"),A(!1),x(!0)}catch(e){l.A.error((0,r.az)(e)),A(!1),x(!1)}};return{approve,loading:y,shouldApprove:k.length>0,isSuccess:w}},w={},useNftApproves=(e,t)=>{let{address:n}=(0,d.m)(),a=(0,f.pK)(),{data:s}=(0,p.p)(),[h,m]=(0,i.useState)(!1),x=o().keys(e),[b,v]=(0,i.useState)(t&&w[t]||{}),updateAllownce=(e,n)=>{t&&(w[t]={...w[t]||{},[e]:n},v(t=>({...t,[e]:n})))};(0,i.useEffect)(()=>{n&&t&&a&&x.forEach(e=>{(0,c.B)(a).readContract({abi:u.Hr,address:e,functionName:"isApprovedForAll",args:[n,t]}).then(t=>t!==b[e]&&updateAllownce(e,t)).catch(console.error)})},[x,a,n]);let[g,y]=(0,i.useState)(!1),A=(0,i.useMemo)(()=>x.filter(e=>!b[e]),[e,x,b]),approve=async()=>{if(0!=A.length&&t)try{y(!0),m(!1);for(let e=0;e<A.length;e++){let n=A[e],r=await (null==s?void 0:s.writeContract({abi:u.Hr,address:n,functionName:"setApprovalForAll",args:[t,!0]}));r&&await (0,c.B)(a).waitForTransactionReceipt({hash:r}),updateAllownce(n,!0)}l.A.success("Approve success"),y(!1),m(!0)}catch(e){l.A.error((0,r.az)(e)),y(!1),m(!1)}};return{approve,loading:g,shouldApprove:A.length>0,isSuccess:h}};function useWrapContractWrite(e,t){let{autoToast:n=!0,onSuccess:a}=t||{},[s,o]=(0,i.useState)(!1),[u,d]=(0,i.useState)(!1),{data:h}=(0,p.p)(),m=(0,f.pK)(),w=!h||!h.account||s||!e||h.chain.id!==m,write=async()=>{if(!w){o(!0),d(!1);try{let r="function"==typeof e?await e():e,s=(0,c.B)(m),o={account:h.account,...r};if(!(null==t?void 0:t.skipSimulate)){let e=await s.simulateContract(o);o=e.request}let i=await h.writeContract(o),u=await s.waitForTransactionReceipt({hash:i,confirmations:null==t?void 0:t.confirmations});if("success"!==u.status)throw"Transaction reverted";d(!0),a&&a(u),n&&l.A.success("Transaction success")}catch(e){n&&l.A.error((0,r.az)(e))}o(!1)}};return{write,isDisabled:w,isLoading:s,isSuccess:u}}var x=n(88501),b=n(34113),v=n(82790),g=n(95499),y=n(68654),A=n(45820),k=n(93108),N=n(16804),S=n(5807);function SwitchNet(e){let{className:t}=e,n=(0,y.o)(),r=(0,f.pK)();return(0,a.jsx)(A.k6,{className:(0,x.m)("flex items-center justify-center gap-4 whitespace-nowrap w-fit min-w-[200px]",t),onClick:()=>n.switchChainAsync({chainId:r}).catch(console.error),busy:n.isPending,disabled:n.isPending,children:"Switch Network"})}function ApproveAndTx(e){let{className:t,tx:n,busyShowTxet:r=!0,approves:c,spender:s,requestAmount:o,config:l,toast:u=!0,skipSimulate:d=!1,disabled:p,confirmations:h,onTxSuccess:m,onApproveSuccess:w}=e,{write:b,isDisabled:v,isLoading:g}=useWrapContractWrite(l,{onSuccess:e=>m&&m(e),autoToast:u,skipSimulate:d,confirmations:h}),y=p||v||g||!1===l.enabled,{approve:k,shouldApprove:N,loading:S,isSuccess:C}=useApproves(c||{},s,o),j=(0,i.useRef)();j.current=w,(0,i.useEffect)(()=>{j.current&&C&&j.current()},[C]);let T=(0,f.tx)();return T?(0,a.jsx)(SwitchNet,{className:t}):N?(0,a.jsx)(A.k6,{className:(0,x.m)("flex items-center justify-center gap-4",t),onClick:k,busy:S,disabled:p||!k||S,children:"Approve"}):(0,a.jsx)(A.k6,{className:(0,x.m)("flex items-center justify-center gap-4",t),onClick:()=>b(),busy:g,busyShowContent:r,disabled:y,children:n})}function NftApproveAndTx(e){let{className:t,tx:n,busyShowTxet:r=!0,approves:c,spender:s,requestAmount:o,config:l,toast:u=!0,skipSimulate:d=!1,disabled:p,confirmations:h,onTxSuccess:m,onApproveSuccess:w}=e,{write:b,isDisabled:v,isLoading:g}=useWrapContractWrite(l,{onSuccess:e=>m&&m(e),autoToast:u,skipSimulate:d,confirmations:h}),y=p||v||g||!1===l.enabled,{approve:k,shouldApprove:N,loading:S,isSuccess:C}=useNftApproves(null!=c?c:{},s),j=(0,i.useRef)();j.current=w,(0,i.useEffect)(()=>{j.current&&C&&j.current()},[C]);let T=(0,f.tx)();return T?(0,a.jsx)(SwitchNet,{className:t}):N?(0,a.jsx)(A.k6,{className:(0,x.m)("flex items-center justify-center gap-4",t),onClick:k,busy:S,disabled:p||!k||S,children:"Approve"}):(0,a.jsx)(A.k6,{className:(0,x.m)("flex items-center justify-center gap-4",t),onClick:()=>b(),busy:g,busyShowContent:r,disabled:y,children:n})}let C=(0,k.Ue)(()=>({txs:[],progress:0}));function Txs(e){let{className:t,tx:n,txs:s,disabled:o,disableSendCalls:i=!0,disableProgress:u,busyShowTxet:d=!0,toast:h=!0,onTxSuccess:m}=e,{data:w}=(0,p.p)(),v=(0,f.tx)(),y=(0,f.pK)(),{mutate:k,isPending:N}=(0,g.D)({mutationFn:async()=>{if(!w)return;let e=(0,c.B)(y),t=await (0,r.IE)(s).then(e=>Promise.all(e.map(r.IE)));console.info("calls:",w.account.address,t);try{if(i)throw Error("disable wallet_sendCalls");if(1==t.length)throw Error("calls length one wallet_sendCalls");let{id:e}=await w.sendCalls({account:w.account.address,calls:t.map(e=>({data:(0,b.R)({abi:e.abi,functionName:e.functionName,args:e.args}),to:e.address}))});for(;;){let t=await w.waitForCallsStatus({id:e});if("pending"!=t.status){if("success"==t.status)h&&l.A.success("Transactions Success"),null==m||m();else throw Error("Transactions ".concat(t.status," ").concat(JSON.stringify(t)));break}}}catch(c){let n=(0,r.az)(c),a=!u&&t.length>1;if(n&&(n.includes("wallet_sendCalls")||n.includes("EIP-7702 not supported"))){let n=0;for(let r of(a&&C.setState({txs:t,progress:n}),t)){let t=await w.writeContract(r),c=await e.waitForTransactionReceipt({hash:t,confirmations:1});if("success"!==c.status)throw Error("Transactions Reverted");n++,a&&C.setState({progress:n})}h&&l.A.success("Transactions Success"),C.setState({progress:0,txs:[]}),null==m||m()}}},onError:e=>{C.setState({progress:0,txs:[]}),h&&(0,r.S3)(e)}}),S=o||N||"function"!=typeof s&&0==s.length||!w;return v?(0,a.jsx)(SwitchNet,{className:t}):(0,a.jsx)(A.k6,{className:(0,x.m)("flex items-center justify-center gap-4",t),onClick:()=>k(),busy:N,busyShowContent:d,disabled:S,children:n})}async function withTokenApprove(e){let{approves:t,pc:n,user:a,tx:r}=e,c=0n,s=await Promise.all(t.map(async e=>{var t;if(v.DR===e.token)return c+=e.amount,null;let r=await n.readContract({abi:u.Wo,address:e.token,functionName:"allowance",args:[a,e.spender]});if(r>=e.amount)return null;let s=null!==(t=e.name)&&void 0!==t?t:"Approve ".concat((0,h.kb)(e.token,await n.getChainId()).symbol);return{name:s,abi:u.Wo,address:e.token,functionName:"approve",args:[e.spender,e.amount-r]}})).then(e=>e.filter(e=>null!==e));return[...s,{...r,...c>0n?{value:c}:{}}]}function TxsStat(e){let{className:t}=e,{txs:n,progress:c}=C();return 0==n.length?null:(0,a.jsxs)(N.o,{open:!0,disableClose:!0,className:(0,r.cn)("w-80 text-black dark:text-white flex flex-col gap-2 p-4",t),children:[(0,a.jsx)("div",{className:"text-xl font-semibold",children:"Progress"}),n.map((e,t)=>{var n;return(0,a.jsxs)("div",{className:"animitem flex items-center gap-5 bg-primary/20 rounded-lg px-4 py-2",children:[(0,a.jsx)("span",{className:"font-semibold",children:t+1}),null!==(n=e.name)&&void 0!==n?n:e.functionName,(0,a.jsxs)("div",{className:(0,r.cn)("ml-auto text-xl",{"animate-spin":c==t}),children:[c==t&&(0,a.jsx)(S.fCD,{}),c>t&&(0,a.jsx)(S.l_A,{className:"text-green-500"})]})]},"tx_item_stat_".concat(t))})]})}},77087:function(e,t,n){n.d(t,{$:function(){return Spinner}});var a=n(52987),r=n(13854);let Spinner=e=>{let{className:t}=e;return(0,a.jsxs)("svg",{fill:"none",className:(0,r.cn)("animate-spin h-5 w-5 2-ml-1 2mr-3",t),viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},45820:function(e,t,n){n.d(t,{HY:function(){return Swap},k6:function(){return BBtn}});var a=n(52987),r=n(13854),c=n(83978),s=n.n(c),o=n(77317),i=n(77087),l=n(63114);function BBtn(e){let{borderWidth:t=1,children:n,busy:c,busyShowContent:l=!0,className:u,hiddenBorder:d,...p}=e,f=(0,o.useRef)(null),[h,m]=(0,o.useState)("0_0"),w="unset",x="unset";if(f.current&&!d){let e=f.current,n=e.clientWidth,a=e.clientHeight,r=parseInt(getComputedStyle(e).borderRadius.replace("px","")),c="A".concat(r-t," ").concat(r-t," 0, 0, 1, ").concat(r," ").concat(t,"L").concat(n-r," ").concat(t),o="A".concat(r-t," ").concat(r-t," 0, 0, 1, ").concat(n-t," ").concat(r,"L").concat(n-t," ").concat(a-r),i="A".concat(r-t," ").concat(r-t," 0, 0, 1, ").concat(n-r," ").concat(a-t,"L").concat(r," ").concat(a-t," "),l="A".concat(r-t," ").concat(r-t," 0, 0, 1, ").concat(t," ").concat(a-r,"L").concat(t," ").concat(r),u="M ".concat(t," ").concat(r," ").concat(c," ").concat(o," ").concat(i," ").concat(l),d="M 0 0 L 0 ".concat(a," L ").concat(n," ").concat(a," L ").concat(n," 0 L 0 0 ").concat(u," Z");w="path('".concat(d,"')");let p=2*n,tranP=e=>s().round(e/2,2);x="radial-gradient(122.5% ".concat(s().round(122.5/(n/a),2),"% at ").concat(s().round((52.9*n+50*p-50*n)/p,2),"% ").concat(s().round((16.25*a+50*p-50*a)/p,2),"%, #15d264 0%, #2cbd35 ").concat(tranP(36.26),"%, #dcf45d ").concat(tranP(92.54),"%)")}return(0,o.useEffect)(()=>{let e=new ResizeObserver(()=>{var e,t;m("".concat((null===(e=f.current)||void 0===e?void 0:e.clientWidth)||0,"_").concat((null===(t=f.current)||void 0===t?void 0:t.clientWidth)||0))});return f.current&&e.observe(f.current),()=>{f.current&&e.unobserve(f.current)}},[f.current]),(0,a.jsxs)("button",{...p,ref:f,className:(0,r.cn)("group/bbtn relative px-3 cursor-pointer w-full transition-all leading-[2.375] ring-0 text-base text-black dark:text-white font-medium h-10 rounded-lg disabled:opacity-60 disabled:cursor-not-allowed bg-btn  dark:bg-btndark",{"hover:bg-btnhover dark:hover:bg-btndarkhover":!e.disabled},u),children:[!d&&(0,a.jsx)("div",{className:"absolute w-full h-full left-0 top-0 flex justify-center items-center rounded-lg overflow-hidden",style:{visibility:f.current?"visible":"hidden",clipPath:w},children:(0,a.jsx)("div",{className:(0,r.cn)("w-[200%] aspect-square shrink-0",{"dark:group-hover/bbtn:opacity-60":!e.disabled}),style:{background:x}})}),c&&(0,a.jsx)(i.$,{}),(l||!c)&&n]})}function Swap(e){let{className:t,style:n,...c}=e;return(0,a.jsx)("div",{...c,style:{transform:"rotateX(180deg) rotateZ(90deg)",...n||{}},className:(0,r.cn)("flex w-8 h-8 justify-center items-center self-center text-sm cursor-pointer border border-slate-500 text-slate-500 rounded-full hover:text-primary hover:border-primary",t),children:(0,a.jsx)(l.t4O,{})})}}}]);