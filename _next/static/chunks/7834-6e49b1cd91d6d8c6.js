"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7834],{57834:function(e,t,n){n.d(t,{vZ:function(){return ApproveAndTx},Lc:function(){return NftApproveAndTx},$M:function(){return Txs},g7:function(){return TxsStat},Rb:function(){return withTokenApprove}});var a=n(52987),r=n(7347),c=n(13854),s=n(62013),o=n(61469),i=n(77317),l=n(47259),u=n(85058),d=n(42302),p=n(41331),f=n(99409);let h={},useApproves=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10000000000n*10n**18n,{address:a}=(0,d.m)(),o=(0,f.pK)(),{data:m}=(0,p.p)(),[w,x]=(0,i.useState)(!1),b=(0,i.useMemo)(()=>Object.keys(e).filter(e=>!(0,r.Mg)(e)),[e]),[v,g]=(0,i.useState)(t&&h[t]||{}),updateAllownce=(e,n)=>{t&&(h[t]={...h[t]||{},[e]:n},g(t=>({...t,[e]:n})))};(0,i.useEffect)(()=>{a&&t&&o&&b.forEach(e=>{(0,s.B)(o).readContract({abi:u.Wo,address:e,functionName:"allowance",args:[a,t]}).then(t=>updateAllownce(e,t||0n)).catch(console.error)})},[b,o,a]);let[N,y]=(0,i.useState)(!1),A=(0,i.useMemo)(()=>b.filter(t=>(0,c.ok)(e,t)>0n&&(0,c.ok)(e,t)>(0,c.ok)(v,t)),[e,b,v]),approve=async()=>{if(0!=A.length&&t&&a)try{y(!0),x(!1);for(let r=0;r<A.length;r++){let c=A[r],i=!1===n?e[c]:n,d=await (null==m?void 0:m.writeContract({abi:u.Wo,address:c,functionName:"approve",args:[t,i]}));d&&await (0,s.B)(o).waitForTransactionReceipt({hash:d});let p=await (0,s.B)(o).readContract({abi:u.Wo,address:c,functionName:"allowance",args:[a,t]});p<e[c]&&l.A.error("Insufficient amount of approve"),updateAllownce(c,p)}l.A.success("Approve success"),y(!1),x(!0)}catch(e){l.A.error((0,c.az)(e)),y(!1),x(!1)}};return{approve,loading:N,shouldApprove:A.length>0,isSuccess:w}},m={},useNftApproves=(e,t)=>{let{address:n}=(0,d.m)(),a=(0,f.pK)(),{data:r}=(0,p.p)(),[h,w]=(0,i.useState)(!1),x=(0,o.X)(e),[b,v]=(0,i.useState)(t&&m[t]||{}),updateAllownce=(e,n)=>{t&&(m[t]={...m[t]||{},[e]:n},v(t=>({...t,[e]:n})))};(0,i.useEffect)(()=>{n&&t&&a&&x.forEach(e=>{(0,s.B)(a).readContract({abi:u.Hr,address:e,functionName:"isApprovedForAll",args:[n,t]}).then(t=>t!==b[e]&&updateAllownce(e,t)).catch(console.error)})},[x,a,n]);let[g,N]=(0,i.useState)(!1),y=(0,i.useMemo)(()=>x.filter(e=>!b[e]),[e,x,b]),approve=async()=>{if(0!=y.length&&t)try{N(!0),w(!1);for(let e=0;e<y.length;e++){let n=y[e],c=await (null==r?void 0:r.writeContract({abi:u.Hr,address:n,functionName:"setApprovalForAll",args:[t,!0]}));c&&await (0,s.B)(a).waitForTransactionReceipt({hash:c}),updateAllownce(n,!0)}l.A.success("Approve success"),N(!1),w(!0)}catch(e){l.A.error((0,c.az)(e)),N(!1),w(!1)}};return{approve,loading:g,shouldApprove:y.length>0,isSuccess:h}};function useWrapContractWrite(e,t){let{autoToast:n=!0,onSuccess:a}=t||{},[r,o]=(0,i.useState)(!1),[u,d]=(0,i.useState)(!1),{data:h}=(0,p.p)(),m=(0,f.pK)(),w=!h||!h.account||r||!e||h.chain.id!==m,write=async()=>{if(!w){o(!0),d(!1);try{let r="function"==typeof e?await e():e,c=(0,s.B)(m),o={account:h.account,...r};if(!(null==t?void 0:t.skipSimulate)){let e=await c.simulateContract(o);o=e.request}let i=await h.writeContract(o),u=await c.waitForTransactionReceipt({hash:i,confirmations:null==t?void 0:t.confirmations});if("success"!==u.status)throw"Transaction reverted";d(!0),a&&a(u),n&&l.A.success("Transaction success")}catch(e){n&&l.A.error((0,c.az)(e))}o(!1)}};return{write,isDisabled:w,isLoading:r,isSuccess:u}}var w=n(88501),x=n(34113),b=n(82790),v=n(95499),g=n(68654),N=n(45820),y=n(93108),A=n(16804),k=n(5807);function SwitchNet(e){let{className:t}=e,n=(0,g.o)(),r=(0,f.pK)();return(0,a.jsx)(N.k6,{className:(0,w.m)("flex items-center justify-center gap-4 whitespace-nowrap w-fit min-w-[200px]",t),onClick:()=>n.switchChainAsync({chainId:r}).catch(console.error),busy:n.isPending,disabled:n.isPending,children:"Switch Network"})}function ApproveAndTx(e){let{className:t,tx:n,busyShowTxet:r=!0,approves:c,spender:s,requestAmount:o,config:l,toast:u=!0,skipSimulate:d=!1,disabled:p,confirmations:h,onTxSuccess:m,onApproveSuccess:x}=e,{write:b,isDisabled:v,isLoading:g}=useWrapContractWrite(l,{onSuccess:e=>m&&m(e),autoToast:u,skipSimulate:d,confirmations:h}),y=p||v||g||!1===l.enabled,{approve:A,shouldApprove:k,loading:S,isSuccess:C}=useApproves(c||{},s,o),j=(0,i.useRef)();j.current=x,(0,i.useEffect)(()=>{j.current&&C&&j.current()},[C]);let T=(0,f.tx)();return T?(0,a.jsx)(SwitchNet,{className:t}):k?(0,a.jsx)(N.k6,{className:(0,w.m)("flex items-center justify-center gap-4",t),onClick:A,busy:S,disabled:p||!A||S,children:"Approve"}):(0,a.jsx)(N.k6,{className:(0,w.m)("flex items-center justify-center gap-4",t),onClick:()=>b(),busy:g,busyShowContent:r,disabled:y,children:n})}function NftApproveAndTx(e){let{className:t,tx:n,busyShowTxet:r=!0,approves:c,spender:s,requestAmount:o,config:l,toast:u=!0,skipSimulate:d=!1,disabled:p,confirmations:h,onTxSuccess:m,onApproveSuccess:x}=e,{write:b,isDisabled:v,isLoading:g}=useWrapContractWrite(l,{onSuccess:e=>m&&m(e),autoToast:u,skipSimulate:d,confirmations:h}),y=p||v||g||!1===l.enabled,{approve:A,shouldApprove:k,loading:S,isSuccess:C}=useNftApproves(null!=c?c:{},s),j=(0,i.useRef)();j.current=x,(0,i.useEffect)(()=>{j.current&&C&&j.current()},[C]);let T=(0,f.tx)();return T?(0,a.jsx)(SwitchNet,{className:t}):k?(0,a.jsx)(N.k6,{className:(0,w.m)("flex items-center justify-center gap-4",t),onClick:A,busy:S,disabled:p||!A||S,children:"Approve"}):(0,a.jsx)(N.k6,{className:(0,w.m)("flex items-center justify-center gap-4",t),onClick:()=>b(),busy:g,busyShowContent:r,disabled:y,children:n})}let S=(0,y.Ue)(()=>({txs:[],progress:0}));function Txs(e){let{className:t,tx:n,txs:r,disabled:o,disableSendCalls:i=!0,disableProgress:u,busyShowTxet:d=!0,toast:h=!0,onTxSuccess:m}=e,{data:b}=(0,p.p)(),g=(0,f.tx)(),y=(0,f.pK)(),{mutate:A,isPending:k}=(0,v.D)({mutationFn:async()=>{if(!b)return;let e=(0,s.B)(y),t=await (0,c.IE)(r).then(e=>Promise.all(e.map(c.IE)));console.info("calls:",b.account.address,t);try{if(i)throw Error("disable wallet_sendCalls");if(1==t.length)throw Error("calls length one wallet_sendCalls");let{id:e}=await b.sendCalls({account:b.account.address,calls:t.map(e=>({data:(0,x.R)({abi:e.abi,functionName:e.functionName,args:e.args}),to:e.address}))});for(;;){let t=await b.waitForCallsStatus({id:e});if("pending"!=t.status){if("success"==t.status)h&&l.A.success("Transactions Success"),null==m||m();else throw Error("Transactions ".concat(t.status," ").concat(JSON.stringify(t)));break}}}catch(r){let n=(0,c.az)(r),a=!u&&t.length>1;if(n&&(n.includes("wallet_sendCalls")||n.includes("EIP-7702 not supported"))){let n=0;for(let r of(a&&S.setState({txs:t,progress:n}),t)){let t=await b.writeContract(r),c=await e.waitForTransactionReceipt({hash:t,confirmations:1});if("success"!==c.status)throw Error("Transactions Reverted");n++,a&&S.setState({progress:n})}h&&l.A.success("Transactions Success"),S.setState({progress:0,txs:[]}),null==m||m()}}},onError:e=>{S.setState({progress:0,txs:[]}),h&&(0,c.S3)(e)}}),C=o||k||"function"!=typeof r&&0==r.length||!b;return g?(0,a.jsx)(SwitchNet,{className:t}):(0,a.jsx)(N.k6,{className:(0,w.m)("flex items-center justify-center gap-4",t),onClick:()=>A(),busy:k,busyShowContent:d,disabled:C,children:n})}async function withTokenApprove(e){let{approves:t,pc:n,user:a,tx:c}=e,s=0n,o=await Promise.all(t.map(async e=>{var t;if(b.DR===e.token)return s+=e.amount,null;let c=await n.readContract({abi:u.Wo,address:e.token,functionName:"allowance",args:[a,e.spender]});if(c>=e.amount)return null;let o=null!==(t=e.name)&&void 0!==t?t:"Approve ".concat((0,r.kb)(e.token,await n.getChainId()).symbol);return{name:o,abi:u.Wo,address:e.token,functionName:"approve",args:[e.spender,e.amount-c]}})).then(e=>e.filter(e=>null!==e));return[...o,{...c,...s>0n?{value:s}:{}}]}function TxsStat(e){let{className:t}=e,{txs:n,progress:r}=S();return 0==n.length?null:(0,a.jsxs)(A.o,{open:!0,disableClose:!0,className:(0,c.cn)("w-80 text-black dark:text-white flex flex-col gap-2 p-4",t),children:[(0,a.jsx)("div",{className:"text-xl font-semibold",children:"Progress"}),n.map((e,t)=>{var n;return(0,a.jsxs)("div",{className:"animitem flex items-center gap-5 bg-primary/20 rounded-lg px-4 py-2",children:[(0,a.jsx)("span",{className:"font-semibold",children:t+1}),null!==(n=e.name)&&void 0!==n?n:e.functionName,(0,a.jsxs)("div",{className:(0,c.cn)("ml-auto text-xl",{"animate-spin":r==t}),children:[r==t&&(0,a.jsx)(k.fCD,{}),r>t&&(0,a.jsx)(k.l_A,{className:"text-green-500"})]})]},"tx_item_stat_".concat(t))})]})}},77087:function(e,t,n){n.d(t,{$:function(){return Spinner}});var a=n(52987),r=n(13854);let Spinner=e=>{let{className:t}=e;return(0,a.jsxs)("svg",{fill:"none",className:(0,r.cn)("animate-spin h-5 w-5 2-ml-1 2mr-3",t),viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},45820:function(e,t,n){n.d(t,{HY:function(){return Swap},k6:function(){return BBtn}});var a=n(52987),r=n(13854),c=n(80329),s=n(77317),o=n(63114),i=n(77087);function BBtn(e){let{borderWidth:t=1,children:n,busy:o,busyShowContent:l=!0,className:u,hiddenBorder:d,...p}=e,f=(0,s.useRef)(null),[h,m]=(0,s.useState)("0_0"),w="unset",x="unset";if(f.current&&!d){let e=f.current,n=e.clientWidth,a=e.clientHeight,r=parseInt(getComputedStyle(e).borderRadius.replace("px","")),s="A".concat(r-t," ").concat(r-t," 0, 0, 1, ").concat(r," ").concat(t,"L").concat(n-r," ").concat(t),o="A".concat(r-t," ").concat(r-t," 0, 0, 1, ").concat(n-t," ").concat(r,"L").concat(n-t," ").concat(a-r),i="A".concat(r-t," ").concat(r-t," 0, 0, 1, ").concat(n-r," ").concat(a-t,"L").concat(r," ").concat(a-t," "),l="A".concat(r-t," ").concat(r-t," 0, 0, 1, ").concat(t," ").concat(a-r,"L").concat(t," ").concat(r),u="M ".concat(t," ").concat(r," ").concat(s," ").concat(o," ").concat(i," ").concat(l),d="M 0 0 L 0 ".concat(a," L ").concat(n," ").concat(a," L ").concat(n," 0 L 0 0 ").concat(u," Z");w="path('".concat(d,"')");let p=2*n,tranP=e=>(0,c.N)(e/2,2);x="radial-gradient(122.5% ".concat((0,c.N)(122.5/(n/a),2),"% at ").concat((0,c.N)((52.9*n+50*p-50*n)/p,2),"% ").concat((0,c.N)((16.25*a+50*p-50*a)/p,2),"%, #15d264 0%, #2cbd35 ").concat(tranP(36.26),"%, #dcf45d ").concat(tranP(92.54),"%)")}return(0,s.useEffect)(()=>{let e=new ResizeObserver(()=>{var e,t;m("".concat((null===(e=f.current)||void 0===e?void 0:e.clientWidth)||0,"_").concat((null===(t=f.current)||void 0===t?void 0:t.clientWidth)||0))});return f.current&&e.observe(f.current),()=>{f.current&&e.unobserve(f.current)}},[f.current]),(0,a.jsxs)("button",{...p,ref:f,className:(0,r.cn)("group/bbtn relative px-3 cursor-pointer w-full transition-all leading-[2.375] ring-0 text-base text-black dark:text-white font-medium h-10 rounded-lg disabled:opacity-60 disabled:cursor-not-allowed bg-btn  dark:bg-btndark",{"hover:bg-btnhover dark:hover:bg-btndarkhover":!e.disabled},u),children:[!d&&(0,a.jsx)("div",{className:"absolute w-full h-full left-0 top-0 flex justify-center items-center rounded-lg overflow-hidden",style:{visibility:f.current?"visible":"hidden",clipPath:w},children:(0,a.jsx)("div",{className:(0,r.cn)("w-[200%] aspect-square shrink-0",{"dark:group-hover/bbtn:opacity-60":!e.disabled}),style:{background:x}})}),o&&(0,a.jsx)(i.$,{}),(l||!o)&&n]})}function Swap(e){let{className:t,style:n,...c}=e;return(0,a.jsx)("div",{...c,style:{transform:"rotateX(180deg) rotateZ(90deg)",...n||{}},className:(0,r.cn)("flex w-8 h-8 justify-center items-center self-center text-sm cursor-pointer border border-slate-500 text-slate-500 rounded-full hover:text-primary hover:border-primary",t),children:(0,a.jsx)(o.t4O,{})})}}}]);