(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,587534,e=>{"use strict";var t=e.i(364189),r=e.i(119013),n=e.i(146429),a=e.i(666963),s=e.i(754460),o=e.i(844952),i=e.i(893606),l=e.i(980726);let c={validateCaipAddress(e){if(e.split(":")?.length!==3)throw Error("Invalid CAIP Address");return e},parseCaipAddress(e){let t=e.split(":");if(3!==t.length)throw Error(`Invalid CAIP-10 address: ${e}`);let[r,n,a]=t;if(!r||!n||!a)throw Error(`Invalid CAIP-10 address: ${e}`);return{chainNamespace:r,chainId:n,address:a}},parseCaipNetworkId(e){let t=e.split(":");if(2!==t.length)throw Error(`Invalid CAIP-2 network id: ${e}`);let[r,n]=t;if(!r||!n)throw Error(`Invalid CAIP-2 network id: ${e}`);return{chainNamespace:r,chainId:n}}};var d=e.i(387526),C=e.i(448749),p=e.i(894737),h=e.i(298937),u=e.i(141277),N=e.i(613952),m=e.i(688376),g=e.i(97006);let w={convertEVMChainIdToCoinType(e){if(e>=0x80000000)throw Error("Invalid chainId");return(0x80000000|e)>>>0}};var A=e.i(781533),v=e.i(503462),f=e.i(874046);let E=(0,m.proxy)({suggestions:[],loading:!1}),y=(0,v.withErrorBoundary)({state:E,subscribe:e=>(0,m.subscribe)(E,()=>e(E)),subscribeKey:(e,t)=>(0,g.subscribeKey)(E,e,t),async resolveName(e){try{return await h.BlockchainApiController.lookupEnsName(e)}catch(e){throw Error(e?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(e){try{return await h.BlockchainApiController.lookupEnsName(e),!0}catch{return!1}},async getSuggestions(e){try{return E.loading=!0,E.suggestions=[],E.suggestions=(await h.BlockchainApiController.getEnsNameSuggestions(e)).suggestions.map(e=>({...e,name:e.name}))||[],E.suggestions}catch(e){throw Error(y.parseEnsApiError(e,"Error fetching name suggestions"))}finally{E.loading=!1}},async getNamesForAddress(e){try{if(!u.ChainController.state.activeCaipNetwork)return[];let t=A.StorageUtil.getEnsFromCacheForAddress(e);if(t)return t;let r=await h.BlockchainApiController.reverseLookupEnsName({address:e});return A.StorageUtil.updateEnsCache({address:e,ens:r,timestamp:Date.now()}),r}catch(e){throw Error(y.parseEnsApiError(e,"Error fetching names for address"))}},async registerName(e){let a=u.ChainController.state.activeCaipNetwork;if(!a)throw Error("Network not found");let s=t.AccountController.state.address,o=n.ConnectorController.getAuthConnector();if(!s||!o)throw Error("Address or auth connector not found");E.loading=!0;try{let n=JSON.stringify({name:e,attributes:{},timestamp:Math.floor(Date.now()/1e3)});f.RouterController.pushTransactionStack({onCancel(){f.RouterController.replace("RegisterAccountName")}});let o=await r.ConnectionController.signMessage(n);E.loading=!1;let i=a.id;if(!i)throw Error("Network not found");let l=w.convertEVMChainIdToCoinType(Number(i));await h.BlockchainApiController.registerEnsName({coinType:l,address:s,signature:o,message:n}),t.AccountController.setProfileName(e,a.chainNamespace),f.RouterController.replace("RegisterAccountNameSuccess")}catch(r){let t=y.parseEnsApiError(r,`Error registering name ${e}`);throw f.RouterController.replace("RegisterAccountName"),Error(t)}finally{E.loading=!1}},validateName:e=>/^[a-zA-Z0-9-]{4,}$/u.test(e),parseEnsApiError:(e,t)=>e?.reasons?.[0]?.description||t});var b=e.i(867388),I=e.i(273561);let O={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},k={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},T={providers:N.ONRAMP_PROVIDERS,selectedProvider:null,error:null,purchaseCurrency:O,paymentCurrency:k,purchaseCurrencies:[O],paymentCurrencies:[],quotesLoading:!1},U=(0,m.proxy)(T),_=(0,v.withErrorBoundary)({state:U,subscribe:e=>(0,m.subscribe)(U,()=>e(U)),subscribeKey:(e,t)=>(0,g.subscribeKey)(U,e,t),setSelectedProvider(e){if(e&&"meld"===e.name){let r=u.ChainController.state.activeChain===i.ConstantsUtil.CHAIN.SOLANA?"SOL":"USDC",n=t.AccountController.state.address??"",a=new URL(e.url);a.searchParams.append("publicKey",N.MELD_PUBLIC_KEY),a.searchParams.append("destinationCurrencyCode",r),a.searchParams.append("walletAddress",n),a.searchParams.append("externalCustomerId",s.OptionsController.state.projectId),U.selectedProvider={...e,url:a.toString()}}else U.selectedProvider=e},setOnrampProviders(e){Array.isArray(e)&&e.every(e=>"string"==typeof e)?U.providers=N.ONRAMP_PROVIDERS.filter(t=>e.includes(t.name)):U.providers=[]},setPurchaseCurrency(e){U.purchaseCurrency=e},setPaymentCurrency(e){U.paymentCurrency=e},setPurchaseAmount(e){_.state.purchaseAmount=e},setPaymentAmount(e){_.state.paymentAmount=e},async getAvailableCurrencies(){let e=await h.BlockchainApiController.getOnrampOptions();U.purchaseCurrencies=e.purchaseCurrencies,U.paymentCurrencies=e.paymentCurrencies,U.paymentCurrency=e.paymentCurrencies[0]||k,U.purchaseCurrency=e.purchaseCurrencies[0]||O,await C.ApiController.fetchCurrencyImages(e.paymentCurrencies.map(e=>e.id)),await C.ApiController.fetchTokenImages(e.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){U.quotesLoading=!0;try{let e=await h.BlockchainApiController.getOnrampQuote({purchaseCurrency:U.purchaseCurrency,paymentCurrency:U.paymentCurrency,amount:U.paymentAmount?.toString()||"0",network:U.purchaseCurrency?.symbol});return U.quotesLoading=!1,U.purchaseAmount=Number(e?.purchaseAmount.amount),e}catch(e){return U.error=e.message,U.quotesLoading=!1,null}finally{U.quotesLoading=!1}},resetState(){U.selectedProvider=null,U.error=null,U.purchaseCurrency=O,U.paymentCurrency=k,U.purchaseCurrencies=[O],U.paymentCurrencies=[],U.paymentAmount=void 0,U.purchaseAmount=void 0,U.quotesLoading=!1}});var P=e.i(855902),S=e.i(285624),R=e.i(509838),D=e.i(869954),L=e.i(456022);function M(e,t){return n.ConnectorController.getConnectorId(e)===t}e.i(211068),e.i(618290);var W=e.i(50167);e.i(953078);var F=e.i(840042),B=e.i(114752),x=e.i(29379),j=e.i(386079),K=e.i(32290);function q(e,t={}){let{key:r="fallback",name:n="Fallback",rank:a=!1,shouldThrow:s=H,retryCount:o,retryDelay:i}=t;return({chain:t,pollingInterval:l=4e3,timeout:c,...d})=>{let C=e,p=()=>{},h=(0,K.createTransport)({key:r,name:n,async request({method:e,params:r}){let n,a=async(o=0)=>{let i=C[o]({...d,chain:t,retryCount:0,timeout:c});try{let t=await i.request({method:e,params:r});return p({method:e,params:r,response:t,transport:i,status:"success"}),t}catch(l){if(p({error:l,method:e,params:r,transport:i,status:"error"}),s(l)||o===C.length-1||!(n??=C.slice(o+1).some(r=>{let{include:n,exclude:a}=r({chain:t}).config.methods||{};return n?n.includes(e):!a||!a.includes(e)})))throw l;return a(o+1)}};return a()},retryCount:o,retryDelay:i,type:"fallback"},{onResponse:e=>p=e,transports:C.map(e=>e({chain:t,retryCount:0}))});if(a){let e="object"==typeof a?a:{};!function({chain:e,interval:t=4e3,onTransports:r,ping:n,sampleCount:a=10,timeout:s=1e3,transports:o,weights:i={}}){let{stability:l=.7,latency:c=.3}=i,d=[],C=async()=>{let i=await Promise.all(o.map(async t=>{let r,a,o=t({chain:e,retryCount:0,timeout:s}),i=Date.now();try{await (n?n({transport:o}):o.request({method:"net_listening"})),a=1}catch{a=0}finally{r=Date.now()}return{latency:r-i,success:a}}));d.push(i),d.length>a&&d.shift();let p=Math.max(...d.map(e=>Math.max(...e.map(({latency:e})=>e))));r(o.map((e,t)=>{let r=d.map(e=>e[t].latency),n=r.reduce((e,t)=>e+t,0)/r.length,a=d.map(e=>e[t].success),s=a.reduce((e,t)=>e+t,0)/a.length;return 0===s?[0,t]:[c*(1-n/p)+l*s,t]}).sort((e,t)=>t[0]-e[0]).map(([,e])=>o[e])),await (0,j.wait)(t),C()};C()}({chain:t,interval:e.interval??l,onTransports:e=>C=e,ping:e.ping,sampleCount:e.sampleCount,timeout:e.timeout,transports:C,weights:e.weights})}return h}}function H(e){return!!("code"in e&&"number"==typeof e.code&&(e.code===x.TransactionRejectedRpcError.code||e.code===x.UserRejectedRequestError.code||B.ExecutionRevertedError.nodeMessage.test(e.message)||5e3===e.code))}var V=e.i(677402),z=e.i(941009);i.ConstantsUtil.CONNECTOR_ID.COINBASE,i.ConstantsUtil.CONNECTOR_ID.COINBASE_SDK,i.ConstantsUtil.CONNECTOR_ID.SAFE,i.ConstantsUtil.CONNECTOR_ID.LEDGER,i.ConstantsUtil.CONNECTOR_ID.OKX,z.ConstantsUtil.METMASK_CONNECTOR_NAME,z.ConstantsUtil.TRUST_CONNECTOR_NAME,z.ConstantsUtil.SOLFLARE_CONNECTOR_NAME,z.ConstantsUtil.PHANTOM_CONNECTOR_NAME,z.ConstantsUtil.COIN98_CONNECTOR_NAME,z.ConstantsUtil.MAGIC_EDEN_CONNECTOR_NAME,z.ConstantsUtil.BACKPACK_CONNECTOR_NAME,z.ConstantsUtil.BITGET_CONNECTOR_NAME,z.ConstantsUtil.FRONTIER_CONNECTOR_NAME,z.ConstantsUtil.XVERSE_CONNECTOR_NAME,z.ConstantsUtil.LEATHER_CONNECTOR_NAME;let $={1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",0xaa36a7:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",0x4e454152:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},J={[i.ConstantsUtil.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[i.ConstantsUtil.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[i.ConstantsUtil.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[i.ConstantsUtil.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[i.ConstantsUtil.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},Y={[i.ConstantsUtil.CONNECTOR_ID.INJECTED]:"Browser Wallet",[i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[i.ConstantsUtil.CONNECTOR_ID.COINBASE]:"Coinbase",[i.ConstantsUtil.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[i.ConstantsUtil.CONNECTOR_ID.LEDGER]:"Ledger",[i.ConstantsUtil.CONNECTOR_ID.SAFE]:"Safe"};function G(e,t){let r=new URL("https://rpc.walletconnect.org/v1/");return r.searchParams.set("chainId",e),r.searchParams.set("projectId",t),r.toString()}i.ConstantsUtil.CONNECTOR_ID.INJECTED,i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT,i.ConstantsUtil.CONNECTOR_ID.EIP6963,i.ConstantsUtil.CONNECTOR_ID.AUTH;let X=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],Z={extendRpcUrlWithProjectId(e,t){let r=!1;try{r="rpc.walletconnect.org"===new URL(e).host}catch(e){r=!1}if(r){let r=new URL(e);return r.searchParams.has("projectId")||r.searchParams.set("projectId",t),r.toString()}return e},isCaipNetwork:e=>"chainNamespace"in e&&"caipNetworkId"in e,getChainNamespace(e){return this.isCaipNetwork(e)?e.chainNamespace:i.ConstantsUtil.CHAIN.EVM},getCaipNetworkId(e){return this.isCaipNetwork(e)?e.caipNetworkId:`${i.ConstantsUtil.CHAIN.EVM}:${e.id}`},getDefaultRpcUrl(e,t,r){let n=e.rpcUrls?.default?.http?.[0];return X.includes(t)?G(t,r):n||""},extendCaipNetwork(e,{customNetworkImageUrls:t,projectId:r,customRpcUrls:n}){let a=this.getChainNamespace(e),s=this.getCaipNetworkId(e),o=e.rpcUrls.default.http?.[0],i=this.getDefaultRpcUrl(e,s,r),l=e?.rpcUrls?.chainDefault?.http?.[0]||o,c=n?.[s]?.map(e=>e.url)||[],d=[...c,i],C=[...c];return l&&!C.includes(l)&&C.push(l),{...e,chainNamespace:a,caipNetworkId:s,assets:{imageId:$[e.id],imageUrl:t?.[e.id]},rpcUrls:{...e.rpcUrls,default:{http:d},chainDefault:{http:C}}}},extendCaipNetworks:(e,{customNetworkImageUrls:t,projectId:r,customRpcUrls:n})=>e.map(e=>Z.extendCaipNetwork(e,{customNetworkImageUrls:t,customRpcUrls:n,projectId:r})),getViemTransport(e,t,r){let n=[];return r?.forEach(e=>{n.push((0,V.http)(e.url,e.config))}),X.includes(e.caipNetworkId)&&n.push((0,V.http)(G(e.caipNetworkId,t),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),e?.rpcUrls?.default?.http?.forEach(e=>{n.push((0,V.http)(e))}),q(n)},extendWagmiTransports(e,t,r){if(X.includes(e.caipNetworkId)){let n=this.getDefaultRpcUrl(e,e.caipNetworkId,t);return q([r,(0,V.http)(n)])}return r},getUnsupportedNetwork:e=>({id:e.split(":")[1],caipNetworkId:e,name:i.ConstantsUtil.UNSUPPORTED_NETWORK_NAME,chainNamespace:e.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}),getCaipNetworkFromStorage(e){let t=A.StorageUtil.getActiveCaipNetworkId(),r=u.ChainController.getAllRequestedCaipNetworks(),n=Array.from(u.ChainController.state.chains?.keys()||[]),a=t?.split(":")[0],s=!!a&&n.includes(a),o=r?.find(e=>e.caipNetworkId===t);return s&&!o&&t?this.getUnsupportedNetwork(t):o||e||r?.[0]}},Q=(new AbortController,{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}}),ee={SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${"undefined"!=typeof window?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},IFRAME_LOAD_FAILED:{shortMessage:"Network Error - Could not load embedded wallet",longMessage:()=>"There was an issue loading the embedded wallet. Please try again later."},IFRAME_REQUEST_TIMEOUT:{shortMessage:"Embedded Wallet Request Timed Out",longMessage:()=>"There was an issue doing the request to the embedded wallet. Please try again later."},UNVERIFIED_DOMAIN:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}};var et=e.i(876802),er=e.i(687542);let en={createLogger(e,t="error"){let r=(0,er.getDefaultLoggerOptions)({level:t}),{logger:n}=(0,er.generatePlatformLogger)({opts:r});return n.error=(...t)=>{for(let r of t)if(r instanceof Error)return void e(r,...t);e(void 0,...t)},n}},ea={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},es=(0,m.proxy)({providers:{...ea},providerIds:{...ea}}),eo={state:es,subscribeKey:(e,t)=>(0,g.subscribeKey)(es,e,t),subscribe:e=>(0,m.subscribe)(es,()=>{e(es)}),subscribeProviders:e=>(0,m.subscribe)(es.providers,()=>e(es.providers)),setProvider(e,t){t&&(es.providers[e]=(0,m.ref)(t))},getProvider:e=>es.providers[e],setProviderId(e,t){t&&(es.providerIds[e]=t)},getProviderId(e){if(e)return es.providerIds[e]},reset(){es.providers={...ea},es.providerIds={...ea}},resetChain(e){es.providers[e]=void 0,es.providerIds[e]=void 0}};var ei=e.i(344048),el=e.i(995451);let ec=["http://localhost:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"];function ed(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}let eC=ed({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),ep=ed({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});ed({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"}),ed({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}}),ed({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});let eh={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},eu={getMethodsByChainNamespace:e=>eh[e]||[],createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};let r={...e},n=new Set;if(t.methods&&Object.keys(t.methods).forEach(e=>n.add(e)),t.chains&&Object.keys(t.chains).forEach(e=>n.add(e)),t.events&&Object.keys(t.events).forEach(e=>n.add(e)),t.rpcMap&&Object.keys(t.rpcMap).forEach(e=>{let[t]=e.split(":");t&&n.add(t)}),n.forEach(e=>{r[e]||(r[e]=this.createDefaultNamespace(e))}),t.methods&&Object.entries(t.methods).forEach(([e,t])=>{r[e]&&(r[e].methods=t)}),t.chains&&Object.entries(t.chains).forEach(([e,t])=>{r[e]&&(r[e].chains=t)}),t.events&&Object.entries(t.events).forEach(([e,t])=>{r[e]&&(r[e].events=t)}),t.rpcMap){let e=new Set;Object.entries(t.rpcMap).forEach(([t,n])=>{let[a,s]=t.split(":");a&&s&&r[a]&&(r[a].rpcMap||(r[a].rpcMap={}),e.has(a)||(r[a].rpcMap={},e.add(a)),r[a].rpcMap[s]=n)})}return r},createNamespaces(e,t){let r=e.reduce((e,t)=>{let{id:r,chainNamespace:n,rpcUrls:a}=t,s=a.default.http[0];e[n]||(e[n]=this.createDefaultNamespace(n));let o=`${n}:${r}`,i=e[n];switch(i.chains.push(o),o){case eC.caipNetworkId:i.chains.push(eC.deprecatedCaipNetworkId);break;case ep.caipNetworkId:i.chains.push(ep.deprecatedCaipNetworkId)}return i?.rpcMap&&s&&(i.rpcMap[r]=s),e},{});return this.applyNamespaceOverrides(r,t)},resolveReownName:async e=>{let t=await y.resolveName(e),r=Object.values(t?.addresses)||[];return r[0]?.address||!1},getChainsFromNamespaces:(e={})=>Object.values(e).flatMap(e=>Array.from(new Set([...e.chains||[],...e.accounts.map(e=>{let[t,r]=e.split(":");return`${t}:${r}`})]))),isSessionEventData:e=>"object"==typeof e&&null!==e&&"id"in e&&"topic"in e&&"params"in e&&"object"==typeof e.params&&null!==e.params&&"chainId"in e.params&&"event"in e.params&&"object"==typeof e.params.event&&null!==e.params.event,isOriginAllowed(e,t,r){for(let n of[...t,...r])if(n.includes("*")){let t=n.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&");if(RegExp(`^${t.replace(/\\\*/gu,".*")}$`,"u").test(e))return!0}else try{if(new URL(n).origin===e)return!0}catch(t){if(n===e)return!0}return!1}};class eN{constructor({provider:e,namespace:t}){this.id=i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT,this.name=Y[i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=J[i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=u.ChainController.getCaipNetworks.bind(u.ChainController),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){let e=this.getCaipNetworks(),t=s.OptionsController.state.universalProviderConfigOverride,r=eu.createNamespaces(e,t);await this.provider.connect({optionalNamespaces:r})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){let e=this.chains.map(e=>e.caipNetworkId);return S.SIWXUtil.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:em})}}let em=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class eg{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,this.getCaipNetworks=e=>u.ChainController.getCaipNetworks(e),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.getCaipNetworks(this.namespace)}setAuthProvider(e){this.addConnector({id:i.ConstantsUtil.CONNECTOR_ID.AUTH,type:"AUTH",name:i.ConstantsUtil.CONNECTOR_NAMES.AUTH,provider:e,imageId:J[i.ConstantsUtil.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){let t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(e=>!t.has(e.id)&&(t.add(e.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,r){t.AccountController.setStatus(e,r)}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(t)}off(e,t){let r=this.eventListeners.get(e);r&&r.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){let r=this.eventListeners.get(e);r&&r.forEach(e=>e(t))}async connectWalletConnect(e){let t=this.getWalletConnectConnector();return{clientId:(await t.connectWalletConnect()).clientId}}async switchNetwork(e){let{caipNetwork:r,providerType:n}=e;if(!e.provider)return;let a="provider"in e.provider?e.provider.provider:e.provider;if("WALLET_CONNECT"===n)return void a.setDefaultChain(r.caipNetworkId);if(a&&"AUTH"===n){let e=t.AccountController.state.preferredAccountTypes?.[r.chainNamespace];await a.switchNetwork(r.caipNetworkId);let n=await a.getUser({chainId:r.caipNetworkId,preferredAccountType:e});this.emit("switchNetwork",n)}}getWalletConnectConnector(){let e=this.connectors.find(e=>e instanceof eN);if(!e)throw Error("WalletConnectConnector not found");return e}}class ew extends eg{setUniversalProvider(e){this.addConnector(new eN({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{let e=this.getWalletConnectConnector();await e.disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){let t=this.provider;return Promise.resolve({accounts:(t?.session?.namespaces?.[e]?.accounts?.map(e=>{let[,,t]=e.split(":");return t}).filter((e,t,r)=>r.indexOf(e)===t)||[]).map(t=>a.CoreHelperUtil.createAccount(e,t,"bip122"===e?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&N.ConstantsUtil.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};if(t.AccountController.state.balanceLoading&&e.chainId===u.ChainController.state.activeCaipNetwork?.id)return{balance:t.AccountController.state.balance||"0.00",symbol:t.AccountController.state.balanceSymbol||""};let r=(await t.AccountController.fetchTokenBalance()).find(t=>t.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&t.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:r?.quantity.numeric||"0.00",symbol:r?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){let{provider:t,message:r,address:n}=e;if(!t)throw Error("UniversalAdapter:signMessage - provider is undefined");return{signature:u.ChainController.state.activeCaipNetwork?.chainNamespace===i.ConstantsUtil.CHAIN.SOLANA?(await t.request({method:"solana_signMessage",params:{message:ei.default.encode(new TextEncoder().encode(r)),pubkey:n}},u.ChainController.state.activeCaipNetwork?.caipNetworkId)).signature:await t.request({method:"personal_sign",params:[r,n]},u.ChainController.state.activeCaipNetwork?.caipNetworkId)}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){let{caipNetwork:t}=e,r=this.getWalletConnectConnector();if(t.chainNamespace===i.ConstantsUtil.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,el.toHex)(t.id)}]})}catch(e){if(4902===e.code||32603===e.code||5e3===e.code||e?.data?.originalError?.code===4902)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:(0,el.toHex)(t.id),rpcUrls:[t?.rpcUrls.chainDefault?.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[t.blockExplorers?.default.url]}]})}catch(e){throw Error("Chain is not supported")}}r.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){let e=this.connectors.find(e=>"WALLET_CONNECT"===e.type);return e?.provider}}let eA=["email","socials","swaps","onramp","activity","reownBranding"],ev={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.includes("email")},processFallback:e=>void 0===e?N.ConstantsUtil.DEFAULT_REMOTE_FEATURES.email:!!e},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.length>0&&t.filter(e=>"email"!==e)},processFallback:e=>void 0===e?N.ConstantsUtil.DEFAULT_REMOTE_FEATURES.socials:"boolean"==typeof e?!!e&&N.ConstantsUtil.DEFAULT_REMOTE_FEATURES.socials:e},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.length>0&&t},processFallback:e=>void 0===e?N.ConstantsUtil.DEFAULT_REMOTE_FEATURES.swaps:"boolean"==typeof e?!!e&&N.ConstantsUtil.DEFAULT_REMOTE_FEATURES.swaps:e},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;let t=e.config;return!!e.isEnabled&&t.length>0&&t},processFallback:e=>void 0===e?N.ConstantsUtil.DEFAULT_REMOTE_FEATURES.onramp:"boolean"==typeof e?!!e&&N.ConstantsUtil.DEFAULT_REMOTE_FEATURES.onramp:e},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>void 0===e?N.ConstantsUtil.DEFAULT_REMOTE_FEATURES.activity:!!e},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>void 0===e?N.ConstantsUtil.DEFAULT_REMOTE_FEATURES.reownBranding:!!e}},ef={localSettingsOverridden:new Set,getApiConfig:(e,t)=>t?.find(t=>t.id===e),addWarning(e,t){if(void 0!==e){let e=ev[t],r=e.isLegacy?`"features.${e.localFeatureName}" (now "${t}")`:`"features.${t}"`;this.localSettingsOverridden.add(r)}},processFeature(e,t,r,n,a){let s=ev[e],o=t[s.localFeatureName];if(a&&!s.isAvailableOnBasic)return!1;if(n){let t=this.getApiConfig(s.apiFeatureName,r);return t?.config===null?this.processFallbackFeature(e,o):!!t?.config&&(void 0!==o&&this.addWarning(o,e),this.processApiFeature(e,t))}return this.processFallbackFeature(e,o)},processApiFeature:(e,t)=>ev[e].processApi(t),processFallbackFeature:(e,t)=>ev[e].processFallback(t),async fetchRemoteFeatures(e){let t=e.basic??!1,r=e.features||{};this.localSettingsOverridden.clear();let n=null,a=!1;try{a=null!=(n=await C.ApiController.fetchProjectConfig())}catch(e){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",e)}let s=a&&!t?N.ConstantsUtil.DEFAULT_REMOTE_FEATURES:N.ConstantsUtil.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(let e of eA){let o=this.processFeature(e,r,n,a,t);Object.assign(s,{[e]:o})}}catch(e){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",e),N.ConstantsUtil.DEFAULT_REMOTE_FEATURES}if(a&&this.localSettingsOverridden.size>0){let e=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;d.AlertController.open({shortMessage:"Local configuration ignored",longMessage:`[Reown Config Notice] ${e}`},"warning")}return s}};class eE{constructor(e){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(e,t)=>{if(e){let r=u.ChainController.getNetworkData(e)?.requestedCaipNetworks?.find(e=>e.id===t);if(r)return r;let n=u.ChainController.getNetworkData(e)?.caipNetwork;if(n)return n;let a=u.ChainController.getRequestedCaipNetworks(e);return a.filter(t=>t.chainNamespace===e)?.[0]}return u.ChainController.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{let e=this.getCaipNetwork();if(e)return e.id},this.getCaipNetworks=e=>u.ChainController.getCaipNetworks(e),this.getActiveChainNamespace=()=>u.ChainController.state.activeChain,this.setRequestedCaipNetworks=(e,t)=>{u.ChainController.setRequestedCaipNetworks(e,t)},this.getApprovedCaipNetworkIds=()=>u.ChainController.getAllApprovedCaipNetworkIds(),this.getCaipAddress=e=>u.ChainController.state.activeChain!==e&&e?u.ChainController.getAccountProp("caipAddress",e):u.ChainController.state.activeCaipAddress,this.setClientId=e=>{h.BlockchainApiController.setClientId(e)},this.getProvider=e=>eo.getProvider(e),this.getProviderType=e=>eo.getProviderId(e),this.getPreferredAccountType=e=>t.AccountController.state.preferredAccountTypes?.[e],this.setCaipAddress=(e,r)=>{t.AccountController.setCaipAddress(e,r),e&&s.OptionsController.state.enableEmbedded&&this.close()},this.setBalance=(e,r,n)=>{t.AccountController.setBalance(e,r,n)},this.setProfileName=(e,r)=>{t.AccountController.setProfileName(e,r)},this.setProfileImage=(e,r)=>{t.AccountController.setProfileImage(e,r)},this.setUser=(e,r)=>{t.AccountController.setUser(e,r)},this.resetAccount=e=>{t.AccountController.resetAccount(e)},this.setCaipNetwork=e=>{u.ChainController.setActiveCaipNetwork(e)},this.setCaipNetworkOfNamespace=(e,t)=>{u.ChainController.setChainNetworkData(t,{caipNetwork:e})},this.setAllAccounts=(e,r)=>{t.AccountController.setAllAccounts(e,r),s.OptionsController.setHasMultipleAddresses(e?.length>1)},this.setStatus=(e,r)=>{t.AccountController.setStatus(e,r),n.ConnectorController.isConnected()?A.StorageUtil.setConnectionStatus("connected"):A.StorageUtil.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=e=>u.ChainController.getAccountProp("address",e),this.setConnectors=e=>{let t=[...n.ConnectorController.state.allConnectors,...e];n.ConnectorController.setConnectors(t)},this.setConnections=(e,t)=>{r.ConnectionController.setConnections(e,t)},this.fetchIdentity=e=>h.BlockchainApiController.fetchIdentity(e),this.getReownName=e=>y.getNamesForAddress(e),this.getConnectors=()=>n.ConnectorController.getConnectors(),this.getConnectorImage=e=>p.AssetUtil.getConnectorImage(e),this.setConnectedWalletInfo=(e,r)=>{let n=eo.getProviderId(r),a=e?{...e,type:n}:void 0;t.AccountController.setConnectedWalletInfo(a,r)},this.getIsConnectedState=()=>!!u.ChainController.state.activeCaipAddress,this.addAddressLabel=(e,r,n)=>{t.AccountController.addAddressLabel(e,r,n)},this.removeAddressLabel=(e,r)=>{t.AccountController.removeAddressLabel(e,r)},this.getAddress=e=>u.ChainController.state.activeChain!==e&&e?u.ChainController.getAccountProp("address",e):t.AccountController.state.address,this.setApprovedCaipNetworksData=e=>u.ChainController.setApprovedCaipNetworksData(e),this.resetNetwork=e=>{u.ChainController.resetNetwork(e)},this.addConnector=e=>{n.ConnectorController.addConnector(e)},this.resetWcConnection=()=>{r.ConnectionController.resetWcConnection()},this.setAddressExplorerUrl=(e,r)=>{t.AccountController.setAddressExplorerUrl(e,r)},this.setSmartAccountDeployed=(e,r)=>{t.AccountController.setSmartAccountDeployed(e,r)},this.setSmartAccountEnabledNetworks=(e,t)=>{u.ChainController.setSmartAccountEnabledNetworks(e,t)},this.setPreferredAccountType=(e,r)=>{t.AccountController.setPreferredAccountType(e,r)},this.setEIP6963Enabled=e=>{s.OptionsController.setEIP6963Enabled(e)},this.handleUnsafeRPCRequest=()=>{this.isOpen()?this.isTransactionStackEmpty()||this.redirect("ApproveTransaction"):this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,t){let r=e?.map(e=>e.namespace).filter(e=>!!e);return r?.length?[...new Set(r)]:[...new Set(t?.map(e=>e.chainNamespace))]}async initialize(e){this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),await this.syncExistingConnection(),this.remoteFeatures=await ef.fetchRemoteFeatures(e),s.OptionsController.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&_.setOnrampProviders(this.remoteFeatures.onramp),(s.OptionsController.state.remoteFeatures?.email||Array.isArray(s.OptionsController.state.remoteFeatures?.socials)&&s.OptionsController.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){let e=await C.ApiController.fetchAllowedOrigins();if(e&&a.CoreHelperUtil.isClient()){let t=window.location.origin;eu.isOriginAllowed(t,e,ec)||d.AlertController.open(ee.INVALID_APP_CONFIGURATION,"error")}else d.AlertController.open(ee.PROJECT_ID_NOT_CONFIGURED,"error")}sendInitializeEvent(e){let{...t}=e;delete t.adapters,delete t.universalProvider,b.EventsController.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(e=>e.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&L.ThemeController.setThemeMode(e.themeMode),e.themeVariables&&L.ThemeController.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw Error("ConnectionControllerClient and NetworkControllerClient must be set");u.ChainController.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});let t=this.getDefaultNetwork();t&&u.ChainController.setActiveCaipNetwork(t)}initializeConnectionController(e){r.ConnectionController.setWcBasic(e.basic??!1)}initializeConnectorController(){n.ConnectorController.initialize(this.chainNamespaces)}initializeProjectSettings(e){s.OptionsController.setProjectId(e.projectId),s.OptionsController.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){s.OptionsController.setDebug(!1!==e.debug),s.OptionsController.setEnableWalletConnect(!1!==e.enableWalletConnect),s.OptionsController.setEnableWalletGuide(!1!==e.enableWalletGuide),s.OptionsController.setEnableWallets(!1!==e.enableWallets),s.OptionsController.setEIP6963Enabled(!1!==e.enableEIP6963),s.OptionsController.setEnableNetworkSwitch(!1!==e.enableNetworkSwitch),s.OptionsController.setEnableAuthLogger(!1!==e.enableAuthLogger),s.OptionsController.setCustomRpcUrls(e.customRpcUrls),s.OptionsController.setEnableEmbedded(e.enableEmbedded),s.OptionsController.setAllWallets(e.allWallets),s.OptionsController.setIncludeWalletIds(e.includeWalletIds),s.OptionsController.setExcludeWalletIds(e.excludeWalletIds),s.OptionsController.setFeaturedWalletIds(e.featuredWalletIds),s.OptionsController.setTokens(e.tokens),s.OptionsController.setTermsConditionsUrl(e.termsConditionsUrl),s.OptionsController.setPrivacyPolicyUrl(e.privacyPolicyUrl),s.OptionsController.setCustomWallets(e.customWallets),s.OptionsController.setFeatures(e.features),s.OptionsController.setAllowUnsupportedChain(e.allowUnsupportedChain),s.OptionsController.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),s.OptionsController.setPreferUniversalLinks(e.experimental_preferUniversalLinks),s.OptionsController.setDefaultAccountTypes(e.defaultAccountTypes);let r=A.StorageUtil.getPreferredAccountTypes()||{},n={...s.OptionsController.state.defaultAccountTypes,...r};t.AccountController.setPreferredAccountTypes(n);let a=this.getDefaultMetaData();if(!e.metadata&&a&&(e.metadata=a),s.OptionsController.setMetadata(e.metadata),s.OptionsController.setDisableAppend(e.disableAppend),s.OptionsController.setEnableEmbedded(e.enableEmbedded),s.OptionsController.setSIWX(e.siwx),!e.projectId)return void d.AlertController.open(ee.PROJECT_ID_NOT_CONFIGURED,"error");if(e.adapters?.find(e=>e.namespace===i.ConstantsUtil.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw Error("Cannot set both `siweConfig` and `siwx` options");s.OptionsController.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return a.CoreHelperUtil.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){let t=this.getActiveChainNamespace();if(t){let r=Z.getUnsupportedNetwork(`${t}:${e}`);u.ChainController.setActiveCaipNetwork(r)}}getDefaultNetwork(){return Z.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return Z.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return Z.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){let t=e.networks.find(t=>t.id===e.defaultNetwork?.id);return t?Z.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectNamespace(e){try{let t=this.getAdapter(e),r=eo.getProvider(e),a=eo.getProviderId(e),{caipAddress:s}=u.ChainController.getAccountData(e)||{};this.setLoading(!0,e),s&&t?.disconnect&&await t.disconnect({provider:r,providerType:a}),A.StorageUtil.removeConnectedNamespace(e),eo.resetChain(e),this.setUser(void 0,e),this.setStatus("disconnected",e),this.setConnectedWalletInfo(void 0,e),n.ConnectorController.removeConnectorId(e),u.ChainController.resetAccount(e),u.ChainController.resetNetwork(e),this.setLoading(!1,e)}catch(t){throw this.setLoading(!1,e),Error(`Failed to disconnect chain ${e}: ${t.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{let e=u.ChainController.state.activeChain,t=this.getAdapter(e),r=this.getCaipNetwork(e)?.id;if(!t)throw Error("Adapter not found");let a=await t.connectWalletConnect(r);this.close(),this.setClientId(a?.clientId||null),A.StorageUtil.setConnectedNamespaces([...u.ChainController.state.chains.keys()]),this.chainNamespaces.forEach(e=>{n.ConnectorController.setConnectorId(z.ConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT,e)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:r,type:n,provider:a,chain:s,caipNetwork:o,socialUri:i})=>{let l=u.ChainController.state.activeChain,c=s||l,d=this.getAdapter(c);if(s&&s!==l&&!o){let e=this.getCaipNetworks().find(e=>e.chainNamespace===s);e&&this.setCaipNetwork(e)}if(!d)throw Error("Adapter not found");let C=this.getCaipNetwork(c),p=await d.connect({id:e,info:r,type:n,provider:a,socialUri:i,chainId:o?.id||C?.id,rpcUrl:o?.rpcUrls?.default?.http?.[0]||C?.rpcUrls?.default?.http?.[0]});if(!p)return;A.StorageUtil.addConnectedNamespace(c),this.syncProvider({...p,chainNamespace:c});let h=t.AccountController.state.allAccounts,{accounts:N}=h?.length>0?{accounts:[...h]}:await d.getAccounts({namespace:c,id:e});this.setAllAccounts(N,c),this.setStatus("connected",c),this.syncConnectedWalletInfo(c)},reconnectExternal:async({id:e,info:t,type:r,provider:n})=>{let a=u.ChainController.state.activeChain,s=this.getAdapter(a);s?.reconnect&&(await s?.reconnect({id:e,info:t,type:r,provider:n,chainId:this.getCaipNetwork()?.id}),A.StorageUtil.addConnectedNamespace(a),this.syncConnectedWalletInfo(a))},disconnect:async e=>{let t,a,s=(t=Array.from(u.ChainController.state.chains.keys()),a=[],e?(a.push([e,u.ChainController.state.chains.get(e)]),M(e,i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT)?t.forEach(t=>{t!==e&&M(t,i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT)&&a.push([t,u.ChainController.state.chains.get(t)])}):M(e,i.ConstantsUtil.CONNECTOR_ID.AUTH)&&t.forEach(t=>{t!==e&&M(t,i.ConstantsUtil.CONNECTOR_ID.AUTH)&&a.push([t,u.ChainController.state.chains.get(t)])})):a=Array.from(u.ChainController.state.chains.entries()),a);try{let t=await Promise.allSettled(s.map(async([e])=>this.disconnectNamespace(e)));R.SendController.resetSend(),r.ConnectionController.resetWcConnection(),await S.SIWXUtil.clearSessions(),n.ConnectorController.setFilterByNamespace(void 0);let a=t.filter(e=>"rejected"===e.status);if(a.length>0)throw Error(a.map(e=>e.reason.message).join(", "));A.StorageUtil.deleteConnectedSocialProvider(),b.EventsController.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:e||"all"}})}catch(e){throw Error(`Failed to disconnect chains: ${e.message}`)}},checkInstalled:e=>e?e.some(e=>!!window.ethereum?.[String(e)]):!!window.ethereum,signMessage:async e=>{let r=this.getAdapter(u.ChainController.state.activeChain),n=await r?.signMessage({message:e,address:t.AccountController.state.address,provider:eo.getProvider(u.ChainController.state.activeChain)});return n?.signature||""},sendTransaction:async e=>{let t=e.chainNamespace;if(N.ConstantsUtil.SEND_SUPPORTED_NAMESPACES.includes(t)){let r=this.getAdapter(u.ChainController.state.activeChain),n=eo.getProvider(t),a=await r?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:n});return a?.hash||""}return""},estimateGas:async e=>{if(e.chainNamespace===i.ConstantsUtil.CHAIN.EVM){let t=this.getAdapter(u.ChainController.state.activeChain),r=eo.getProvider(u.ChainController.state.activeChain),n=this.getCaipNetwork();if(!n)throw Error("CaipNetwork is undefined");let a=await t?.estimateGas({...e,provider:r,caipNetwork:n});return a?.gas||0n}return 0n},getEnsAvatar:async()=>(await this.syncIdentity({address:t.AccountController.state.address,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:u.ChainController.state.activeChain}),t.AccountController.state.profileImage||!1),getEnsAddress:async e=>await eu.resolveReownName(e),writeContract:async e=>{let t=this.getAdapter(u.ChainController.state.activeChain),r=this.getCaipNetwork(),n=this.getCaipAddress(),a=eo.getProvider(u.ChainController.state.activeChain);if(!r||!n)throw Error("CaipNetwork or CaipAddress is undefined");let s=await t?.writeContract({...e,caipNetwork:r,provider:a,caipAddress:n});return s?.hash},parseUnits:(e,t)=>{let r=this.getAdapter(u.ChainController.state.activeChain);return r?.parseUnits({value:e,decimals:t})??0n},formatUnits:(e,t)=>{let r=this.getAdapter(u.ChainController.state.activeChain);return r?.formatUnits({value:e,decimals:t})??"0"},getCapabilities:async e=>{let t=this.getAdapter(u.ChainController.state.activeChain);return await t?.getCapabilities(e)},grantPermissions:async e=>{let t=this.getAdapter(u.ChainController.state.activeChain);return await t?.grantPermissions(e)},revokePermissions:async e=>{let t=this.getAdapter(u.ChainController.state.activeChain);return t?.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{let t=this.getAdapter(u.ChainController.state.activeChain);return await t?.walletGetAssets(e)??{}},updateBalance:e=>{let r=this.getCaipNetwork(e);r&&t.AccountController.state.address&&this.updateNativeBalance(t.AccountController.state.address,r?.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},r.ConnectionController.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){if(eo.getProviderId(u.ChainController.state.activeChain)===z.ConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT){let e=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(e)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;let t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){let r=eo.getProvider(t),n=eo.getProviderId(t);if(e.chainNamespace===u.ChainController.state.activeChain){let a=this.getAdapter(t);await a?.switchNetwork({caipNetwork:e,provider:r,providerType:n})}else if(this.setCaipNetwork(e),n===z.ConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{let r=this.getAddressByChainNamespace(t);r&&this.syncAccount({address:r,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(e=>Array.from(new Set([...e.chains||[],...e.accounts.map(e=>{let{chainId:t,chainNamespace:r}=c.parseCaipAddress(e);return`${r}:${t}`})])))}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,r)=>{let n=e?.find(e=>e.namespace===r);return n?(n.construct({namespace:r,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),t[r]=n):t[r]=new ew({namespace:r,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e),await this.chainAdapters?.[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){let t=this.getAdapter(e);t?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){let r=this.getAdapter(e);if(!r)return;let n=A.StorageUtil.getConnectionStatus();"connected"===n?this.setStatus("connecting",e):("disconnected"===n&&A.StorageUtil.clearAddressCache(),this.setStatus(n,e)),r.on("switchNetwork",({address:t,chainId:r})=>{let n=this.getCaipNetworks().find(e=>e.id===r||e.caipNetworkId===r),a=u.ChainController.state.activeChain===e,s=u.ChainController.getAccountProp("address",e);if(n){let r=a&&t?t:s;r&&this.syncAccount({address:r,chainId:n.id,chainNamespace:e})}else this.setUnsupportedNetwork(r)}),r.on("disconnect",this.disconnect.bind(this,e)),r.on("connections",t=>{this.setConnections(t,e)}),r.on("pendingTransactions",()=>{let e=t.AccountController.state.address,r=u.ChainController.state.activeCaipNetwork;e&&r?.id&&this.updateNativeBalance(e,r.id,r.chainNamespace)}),r.on("accountChanged",({address:t,chainId:r})=>{let n=u.ChainController.state.activeChain===e;n&&r?this.syncAccount({address:t,chainId:r,chainNamespace:e}):n&&u.ChainController.state.activeCaipNetwork?.id?this.syncAccount({address:t,chainId:u.ChainController.state.activeCaipNetwork?.id,chainNamespace:e}):this.syncAccountInfo(t,r,e),this.syncAllAccounts(e)})}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{e===i.ConstantsUtil.CHAIN.EVM&&a.CoreHelperUtil.isSafeApp()&&n.ConnectorController.setConnectorId(i.ConstantsUtil.CONNECTOR_ID.SAFE,e);let t=n.ConnectorController.getConnectorId(e);switch(this.setStatus("connecting",e),t){case i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case i.ConstantsUtil.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){let t=this.getAdapter(e),r=n.ConnectorController.getConnectorId(e),s=this.getCaipNetwork(e),o=n.ConnectorController.getConnectors(e).find(e=>e.id===r);try{if(!t||!o)throw Error(`Adapter or connector not found for namespace ${e}`);if(!s?.id)throw Error("CaipNetwork not found");let r=await t?.syncConnection({namespace:e,id:o.id,chainId:s.id,rpcUrl:s?.rpcUrls?.default?.http?.[0]});if(r){let n=await t?.getAccounts({namespace:e,id:o.id});n&&n.accounts.length>0?this.setAllAccounts(n.accounts,e):this.setAllAccounts([a.CoreHelperUtil.createAccount(e,r.address,"eoa")],e),this.syncProvider({...r,chainNamespace:e}),await this.syncAccount({...r,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch(t){this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){let e=this.chainNamespaces.map(async e=>{let t=this.getAdapter(e),r=this.universalProvider?.session?.namespaces?.[e]?.accounts||[],a=u.ChainController.state.activeCaipNetwork?.id,s=r.find(e=>{let{chainId:t}=c.parseCaipAddress(e);return t===a?.toString()})||r[0];if(s){let r=c.validateCaipAddress(s),{chainId:a,address:o}=c.parseCaipAddress(r);if(eo.setProviderId(e,z.ConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&u.ChainController.state.activeCaipNetwork&&t?.namespace!==i.ConstantsUtil.CHAIN.EVM){let r=t?.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:u.ChainController.state.activeCaipNetwork});eo.setProvider(e,r)}else eo.setProvider(e,this.universalProvider);n.ConnectorController.setConnectorId(i.ConstantsUtil.CONNECTOR_ID.WALLET_CONNECT,e),A.StorageUtil.addConnectedNamespace(e),this.syncWalletConnectAccounts(e),await this.syncAccount({address:o,chainId:a,chainNamespace:e})}else this.setStatus("disconnected",e);this.syncConnectedWalletInfo(e),await u.ChainController.setApprovedCaipNetworksData(e)});await Promise.all(e)}syncWalletConnectAccounts(e){let t=this.universalProvider?.session?.namespaces?.[e]?.accounts?.map(e=>{let{address:t}=c.parseCaipAddress(e);return t}).filter((e,t,r)=>r.indexOf(e)===t);t&&this.setAllAccounts(t.map(t=>a.CoreHelperUtil.createAccount(e,t,"bip122"===e?"payment":"eoa")),e)}syncProvider({type:e,provider:t,id:r,chainNamespace:a}){eo.setProviderId(a,e),eo.setProvider(a,t),n.ConnectorController.setConnectorId(r,a)}async syncAllAccounts(e){let t=n.ConnectorController.getConnectorId(e);if(!t)return;let r=this.getAdapter(e),a=await r?.getAccounts({namespace:e,id:t});a&&a.accounts.length>0&&this.setAllAccounts(a.accounts,e)}async syncAccount(e){let r=e.chainNamespace===u.ChainController.state.activeChain,n=u.ChainController.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:a,chainId:o,chainNamespace:l}=e,{chainId:d}=A.StorageUtil.getActiveNetworkProps(),C=o||d,p=u.ChainController.state.activeCaipNetwork?.name===i.ConstantsUtil.UNSUPPORTED_NETWORK_NAME,h=u.ChainController.getNetworkProp("supportsAllNetworks",l);if(this.setStatus("connected",l),(!p||h)&&C){let e=this.getCaipNetworks().find(e=>e.id.toString()===C.toString()),o=this.getCaipNetworks().find(e=>e.chainNamespace===l);if(!h&&!e&&!o){let t=this.getApprovedCaipNetworkIds()||[],r=t.find(e=>c.parseCaipNetworkId(e)?.chainId===C.toString()),n=t.find(e=>c.parseCaipNetworkId(e)?.chainNamespace===l);e=this.getCaipNetworks().find(e=>e.caipNetworkId===r),o=this.getCaipNetworks().find(e=>e.caipNetworkId===n||"deprecatedCaipNetworkId"in e&&e.deprecatedCaipNetworkId===n)}let d=e||o;d?.chainNamespace===u.ChainController.state.activeChain?s.OptionsController.state.enableNetworkSwitch&&!s.OptionsController.state.allowUnsupportedChain&&u.ChainController.state.activeCaipNetwork?.name===i.ConstantsUtil.UNSUPPORTED_NETWORK_NAME?u.ChainController.showUnsupportedChainUI():this.setCaipNetwork(d):!r&&n&&this.setCaipNetworkOfNamespace(n,l),this.syncConnectedWalletInfo(l),et.HelpersUtil.isLowerCaseMatch(a,t.AccountController.state.address)||this.syncAccountInfo(a,d?.id,l),r?await this.syncBalance({address:a,chainId:d?.id,chainNamespace:l}):await this.syncBalance({address:a,chainId:n?.id,chainNamespace:l})}}async syncAccountInfo(e,t,r){let n=this.getCaipAddress(r),a=t||n?.split(":")[1];if(!a)return;let s=`${r}:${a}:${e}`;this.setCaipAddress(s,r),await this.syncIdentity({address:e,chainId:a,chainNamespace:r})}async syncReownName(e,t){try{let r=await this.getReownName(e);if(r[0]){let e=r[0];this.setProfileName(e.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){let t=n.ConnectorController.getConnectorId(e),r=eo.getProviderId(e);if(r===z.ConstantsUtil.CONNECTOR_TYPE_ANNOUNCED||r===z.ConstantsUtil.CONNECTOR_TYPE_INJECTED){if(t){let r=this.getConnectors().find(e=>e.id===t);if(r){let{info:t,name:n,imageUrl:a}=r,s=a||this.getConnectorImage(r);this.setConnectedWalletInfo({name:n,icon:s,...t},e)}}}else if(r===z.ConstantsUtil.CONNECTOR_TYPE_WALLET_CONNECT){let t=eo.getProvider(e);t?.session&&this.setConnectedWalletInfo({...t.session.peer.metadata,name:t.session.peer.metadata.name,icon:t.session.peer.metadata.icons?.[0]},e)}else if(t&&t===i.ConstantsUtil.CONNECTOR_ID.COINBASE){let t=this.getConnectors().find(e=>e.id===i.ConstantsUtil.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(t)},e)}}async syncBalance(e){l.NetworkUtil.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(t=>t.id.toString()===e.chainId?.toString())&&e.chainId&&await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,t,r){let n=this.getAdapter(r),a=u.ChainController.getCaipNetworkByNamespace(r,t);if(n){let s=await n.getBalance({address:e,chainId:t,caipNetwork:a,tokens:this.options.tokens});return this.setBalance(s.balance,s.symbol,r),s}}async initializeUniversalAdapter(){let e=en.createLogger((e,...t)=>{e&&this.handleAlertError(e),console.error(...t)}),t={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};s.OptionsController.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await o.default.init(t),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{r.ConnectionController.setUri(e)}),this.universalProvider.on("connect",r.ConnectionController.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),r.ConnectionController.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{let t=this.getCaipNetworks().find(t=>t.id==e),r=this.getCaipNetwork();t?r?.id!==t?.id&&this.setCaipNetwork(t):this.setUnsupportedNetwork(e)}),this.universalProvider.on("session_event",e=>{if(eu.isSessionEventData(e)){let{name:t,data:r}=e.params.event;"accountsChanged"===t&&Array.isArray(r)&&a.CoreHelperUtil.isCaipAddress(r[0])&&this.syncAccount(c.parseCaipAddress(r[0]))}}))}createUniversalProvider(){return!this.universalProviderInitPromise&&a.CoreHelperUtil.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){b.EventsController.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){let[t,r]=Object.entries(Q).find(([,{message:t}])=>e.message.includes(t))??[],{message:n,alertErrorKey:a}=r??{};if(t&&n&&!this.reportedAlertErrors[t]){let e=ee[a];e&&(d.AlertController.open(e,"error"),this.reportedAlertErrors[t]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;let t=e.namespace;t&&(this.createClients(),e.namespace=t,e.construct({namespace:t,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=e))}async open(e){return(await this.injectModalUi(),e?.uri&&r.ConnectionController.setUri(e.uri),e?.arguments&&e?.view==="Swap")?I.ModalController.open({...e,data:{swap:e.arguments}}):I.ModalController.open(e)}async close(){await this.injectModalUi(),I.ModalController.close()}setLoading(e,t){I.ModalController.setLoading(e,t)}async disconnect(e){await r.ConnectionController.disconnect(e)}getSIWX(){return s.OptionsController.state.siwx}getError(){return""}getChainId(){return u.ChainController.state.activeCaipNetwork?.id}async switchNetwork(e){let t=this.getCaipNetworks().find(t=>t.id===e.id);t?await u.ChainController.switchActiveNetwork(t):d.AlertController.open(ee.SWITCH_NETWORK_NOT_FOUND,"error")}getWalletProvider(){return u.ChainController.state.activeChain?eo.state.providers[u.ChainController.state.activeChain]:null}getWalletProviderType(){return eo.getProviderId(u.ChainController.state.activeChain)}subscribeProviders(e){return eo.subscribeProviders(e)}getThemeMode(){return L.ThemeController.state.themeMode}getThemeVariables(){return L.ThemeController.state.themeVariables}setThemeMode(e){L.ThemeController.setThemeMode(e),(0,F.setColorTheme)(L.ThemeController.state.themeMode)}setTermsConditionsUrl(e){s.OptionsController.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){s.OptionsController.setPrivacyPolicyUrl(e)}setThemeVariables(e){L.ThemeController.setThemeVariables(e),(0,F.setThemeVariables)(L.ThemeController.state.themeVariables)}subscribeTheme(e){return L.ThemeController.subscribe(e)}getWalletInfo(){return t.AccountController.state.connectedWalletInfo}getAccount(e){let t=n.ConnectorController.getAuthConnector(e),r=u.ChainController.getAccountData(e),s=u.ChainController.state.activeChain,o=A.StorageUtil.getConnectedConnectorId(e||s);if(r)return{allAccounts:r.allAccounts,caipAddress:r.caipAddress,address:a.CoreHelperUtil.getPlainAddress(r.caipAddress),isConnected:!!r.caipAddress,status:r.status,embeddedWalletInfo:t&&o===i.ConstantsUtil.CONNECTOR_ID.AUTH?{user:r.user?{...r.user,username:A.StorageUtil.getConnectedSocialUsername()}:void 0,authProvider:r.socialProvider||"email",accountType:r.preferredAccountTypes?.[e||s],isSmartAccountDeployed:!!r.smartAccountDeployed}:void 0}}subscribeAccount(e,t){let r=()=>{let r=this.getAccount(t);r&&e(r)};t?u.ChainController.subscribeChainProp("accountState",r,t):u.ChainController.subscribe(r),n.ConnectorController.subscribe(r)}subscribeNetwork(e){return u.ChainController.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t?.id,caipNetworkId:t?.caipNetworkId})})}subscribeWalletInfo(e){return t.AccountController.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){t.AccountController.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){u.ChainController.subscribeKey("activeCaipNetwork",e)}getState(){return P.PublicStateController.state}subscribeState(e){return P.PublicStateController.subscribe(e)}showErrorMessage(e){D.SnackController.showError(e)}showSuccessMessage(e){D.SnackController.showSuccess(e)}getEvent(){return{...b.EventsController.state}}subscribeEvents(e){return b.EventsController.subscribe(e)}replace(e){f.RouterController.replace(e)}redirect(e){f.RouterController.push(e)}popTransactionStack(e){f.RouterController.popTransactionStack(e)}isOpen(){return I.ModalController.state.open}isTransactionStackEmpty(){return 0===f.RouterController.state.transactionStack.length}static getInstance(){return this.instance}updateFeatures(e){s.OptionsController.setFeatures(e)}updateRemoteFeatures(e){s.OptionsController.setRemoteFeatures(e)}updateOptions(e){let t={...s.OptionsController.state||{},...e};s.OptionsController.setOptions(t)}setConnectMethodsOrder(e){s.OptionsController.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){s.OptionsController.setWalletFeaturesOrder(e)}setCollapseWallets(e){s.OptionsController.setCollapseWallets(e)}setSocialsOrder(e){s.OptionsController.setSocialsOrder(e)}getConnectMethodsOrder(){return W.WalletUtil.getConnectOrderMethod(s.OptionsController.state.features,n.ConnectorController.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw Error(`Adapter for namespace ${e} doesn't exist`);let r=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(e=>e.id===r.id)||u.ChainController.addNetwork(r)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(e=>e.id===t)&&u.ChainController.removeNetwork(e,t)}}let ey=!1;class eb extends eE{async open(e){n.ConnectorController.isConnected()||await super.open(e)}async close(){await super.close(),this.options.manualWCControl&&r.ConnectionController.finalizeWcConnection()}async syncIdentity(e){return Promise.resolve()}async syncBalance(e){return Promise.resolve()}async injectModalUi(){if(!ey&&a.CoreHelperUtil.isClient()){if(await e.A(910015),await e.A(156775),!document.querySelector("w3m-modal")){let e=document.createElement("w3m-modal");s.OptionsController.state.disableAppend||s.OptionsController.state.enableEmbedded||document.body.insertAdjacentElement("beforeend",e)}ey=!0}}}function eI(e){return new eb({...e,basic:!0,sdkVersion:"html-core-1.7.8"})}e.s(["createAppKit",()=>eI],562998),e.i(562998),e.s(["AppKit",()=>eb,"createAppKit",()=>eI],587534)}]);